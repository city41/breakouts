//>>built
/*

 Lo-Dash 1.0.1 (Custom Build) <http://lodash.com/>
 Build: `lodash modern exports="amd" include="each,reject,shuffle,toArray,flatten,uniqueId,times" -o deps/lodash/lodash.js -d`
 Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 Available under MIT license <http://lodash.com/license>
*/
(function(b,f){var g,d,h,k=function(){},e=function(a){for(var c in a)return 0;return 1},j={}.toString,l=function(a){return"[object Function]"==j.call(a)},a=function(a){return"[object String]"==j.call(a)},i=function(a){return"[object Array]"==j.call(a)},c=function(a,c){if(a)for(var b=0;b<a.length;)c(a[b++])},m=function(a,c){for(var b in c)a[b]=c[b];return a},n=function(a,c){return m(Error(a),{src:"dojoLoader",info:c})},p=1,v=function(){return"_"+p++},o=function(a,c,b){return pa(a,c,b,0,o)},s=this,
B=s.document,U=B&&B.createElement("DiV"),q=o.has=function(a){return l(u[a])?u[a]=u[a](s,B,U):u[a]},u=q.cache=f.hasCache;q.add=function(a,c,b,d){(void 0===u[a]||d)&&(u[a]=c);return b&&q(a)};for(var t in b.has)q.add(t,b.has[t],0,1);o.async=1;var x=new Function("return eval(arguments[0]);");o.eval=function(a,c){return x(a+"\r\n////@ sourceURL="+c)};var w={},r=o.signal=function(a,b){var d=w[a];c(d&&d.slice(0),function(a){a.apply(null,i(b)?b:[b])})},E=o.on=function(a,c){var b=w[a]||(w[a]=[]);b.push(c);
return{remove:function(){for(var a=0;a<b.length;a++)if(b[a]===c){b.splice(a,1);break}}}},C=[],ca={},K=[],L={},V=o.map={},M=[],y={},H="",F={},I={};t={};var N=function(a){var c,b,d,i;for(c in I)b=I[c],(d=c.match(/^url\:(.+)/))?F["url:"+qa(d[1],a)]=b:"*now"==c?i=b:"*noref"!=c&&(d=W(c,a),F[d.mid]=F["url:"+d.url]=b);i&&i(da(a));I={}},R=function(a){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){return"\\"+a})},O=function(a,c){c.splice(0,c.length);for(var b in a)c.push([b,a[b],RegExp("^"+R(b)+
"(/|$)"),b.length]);c.sort(function(a,c){return c[3]-a[3]});return c},P=function(a){var c=a.name;c||(c=a,a={name:c});a=m({main:"main"},a);a.location=a.location?a.location:c;if(a.packageMap)V[c]=a.packageMap;if(!a.main.indexOf("./"))a.main=a.main.substring(2);L[c]=a},S=[],z=function(b,d,i){for(var e in b){if("waitSeconds"==e)o.waitms=1E3*(b[e]||0);"cacheBust"==e&&(H=b[e]?a(b[e])?b[e]:(new Date).getTime()+"":"");if("baseUrl"==e||"combo"==e)o[e]=b[e];b[e]!==u&&(o.rawConfig[e]=b[e],"has"!=e&&q.add("config-"+
e,b[e],0,d))}if(!o.baseUrl)o.baseUrl="./";/\/$/.test(o.baseUrl)||(o.baseUrl+="/");for(e in b.has)q.add(e,b.has[e],0,d);c(b.packages,P);for(h in b.packagePaths)c(b.packagePaths[h],function(c){var b=h+"/"+c;a(c)&&(c={name:c});c.location=b;P(c)});O(m(V,b.map),M);c(M,function(a){a[1]=O(a[1],[]);if("*"==a[0])M.star=a});O(m(ca,b.paths),K);c(b.aliases,function(c){a(c[0])&&(c[0]=RegExp("^"+R(c[0])+"$"));C.push(c)});if(d)S.push({config:b.config});else for(e in b.config)d=J(e,i),d.config=m(d.config||{},b.config[e]);
if(b.cache)N(),I=b.cache,b.cache["*noref"]&&N();r("config",[b,o.rawConfig])};o.rawConfig={};z(f,1);z(b,1);z(t,1);var G=function(a){ea(function(){c(a.deps,ra)})},pa=function(c,b,e,d,h){var g;if(a(c)){if((g=J(c,d,!0))&&g.executed)return g.result;throw n("undefinedModule",c);}i(c)||(z(c,0,d),c=b,b=e);if(i(c))if(c.length){for(var e="require*"+v(),f,j=[],l=0;l<c.length;)f=c[l++],j.push(J(f,d));g=m(X("",e,0,""),{injected:2,deps:j,def:b||k,require:d?d.require:o,gc:1});y[g.mid]=g;G(g);var p=T&&0!="sync";
ea(function(){fa(g,p)});g.executed||D.push(g);Y()}else b&&b();return h},da=function(a){if(!a)return o;var c=a.require;if(!c)c=function(b,e,d){return pa(b,e,d,a,c)},a.require=m(c,o),c.module=a,c.toUrl=function(c){return qa(c,a)},c.toAbsMid=function(c){return ga(c,a)};return c},D=[],Z=[],A={},Ba=function(a){a.injected=1;A[a.mid]=1;a.url&&(A[a.url]=a.pack||1);Aa()},$=function(a){a.injected=2;delete A[a.mid];a.url&&delete A[a.url];e(A)&&Ca()},Da=o.idle=function(){return!Z.length&&e(A)&&!D.length&&!T},
ha=function(a,c){if(c)for(var b=0;b<c.length;b++)if(c[b][2].test(a))return c[b];return 0},sa=function(a){for(var c=[],b,e,a=a.replace(/\\/g,"/").split("/");a.length;)b=a.shift(),".."==b&&c.length&&".."!=e?(c.pop(),e=c[c.length-1]):"."!=b&&c.push(e=b);return c.join("/")},X=function(a,c,b,e){return{pid:a,mid:c,pack:b,url:e,executed:0,def:0}},ta=function(a,b,e,d,i,h,f,j){var m,k,p,o;o=/^\./.test(a);if(/(^\/)|(\:)|(\.js$)/.test(a)||o&&!b)return X(0,a,0,a);a=sa(o?b.mid+"/../"+a:a);if(/^\./.test(a))throw n("irrationalPath",
a);b&&(p=ha(b.mid,h));(p=(p=p||h.star)&&ha(a,p[1]))&&(a=p[1]+a.substring(p[3]));b=(g=a.match(/^([^\/]+)(\/(.+))?$/))?g[1]:"";(m=e[b])?a=b+"/"+(k=g[3]||m.main):b="";var s=0;c(C,function(c){var b=a.match(c[0]);b&&0<b.length&&(s=l(c[1])?a.replace(c[0],c[1]):c[1])});if(s)return ta(s,0,e,d,i,h,f,j);if(e=d[a])return j?X(e.pid,e.mid,e.pack,e.url):d[a];d=(p=ha(a,f))?p[1]+a.substring(p[3]):b?m.location+"/"+k:a;/(^\/)|(\:)/.test(d)||(d=i+d);return X(b,a,m,sa(d+".js"))},W=function(a,c){return ta(a,c,L,y,o.baseUrl,
M,K)},ua=function(a,c,b){return a.normalize?a.normalize(c,function(a){return ga(a,b)}):ga(c,b)},va=0,J=function(a,c,b){var e,d;(e=a.match(/^(.+?)\!(.*)$/))?(d=J(e[1],c,b),5===d.executed&&!d.load&&ia(d),d.load?(e=ua(d,e[2],c),a=d.mid+"!"+(d.dynamic?++va+"!":"")+e):(e=e[2],a=d.mid+"!"+ ++va+"!waitingForPlugin"),a={plugin:d,mid:a,req:da(c),prid:e}):a=W(a,c);return y[a.mid]||!b&&(y[a.mid]=a)},ga=o.toAbsMid=function(a,c){return W(a,c).mid},qa=o.toUrl=function(a,c){var b=W(a+"/x",c),e=b.url;return wa(0===
b.pid?a:e.substring(0,e.length-5))},xa={injected:2,executed:5,def:3,result:3},Q=function(a){return y[a]=m({mid:a},xa)},Ea=Q("require"),Fa=Q("exports"),Ga=Q("module"),aa={},ja=0,ia=function(a){var c=a.result;a.dynamic=c.dynamic;a.normalize=c.normalize;a.load=c.load;return a},Ha=function(a){var b={};c(a.loadQ,function(c){var e=ua(a,c.prid,c.req.module),d=a.dynamic?c.mid.replace(/waitingForPlugin$/,e):a.mid+"!"+e,e=m(m({},c),{mid:d,prid:e,injected:0});y[d]||ya(y[d]=e);b[c.mid]=y[d];$(c);delete y[c.mid]});
a.loadQ=0;var e=function(a){for(var c=a.deps||[],e=0;e<c.length;e++)(a=b[c[e].mid])&&(c[e]=a)},d;for(d in y)e(y[d]);c(D,e)},ka=function(a){o.trace("loader-finish-exec",[a.mid]);a.executed=5;a.defOrder=ja++;a.loadQ&&(ia(a),Ha(a));for(d=0;d<D.length;)D[d]===a?D.splice(d,1):d++;/^require\*/.test(a.mid)&&delete y[a.mid]},Ia=[],fa=function(a,c){if(4===a.executed)return o.trace("loader-circular-dependency",[Ia.concat(a.mid).join("->")]),!a.def||c?aa:a.cjs&&a.cjs.exports;if(!a.executed){if(!a.def)return aa;
var b=a.mid,e=a.deps||[],d,i=[],n=0;for(a.executed=4;n<e.length;){d=e[n++];d=d===Ea?da(a):d===Fa?a.cjs.exports:d===Ga?a.cjs:fa(d,c);if(d===aa)return a.executed=0,o.trace("loader-exec-module",["abort",b]),aa;i.push(d)}o.trace("loader-run-factory",[a.mid]);b=a.def;i=l(b)?b.apply(null,i):b;a.result=void 0===i&&a.cjs?a.cjs.exports:i;ka(a)}return a.result},T=0,ea=function(a){try{T++,a()}finally{T--}Da()&&r("idle",[])},Y=function(){T||ea(function(){for(var a,c,b=0;b<D.length;)a=ja,c=D[b],fa(c),a!=ja?b=
0:b++})};void 0===q("dojo-loader-eval-hint-url")&&q.add("dojo-loader-eval-hint-url",1);var wa=function(a){a+="";return a+(H?(/\?/.test(a)?"&":"?")+H:"")},ya=function(a){var c=a.plugin;5===c.executed&&!c.load&&ia(c);var b=function(c){a.result=c;$(a);ka(a);Y()};c.load?c.load(a.prid,a.req,b):c.loadQ?c.loadQ.push(a):(c.loadQ=[a],D.unshift(c),ra(c))},ba=0,la=0,ma=0,Ja=function(a,c){q("config-stripStrict")&&(a=a.replace(/"use strict"/g,""));ma=1;a===ba?ba.call(null):o.eval(a,q("dojo-loader-eval-hint-url")?
c.url:c.mid);ma=0},ra=function(a){var c=a.mid,b=a.url;if(!a.executed&&!a.injected&&!(A[c]||a.url&&(a.pack&&A[a.url]===a.pack||1==A[a.url])))if(Ba(a),a.plugin)ya(a);else{var e=function(){Ka(a);2!==a.injected&&($(a),m(a,xa),o.trace("loader-define-nonmodule",[a.url]));Y()};(ba=F[c]||F["url:"+a.url])?(o.trace("loader-inject",["cache",a.mid,b]),Ja(ba,a),e()):(o.trace("loader-inject",["script",a.mid,b]),la=a,o.injectUrl(wa(b),e,a),la=0)}},na=function(a,c,b){o.trace("loader-define-module",[a.mid,c]);if(2===
a.injected)return r("error",n("multipleDefine",a)),a;m(a,{deps:c,def:b,cjs:{id:a.mid,uri:a.url,exports:a.result={},setExports:function(c){a.cjs.exports=c},config:function(){return a.config}}});for(var e=0;e<c.length;e++)c[e]=J(c[e],a);$(a);if(!l(b)&&!c.length)a.result=b,ka(a);return a},Ka=function(a,b){for(var e=[],d,i;Z.length;)i=Z.shift(),b&&(i[0]=b.shift()),d=i[0]&&J(i[0])||a,e.push([d,i[1],i[2]]);N(a);c(e,function(a){G(na.apply(null,a))})},Ca=k,Aa=k;q.add("ie-event-behavior",!!B.attachEvent&&
("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var oa=function(a,c,b,e){if(q("ie-event-behavior"))return a.attachEvent(b,e),function(){a.detachEvent(b,e)};a.addEventListener(c,e,!1);return function(){a.removeEventListener(c,e,!1)}},La=oa(window,"load","onload",function(){o.pageLoaded=1;"complete"!=B.readyState&&(B.readyState="complete");La()}),za=B.getElementsByTagName("script")[0],Ma=za.parentNode;o.injectUrl=function(a,c,b){var b=b.node=B.createElement("script"),e=oa(b,"load",
"onreadystatechange",function(a){var a=a||window.event,b=a.target||a.srcElement;if("load"===a.type||/complete|loaded/.test(b.readyState))e(),d(),c&&c()}),d=oa(b,"error","onerror",function(c){e();d();r("error",n("scriptError",[a,c]))});b.type="text/javascript";b.charset="utf-8";b.src=a;Ma.insertBefore(b,za);return b};o.log=k;o.trace=k;Q=function(c,b,e){var d=arguments.length,i=["require","exports","module"],g=[0,c,b];1==d?g=[0,l(c)?i:[],c]:2==d&&a(c)?g=[c,l(b)?i:[],b]:3==d&&(g=[c,b,e]);o.trace("loader-define",
g.slice(0,2));if((d=g[0]&&J(g[0]))&&!A[d.mid])G(na(d,g[1],g[2]));else if(!q("ie-event-behavior")||ma)Z.push(g);else{d=d||la;if(!d)for(c in A)if((i=y[c])&&i.node&&"interactive"===i.node.readyState){d=i;break}d?(N(d),G(na(d,g[1],g[2]))):r("error",n("ieDefineFailed",g[0]));Y()}};Q.amd={vendor:"dojotoolkit.org"};m(m(o,f.loaderPatch),b.loaderPatch);E("error",function(a){try{if(console.error(a),a instanceof Error)for(var c in a);}catch(b){}});m(o,{uid:v,cache:F,packs:L});if(!s.define)s.define=Q,s.require=
o,c(S,function(a){z(a)}),E=t.deps||b.deps||f.deps,t=t.callback||b.callback||f.callback,o.boot=E||t?[E||[],t]:0})(this.dojoConfig||this.djConfig||this.require||{},{async:1,baseUrl:"./",hasCache:{"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-loader":1,dom:1,"host-browser":1},packages:[{location:"../frozenjs-breakouts",name:"frozenjs-breakouts"},{location:".",name:"dojo"},{location:"../dcl",main:"dcl",name:"dcl"},{location:"../frozen",main:"GameCore",name:"frozen"},
{location:"../lodash",main:"lodash",name:"lodash"},{location:"../game",main:"game",name:"game"},{location:"../sounds",name:"sounds"}]});
require({cache:{"dist/game":function(){define([],1)},"game/game":function(){define("./handleInput,./update,./draw,./walls,./Paddle,./PaddleJoint,./Ball,./loadLevel,lodash,dojo/keys,dojo/has,frozen/box2d/BoxGame,frozen/box2d/Box,frozen/box2d/entities/Rectangle".split(","),function(b,f,g,d,h,k,e,j,l,a,i,c,m,n){var p=new c({height:416,width:320,box:new m({resolveCollisions:!0,gravityY:0}),boxUpdating:!1,canvasId:"canvas",gameAreaId:i("touch")?"gameArea":null,canvasPercentage:i("touch")?0.98:null,mobile:i("touch")?
!0:!1,handleInput:b,update:f,draw:g,loadLevel:j,state:{screen:0,lives:3,currentLevel:0,score:0,balls:[],powerUps:[],powerDowns:[],currentBricks:[],launchMillis:0,prevLaunchMillis:3001},initInput:function(c){c.addKeyAction(a.LEFT_ARROW,!0);c.addKeyAction(a.RIGHT_ARROW,!0)},addBodies:function(){var a=l.toArray(arguments),a=l.flatten(a,!0);l.forEach(a,function(a){this.addBody(a)},this)},removeBodies:function(){var a=l.toArray(arguments),a=l.flatten(a,!0);l.forEach(a,function(a){this.removeBody(a)},this)},
newBall:function(){var a=new e;this.state.balls.push(a);this.addBody(a);this.box.applyImpulseDegrees(a.id,155,0.75*a.impulse)}});l.forEach(d.entities,function(a){p.addBody(new n(a))});p.addBody(new h);p.addJoint(new k);p.run()})},"game/handleInput":function(){define(["./levels","dojo/keys"],function(b,f){return function(g){if(0===this.state.screen&&(g.touchAction.isPressed()||g.mouseAction.isPressed()))this.state.screen=1,this.loadLevel(0);var d=g.touchAction.position||g.mouseAction.position;if(d){var h=
this.entities.paddle;if(1===this.state.screen&&h)d=d.x/this.box.scale,d<h.halfWidth?d=h.halfWidth:d>this.width/this.box.scale-h.halfWidth&&(d=this.width/this.box.scale-h.halfWidth),0>=this.state.launchMillis?this.box.setPosition(h.id,d,h.y):h.x=d}g.keyActions[f.LEFT_ARROW].getAmount()&&0<this.state.currentLevel?(this.state.currentLevel--,this.loadLevel(this.state.currentLevel)):g.keyActions[f.RIGHT_ARROW].getAmount()&&this.state.currentLevel<b.length-1&&(this.state.currentLevel++,this.loadLevel(this.state.currentLevel))}})},
"game/levels":function(){define(function(){return[{name:"letsa begin",bricks:[[null,null,3,1,3,null,null],[1,0,3,3,3,0,1],[null,0,0,0,0,0,null]],powerUps:1,powerDowns:1},{name:"how's it going?",bricks:[[null,3,1,3,1,3,null],[null,0,0,0,0,0,null],[3,0,2,0,2,0,3],[3,0,0,0,0,0,3],[3,0,null,null,null,0,3],[null,0,0,0,0,0,null]],powerUps:1,powerDowns:1},{name:"tie fighta!",bricks:[[null,0,null,3,null,0,null],[0,null,0,1,0,null,0],[0,3,0,1,0,3,0],[0,null,0,1,0,null,0],[null,0,null,null,null,0,null],[2,
null,2,null,2,null,2]],powerUps:2,powerDowns:2},{name:"swirl",bricks:[[2,3,1,0,2,3,1],[0,null,null,null,null,null,null],[1,null,1,0,2,3,1],[3,null,3,null,null,null,0],[2,null,2,null,2,null,2],[0,null,0,1,3,null,3],[1,null,null,null,null,null,1],[3,2,0,1,3,2,0]],powerUps:2,powerDowns:3}]})},"dojo/keys":function(){define("dojo/keys",["./_base/kernel","./sniff"],function(b,f){return b.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:f("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,
SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,
F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:f("mac")&&!f("air")?f("safari")?91:224:17}})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(b,f,g,d){var h,b={},k={},e={config:f,global:this,dijit:b,dojox:k},b={dojo:["dojo",e],dijit:["dijit",b],dojox:["dojox",k]},d=g.map&&g.map[d.id.match(/[^\/]+/)[0]];for(h in d)b[h]?b[h][0]=d[h]:b[h]=[d[h],{}];for(h in b)d=b[h],d[1]._scopeName=d[0],f.noGlobals||(this[d[0]]=
d[1]);e.scopeMap=b;e.baseUrl=e.config.baseUrl=g.baseUrl;e.isAsync=g.async;e.locale=f.locale;f="$Rev: 30226 $".match(/\d+/);e.version={major:1,minor:8,patch:3,flag:"",revision:f?+f[0]:NaN,toString:function(){var b=e.version;return b.major+"."+b.minor+"."+b.patch+b.flag+" ("+b.revision+")"}};Function("d","d.eval = function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(e);e.exit=function(){};e.deprecated=e.experimental=function(){};e._hasResource={};return e})},"dojo/has":function(){define(["require",
"module"],function(b){var f=b.has||function(){};f.add("touch","ontouchstart"in document);f.add("device-width",screen.availWidth||innerWidth);b=document.createElement("form");f.add("dom-attributes-explicit",0==b.attributes.length);f.add("dom-attributes-specified-flag",0<b.attributes.length&&40>b.attributes.length);f.clearElement=function(b){b.innerHTML="";return b};f.normalize=function(b,d){var h=b.match(/[\?:]|[^:\?]*/g),k=0,e=function(b){var d=h[k++];if(":"==d)return 0;if("?"==h[k++]){if(!b&&f(d))return e();
e(!0);return e(b)}return d||0};return(b=e())&&d(b)};f.load=function(b,d,h){b?d([b],h):h()};return f})},"dojo/_base/config":function(){define(["../has","require"],function(b,f){var g={},d=f.rawConfig,h;for(h in d)g[h]=d[h];return g})},"dojo/sniff":function(){define(["./has"],function(b){var f=navigator,g=f.userAgent,f=f.appVersion,d=parseFloat(f);b.add("air",0<=g.indexOf("AdobeAIR"));b.add("khtml",0<=f.indexOf("Konqueror")?d:void 0);b.add("webkit",parseFloat(g.split("WebKit/")[1])||void 0);b.add("chrome",
parseFloat(g.split("Chrome/")[1])||void 0);b.add("safari",0<=f.indexOf("Safari")&&!b("chrome")?parseFloat(f.split("Version/")[1]):void 0);b.add("mac",0<=f.indexOf("Macintosh"));b.add("quirks","BackCompat"==document.compatMode);b.add("ios",/iPhone|iPod|iPad/.test(g));b.add("android",parseFloat(g.split("Android ")[1])||void 0);if(!b("webkit")){0<=g.indexOf("Opera")&&b.add("opera",9.8<=d?parseFloat(g.split("Version/")[1])||d:d);0<=g.indexOf("Gecko")&&!b("khtml")&&!b("webkit")&&b.add("mozilla",d);b("mozilla")&&
b.add("ff",parseFloat(g.split("Firefox/")[1]||g.split("Minefield/")[1])||void 0);if(document.all&&!b("opera"))g=parseFloat(f.split("MSIE ")[1])||void 0,(f=document.documentMode)&&5!=f&&Math.floor(g)!=f&&(g=f),b.add("ie",g);b.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return b})},"game/update":function(){define("./Ball,./Paddle,./PaddleJoint,./levels,./PowerUp,./PowerDown,lodash,frozen/plugins/loadSound!sounds/brickDeath,frozen/plugins/loadSound!sounds/countdownBlip,frozen/plugins/loadSound!sounds/powerup,frozen/plugins/loadSound!sounds/powerdown,frozen/plugins/loadSound!sounds/recover".split(","),
function(b,f,g,d,h,k,e,j,l,a,i,c){return function(m){if(1===this.state.screen){var n=this.entities.paddle,p,v,o=!1;e.forEach(this.state.currentBricks,function(a){a.dead||(a.updateAnimation(m),o=!0)});if(!o)this.state.currentLevel++,this.state.currentLevel<d.length?this.loadLevel(this.state.currentLevel):this.state.screen=3;if(0<this.state.launchMillis)this.prevLaunchMillis=this.state.launchMillis,this.state.launchMillis-=m,0<=this.state.launchMillis&&Math.floor(this.prevLaunchMillis/1E3)!==Math.floor(this.state.launchMillis/
1E3)&&l.play(),this.boxUpdating=0>=this.state.launchMillis?!0:!1;else if(this.boxUpdating=!0,this.state.balls=e.filter(this.state.balls,function(a){if(a.y<this.height/this.box.scale)return a.updateAnimation(m),!0;this.removeBody(a);return!1},this),n&&n.collisions&&e.forEach(n.collisions,function(c){c=this.entities[c.id];if(c.ball&&c.y<n.y){var b=45*((c.x-n.x)/(n.halfWidth+c.radius));this.removeBody(c);this.addBody(c);this.box.applyImpulseDegrees(c.id,b,c.impulse)}else if(c.powerUp)this.removeBody(c),
this.state.powerUps=e.reject(this.state.powerUps,{id:c.id}),this.newBall(),a.play();else if(c.powerDown)this.removeBody(c),this.state.powerDowns=e.reject(this.state.powerDowns,{id:c.id}),0<n.smallMillis?n.smallMillis=n.smallMillisStart:(v=new f({x:n.x*n.scale,y:n.y*n.scale,halfWidth:n.smallHalfWidth,smallMillis:n.smallMillisStart}),this.removeJoint(this.joints.pJoint),this.removeBody(n),this.addBody(v),this.addJoint(new g)),i.play()},this),n&&0<n.smallMillis&&(n.smallMillis-=m,0>=n.smallMillis&&(v=
new f({x:n.x*n.scale,y:n.y*n.scale,halfWidth:n.bigHalfWidth}),this.removeJoint(this.joints.pJoint),this.removeBody(n),this.addBody(v),this.addJoint(new g),c.play())),e.forEach(this.state.balls,function(a,c){a.collisions&&e.forEach(a.collisions,function(a){if((a=this.entities[a.id])&&a.brick)a.dying=!0,this.removeBody(a),j.play(0.5),a.powerUpBrick?(a=new h({x:a.x*a.scale,y:a.y*a.scale}),this.addBody(a),this.box.applyImpulseDegrees(a.id,180,a.impulse),this.state.powerUps.push(a)):a.powerDownBrick&&
(a=new k({x:a.x*a.scale,y:a.y*a.scale}),this.addBody(a),this.box.applyImpulseDegrees(a.id,180,a.impulse),this.state.powerDowns.push(a)),this.state.score+=100},this);if(a.linearVelocity&&3>Math.abs(a.linearVelocity.y)){if(a.slowY++,1<a.slowY&&300<a.aliveTime)this.box.removeBody(a.id),p=new b({x:a.x*a.scale,y:a.y*a.scale,id:a.id}),this.state.balls[c]=p,this.addBody(p),this.box.applyImpulseDegrees(a.id,0<a.linearVelocity.y?0<a.linearVelocity.x?45:315:0<a.linearVelocity.x?135:225,a.impulse),p.slowY=0}else a.slowY=
0},this),0===this.state.balls.length)this.state.lives--,0<this.state.lives?(this.newBall(),this.state.launchMillis=3001):this.state.screen=2}}})},"game/Ball":function(){define(["lodash","dcl","frozen/box2d/entities/Circle","frozen/Animation","frozen/plugins/loadImage!resources/tiles.png"],function(b,f,g,d,h){return f(g,{x:60,y:210,ball:!0,radius:8,img:h,anim:null,restitution:1,friction:0,impulse:1.8,slowY:0,aliveTime:0,groupIndex:-1,constructor:function(){if(!this.id)this.id=b.uniqueId();this.anim=
d.prototype.createFromSheet(5,200,this.img,16,16);this.anim.offsetX=48;this.anim.offsetY=64},updateAnimation:function(b){this.anim.update(b);this.aliveTime+=b},draw:function(b){this.anim.draw(b,(this.x-this.radius)*this.scale,(this.y-this.radius)*this.scale)}})})},"lodash/lodash":function(){(function(b){function f(){}function g(a,c,b){if(null==a)return v;var e=typeof a;if("function"!=e){if("object"!=e)return function(c){return c[a]};var d=G(a);return function(c){for(var b=d.length,e=!1;b--&&(e=j(c[d[b]],
a[d[b]],U)););return e}}return"undefined"!=typeof c?1===b?function(b){return a.call(c,b)}:2===b?function(b,e){return a.call(c,b,e)}:4===b?function(b,e,d,i){return a.call(c,b,e,d,i)}:function(b,e,d){return a.call(c,b,e,d)}:a}function d(){for(var a={isKeysFast:N,arrays:"isArray(iterable)",bottom:"",loop:"",top:"",useHas:!0},c,b=0;c=arguments[b];b++)for(var e in c)a[e]=c[e];c=a.args;a.firstArg=/^[^,]+/.exec(c)[0];b="var index, iterable = "+a.firstArg+", result = iterable;\nif (!iterable) return result;\n"+
a.top+";\n";a.arrays&&(b+="var length = iterable.length; index = -1;\nif ("+a.arrays+") {\n  while (++index < length) {\n    "+a.loop+"\n  }\n}\nelse {  ");a.isKeysFast&&a.useHas?b+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? nativeKeys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    "+a.loop+"\n  }  ":(b+="\n  for (index in iterable) {",a.useHas&&(b+="\n    if (",a.useHas&&(b+="hasOwnProperty.call(iterable, index)"),
b+=") {    "),b+=a.loop+";    ",a.useHas&&(b+="\n    }"),b+="\n  }  ");a.arrays&&(b+="\n}");b+=a.bottom+";\nreturn result";return Function("createCallback, hasOwnProperty, isArguments, isArray, isString, objectTypes, nativeKeys","return function("+c+") {\n"+b+"\n}")(g,t,k,z,i,R,C)}function h(a,c,b){c||(c=0);"undefined"==typeof b&&(b=a?a.length:0);for(var e=-1,b=b-c||0,d=Array(0>b?0:b);++e<b;)d[e]=a[c+e];return d}function k(a){return w.call(a)==K}function e(a){var c=[];S(a,function(a,b){c.push(b)});
return c}function j(a,c,b,e,d,i){var n=b===U;if(b&&!n){var b="undefined"==typeof e?b:g(b,e,2),h=b(a,c);if("undefined"!=typeof h)return!!h}if(a===c)return 0!==a||1/a==1/c;var f=typeof a,m=typeof c;if(a===a&&(!a||"function"!=f&&"object"!=f)&&(!c||"function"!=m&&"object"!=m))return!1;if(null==a||null==c)return a===c;m=w.call(a);f=w.call(c);m==K&&(m=H);f==K&&(f=H);if(m!=f)return!1;switch(m){case V:case M:return+a==+c;case y:return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case F:case I:return a==c+""}f=m==L;if(!f){if(a.__wrapped__||
c.__wrapped__)return j(a.__wrapped__||a,c.__wrapped__||c,b,e,d,i);if(m!=H)return!1;var m=a.constructor,k=c.constructor;if(m!=k&&(!l(m)||!(m instanceof m&&l(k)&&k instanceof k)))return!1}d||(d=[]);i||(i=[]);for(m=d.length;m--;)if(d[m]==a)return i[m]==c;var p=0,h=!0;d.push(a);i.push(c);if(f){m=a.length;p=c.length;h=p==a.length;if(!h&&!n)return h;for(;p--;)if(f=m,k=c[p],n)for(;f--&&!(h=j(a[f],k,b,e,d,i)););else if(!(h=j(a[p],k,b,e,d,i)))break;return h}P(c,function(c,n,m){if(t.call(m,n))return p++,h=
t.call(a,n)&&j(a[n],c,b,e,d,i)});h&&!n&&P(a,function(a,c,b){if(t.call(b,c))return h=-1<--p});return h}function l(a){return"function"==typeof a}function a(a){return a?R[typeof a]:!1}function i(a){return"string"==typeof a||w.call(a)==I}function c(a){for(var c=-1,b=G(a),e=b.length,d=Array(e);++c<e;)d[c]=a[b[c]];return d}function m(a,c,b){var e=[],c=g(c,b);if(z(a))for(var b=-1,d=a.length;++b<d;){var i=a[b];c(i,b,a)&&e.push(i)}else O(a,function(a,b,d){c(a,b,d)&&e.push(a)});return e}function n(a,c,b){if(c&&
"undefined"==typeof b&&z(a))for(var b=-1,e=a.length;++b<e&&!(!1===c(a[b],b,a)););else O(a,c,b);return a}function p(a,c){for(var b=-1,e=a?a.length:0,d=[];++b<e;){var i=a[b];z(i)?x.apply(d,c?i:p(i)):d.push(i)}return d}function v(a){return a}var o="object"==typeof module&&module&&module.exports==("object"==typeof exports&&exports)&&module,s="object"==typeof global&&global;s.global===s&&(b=s);var s={},B=0,U=s,q=RegExp("^"+(s.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,
".+?")+"$"),u=Math.floor,t=s.hasOwnProperty,x=[].push,w=s.toString,r=q.test(r=h.bind)&&r,E=q.test(E=Array.isArray)&&E,C=q.test(C=Object.keys)&&C,ca=Math.random,K="[object Arguments]",L="[object Array]",V="[object Boolean]",M="[object Date]",y="[object Number]",H="[object Object]",F="[object RegExp]",I="[object String]",s=!!b.attachEvent,r=r&&!/\n|true/.test(r+s),N=C&&(s||r),R={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},s={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : createCallback(callback, thisArg)",
arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},q={top:"if (!objectTypes[typeof iterable]) return result;\n"+s.top,arrays:!1},O=d(s),P=d(s,q,{useHas:!1}),S=d(s,q),z=E||function(a){return a instanceof Array||w.call(a)==L},G=!C?e:function(c){return!a(c)?[]:C(c)};l(/x/)&&(l=function(a){return a instanceof Function||"[object Function]"==w.call(a)});r&&o&&"function"==typeof setImmediate&&(defer=bind(setImmediate,b));f.filter=m;f.flatten=
p;f.forEach=n;f.forIn=P;f.forOwn=S;f.keys=G;f.reject=function(a,c,b){c=g(c,b);return m(a,function(a,b,e){return!c(a,b,e)})};f.shuffle=function(a){var c=-1,b=a?a.length:0,e=Array("number"==typeof b?b:0);n(a,function(a){var b=u(ca()*(++c+1));e[c]=e[b];e[b]=a});return e};f.times=function(a,c,b){for(var a=+a||0,e=-1,d=Array(a);++e<a;)d[e]=c.call(b,e);return d};f.toArray=function(a){return a&&"number"==typeof a.length?h(a):c(a)};f.values=c;f.each=n;f.select=m;f.identity=v;f.isArguments=k;f.isArray=z;f.isEqual=
j;f.isFunction=l;f.isObject=a;f.isString=i;f.uniqueId=function(a){var c=++B;return(null==a?"":a+"")+c};f.VERSION="1.0.1";"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define(function(){return f})})(this)},"dcl/dcl":function(){(function(b){"undefined"!=typeof define?define(["./mini"],b):"undefined"!=typeof module?module.exports=b(require("./mini")):dcl=b(dcl)})(function(b){function f(){}function g(b,e,d){var h=b||f,a=e||f,i=d||f,c=function(){var c;h.apply(this,arguments);try{c=
i.apply(this,arguments)}catch(b){c=b}a.call(this,arguments,c);if(c instanceof Error)throw c;return c};c.advices={b:b,a:e,f:d};return c}function d(d){return function(e,h){var f=e._m,a;f&&((a=+f.w[h]||0)&&a!=d&&b._e("set chaining",h,e,d,a),f.w[h]=d)}}var h=b(b.Super,{constructor:function(){this.b=this.f.before;this.a=this.f.after;this.f=this.f.around}});b.mix(b,{Advice:h,advise:function(b){return new h(b)},before:function(b){return new h({before:b})},after:function(b){return new h({after:b})},around:b.superCall,
chainBefore:d(1),chainAfter:d(2),isInstanceOf:function(b,e){if(b instanceof e)return!0;var d=b.constructor._m,h;if(d)for(d=d.b,h=d.length-1;0<=h;--h)if(d[h]===e)return!0;return!1},_sb:function(d,e,h,f){var f=f[h]=b._ec(e,h,"f"),a=b._ec(e,h,"b").reverse(),e=b._ec(e,h,"a"),f=d?b._st(f,1==d?function(a){return b._sc(a.reverse())}:b._sc,h):b._ss(f,h);return!a.length&&!e.length?f||function(){}:g(b._sc(a),b._sc(e),f)}});return b})},"dcl/mini":function(){(function(b){"undefined"!=typeof define?define([],
b):"undefined"!=typeof module?module.exports=b():dcl=b()})(function(){function b(a,c){var e=[0],i,f,m,j,q,u,t,x,w=0,r;if(a)if(a instanceof Array){j={};t=a.slice(0).reverse();for(x=t.length-1;0<=x;--x)if(f=t[x],f._u=f._u||d++,i=f._m){for(u=i.b,w=u.length-1;0<w;--w)r=u[w]._u,j[r]=(j[r]||0)+1;t[x]=u.slice(0)}else t[x]=[f];q={};a:for(;t.length;){for(x=0;x<t.length;++x)if(u=t[x],f=u[0],r=f._u,!j[r]){q[r]||(e.push(f),q[r]=1);u.shift();u.length?--j[u[0]._u]:t.splice(x,1);continue a}b._e("cycle",c,t)}a=a[0];
w=e.length-((j=a._m)&&a===e[e.length-(w=j.b.length)]?w:1)-1}else a._u=a._u||d++,e=e.concat((j=a._m)?j.b:a);i=a?b.delegate(a[k]):{};for(u=a&&(j=a._m)?b.delegate(j.w):{constructor:2};0<w;--w)if(f=e[w],j=f._m,l(i,j&&j.h||f[k]),j)for(r in t=j.w)u[r]=(+u[r]||0)|t[r];for(r in c)g(j=c[r])?u[r]=+u[r]||0:i[r]=j;q={b:e,h:c,w:u,c:{}};e[0]={_m:q,prototype:i};f=i;j=q.w;u=q.b;t=q.c;for(m in j)f[m]=b._sb(j[m],u,m,t);m=i[h];m._m=q;m[k]=i;e[0]=m;return b._p(m)}function f(a){this.f=a}function g(a){return a instanceof
f}var d=0,h="constructor",k="prototype",e=function(){},j={},l,a,i,c,m;(l=function(a,c){for(var b in c)a[b]=c[b]})(b,{mix:l,delegate:function(a){e[k]=a;a=new e;e[k]=null;return a},Super:f,superCall:function(a){return new f(a)},_p:function(a){return a},_e:function(a){throw Error("dcl: "+a);},_f:function(a,c){var b=a.f(c);b.ctr=a.ctr;return b},_ec:a=function(a,c,b){for(var e=a.length-1,d=[],i,f,h="f"==b;i=a[e];--e)if((f=i._m)?(f=f.h).hasOwnProperty(c)&&(g(f=f[c])?h?f.f:f=f[b]:h):h&&(f=i[k][c])&&f!==
j[c])f.ctr=i,d.push(f);return d},_sc:c=function(a){var c=a.length,b;return!c?0:1==c?(b=a[0],function(){b.apply(this,arguments)}):function(){for(var b=0;b<c;++b)a[b].apply(this,arguments)}},_ss:i=function(a,c){for(var e=0,d,i=j[c];d=a[e];++e)i=g(d)?a[e]=b._f(d,i,c):d;return c!=h?i:function(){i.apply(this,arguments)}},_st:m=function(a,c,e){for(var d=0,i,f,m=0;i=a[d];++d)g(i)&&(f=d-m,a[d]=b._f(i,!f?0:1==f?a[m]:c(a.slice(m,d)),e),m=d);f=d-m;return!f?0:1==f&&e!=h?a[m]:c(m?a.slice(m):a)},_sb:function(b,
e,d,f){e=f[d]=a(e,d,"f");return(b?m(e,c,d):i(e,d))||function(){}}});return b})},"frozen/box2d/entities/Circle":function(){define(["dcl","./Entity","../../utils/distance"],function(b,f,g){return b(f,{declaredClass:"frozen/box2d/entities/Circle",radius:1,draw:b.superCall(function(b){return function(f,g){var g=g||this.scale||1,e=f.lineWidth;f.lineWidth=this.lineWidth;f.fillStyle=this.fillStyle;f.strokeStyle=this.strokeStyle;f.beginPath();f.arc(this.x*g,this.y*g,this.radius*g,0,2*Math.PI,!0);f.closePath();
f.fill();f.stroke();this.staticBody||(f.save(),f.translate(this.x*g,this.y*g),f.rotate(this.angle),f.translate(-this.x*g,-this.y*g),f.beginPath(),f.moveTo(this.x*g,this.y*g),f.lineTo(this.x*g,this.y*g-this.radius*g),f.closePath(),f.stroke(),f.restore());f.lineWidth=e;b.apply(this,[f,g])}}),scaleShape:b.superCall(function(b){return function(f){this.radius*=f;b.apply(this,[f])}}),pointInShape:function(b){return g(b,this)<=this.radius}})})},"frozen/box2d/entities/Entity":function(){define(["dcl","dcl/bases/Mixer",
"dojo/_base/lang"],function(b,f,g){return b(f,{declaredClass:"frozen/box2d/entities/Entity",id:0,x:0,y:0,scale:null,angle:0,center:null,restitution:0.3,density:1,friction:0.9,linearDamping:0,linearVelocity:null,angularVelocity:0,angularDamping:0,staticBody:!1,fillStyle:"rgba(128,128,128,0.5)",strokeStyle:"#000",lineWidth:1,maskBits:null,categoryBits:null,groupIndex:null,update:function(b){g.mixin(this,b)},draw:function(b,f){var f=f||this.scale||1,g=b.lineWidth;b.lineWidth=this.lineWidth;b.fillStyle=
this.strokeStyle;b.beginPath();b.arc(this.x*f,this.y*f,4,0,2*Math.PI,!0);b.closePath();b.fill();if(this.center)b.fillStyle="yellow",b.beginPath(),b.arc(this.center.x*f,this.center.y*f,2,0,2*Math.PI,!0),b.closePath(),b.fill();b.lineWidth=g},scaleShape:function(b){this.x*=b;this.y*=b;this.alreadyScaled=!0}})})},"dcl/bases/Mixer":function(){(function(b){"undefined"!=typeof define?define(["../mini"],b):"undefined"!=typeof module?module.exports=b(require("../mini")):dclBasesMixer=b(dcl)})(function(b){return b(null,
{declaredClass:"dcl/bases/Mixer",constructor:function(f){b.mix(this,f)}})})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(b,f){f.add("bug-for-in-skips-shadowed",function(){for(var a in{toString:1})return 0;return 1});var g=f("bug-for-in-skips-shadowed")?"hasOwnProperty.valueOf.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.constructor".split("."):[],d=g.length,h=function(a,e,c){var d,f=0,g=b.global;if(!c)if(a.length){d=a[f++];try{c=b.scopeMap[d]&&b.scopeMap[d][1]}catch(h){}c=
c||(d in g?g[d]:e?g[d]={}:void 0)}else return g;for(;c&&(d=a[f++]);)c=d in c?c[d]:e?c[d]={}:void 0;return c},k=Object.prototype.toString,e=function(a,b,c){return(c||[]).concat(Array.prototype.slice.call(a,b||0))},j=/\{([^\}]+)\}/g,l={_extraNames:g,_mixin:function(a,b,c){var e,h,j,k={};for(e in b)if(h=b[e],!(e in a)||a[e]!==h&&(!(e in k)||k[e]!==h))a[e]=c?c(h):h;if(f("bug-for-in-skips-shadowed")&&b)for(j=0;j<d;++j)if(e=g[j],h=b[e],!(e in a)||a[e]!==h&&(!(e in k)||k[e]!==h))a[e]=c?c(h):h;return a},
mixin:function(a,b){a||(a={});for(var c=1,e=arguments.length;c<e;c++)l._mixin(a,arguments[c]);return a},setObject:function(a,b,c){var e=a.split("."),a=e.pop();return(c=h(e,!0,c))&&a?c[a]=b:void 0},getObject:function(a,b,c){return h(a.split("."),b,c)},exists:function(a,b){return void 0!==l.getObject(a,!1,b)},isString:function(a){return"string"==typeof a||a instanceof String},isArray:function(a){return a&&(a instanceof Array||"array"==typeof a)},isFunction:function(a){return"[object Function]"===k.call(a)},
isObject:function(a){return void 0!==a&&(null===a||"object"==typeof a||l.isArray(a)||l.isFunction(a))},isArrayLike:function(a){return a&&void 0!==a&&!l.isString(a)&&!l.isFunction(a)&&!(a.tagName&&"form"==a.tagName.toLowerCase())&&(l.isArray(a)||isFinite(a.length))},isAlien:function(a){return a&&!l.isFunction(a)&&/\{\s*\[native code\]\s*\}/.test(""+a)},extend:function(a,b){for(var c=1,e=arguments.length;c<e;c++)l._mixin(a.prototype,arguments[c]);return a},_hitchArgs:function(a,e){var c=l._toArray(arguments,
2),d=l.isString(e);return function(){var f=l._toArray(arguments),g=d?(a||b.global)[e]:e;return g&&g.apply(a||this,c.concat(f))}},hitch:function(a,e){if(2<arguments.length)return l._hitchArgs.apply(b,arguments);e||(e=a,a=null);if(l.isString(e)){a=a||b.global;if(!a[e])throw['lang.hitch: scope["',e,'"] is null (scope="',a,'")'].join("");return function(){return a[e].apply(a,arguments||[])}}return!a?e:function(){return e.apply(a,arguments||[])}},delegate:function(){function a(){}return function(b,c){a.prototype=
b;var e=new a;a.prototype=null;c&&l._mixin(e,c);return e}}(),_toArray:f("ie")?function(){function a(a,b,e){e=e||[];for(b=b||0;b<a.length;b++)e.push(a[b]);return e}return function(b){return(b.item?a:e).apply(this,arguments)}}():e,partial:function(a){return l.hitch.apply(b,[null].concat(l._toArray(arguments)))},clone:function(a){if(!a||"object"!=typeof a||l.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return RegExp(a);
var b,c,e;if(l.isArray(a)){b=[];for(c=0,e=a.length;c<e;++c)c in a&&b.push(l.clone(a[c]))}else b=a.constructor?new a.constructor:{};return l._mixin(b,a,l.clone)},trim:String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(a,b,c){return a.replace(c||j,l.isFunction(b)?b:function(a,c){return l.getObject(c,!1,b)})}};l.mixin(b,l);return l})},"frozen/utils/distance":function(){define(function(){return function(b,f){return Math.sqrt((f.x-
b.x)*(f.x-b.x)+(f.y-b.y)*(f.y-b.y))}})},"frozen/Animation":function(){define(["./AnimFrame","dcl","dcl/bases/Mixer"],function(b,f,g){var d=f(g,{currFrameIndex:0,animTime:0,totalDuration:0,height:64,width:64,image:null,offsetX:0,offsetY:0,constructor:function(){this.start()},createFromSheet:function(b,f,e,g,l,a){e=new d({image:e,height:l,width:g});g=Array.isArray(f);l=1;a||(a=0);for(var i=0;i<b;i++)l=g?f[i]:f,e.addFrame(l,i,a);return e},clone:function(){return new d({image:this.image,frames:this.frames,
totalDuration:this.totalDuration})},addFrame:function(d,f,e){if(!this.frames)this.frames=[];this.totalDuration+=d;this.frames.push(new b({endTime:this.totalDuration,image:this.image,imgSlotX:f,imgSlotY:e}))},start:function(){this.currFrameIndex=this.animTime=0},update:function(b){if(1<this.frames.length){this.animTime+=b;if(this.animTime>=this.totalDuration)this.animTime%=this.totalDuration,this.currFrameIndex=0;for(;this.animTime>this.frames[this.currFrameIndex].endTime;)this.currFrameIndex++}},
getCurrentFrame:function(){return 0===this.frames.length?null:this.frames[this.currFrameIndex]},draw:function(b,d,e){var f=this.getCurrentFrame();b.drawImage(this.image,f.imgSlotX*this.width+this.offsetX,f.imgSlotY*this.height+this.offsetY,this.width,this.height,d,e,this.width,this.height)}});return d})},"frozen/AnimFrame":function(){define(["dcl","dcl/bases/Mixer"],function(b,f){return b(f,{endTime:0,imgSlotX:0,imgSlotY:0,image:null})})},"frozen/plugins/loadImage":function(){define(["../ResourceManager",
"../utils/parseString"],function(b,f){var g=new b;return{load:function(b,h,k){b=f(b);"string"!==typeof b?Object.keys(b).forEach(function(e){b[e]=h.toUrl(b[e])}):b=h.toUrl(b);var e=g.loadImage(b);k(e)}}})},"frozen/ResourceManager":function(){define(["./plugins/sound!","dcl","dcl/bases/Mixer","dojo/_base/lang","dojo/on"],function(b,f,g,d,h){function k(b,d){var f=d;b&&(f=[b,d].join("/"));return f.replace(/\/{2,}/g,"/")}return f(g,{allLoaded:!1,imageDir:null,soundDir:null,resourceList:{},loadImage:function(b){var f=
!1;if(!Array.isArray(b))if("string"===typeof b)f=!0,b=[b];else if("object"!==typeof b)return;for(var g in b)if(b.hasOwnProperty(g)){var a=k(this.imageDir,b[g]);if(this.resourceList[a])b[g]=this.resourceList[a].img;else{this.allLoaded=!1;var i=new Image,c={name:a,img:i,complete:!1},m=d.partial(function(a){a.complete=!0},c);h(i,"load",m);i.src=a;this.resourceList[a]=c;b[g]=i}}return f?b[0]:b},loadSound:function(e){var d=!1;if(!Array.isArray(e))if("string"===typeof e)d=!0,e=[e];else if("object"!==typeof e)return;
for(var f in e)if(e.hasOwnProperty(f)){var a=k(this.soundDir,e[f]);if(this.resourceList[a])e[f]=this.resourceList[a];else{this.allLoaded=!1;var i=new b(a);this.resourceList[a]=i;e[f]=i}}return d?e[0]:e},resourcesReady:function(){if(!this.allLoaded){for(var b in this.resourceList)if(!this.resourceList[b].complete)return!1;this.allLoaded=!0}return!0},getPercentComplete:function(){var b=0,d=0,f;for(f in this.resourceList){var a=this.resourceList[f];d++;a.complete&&(b+=1)}return 0===d?0:Math.round(100*
(b/d))}})})},"frozen/plugins/sound":function(){define(["../sounds/Sound","../sounds/WebAudio","../sounds/HTML5Audio","dojo/has"],function(b,f,g,d){return{load:function(h,k,e){return d("WebAudio")?e(f):d("HTML5Audio")?e(g):e(b)}}})},"frozen/sounds/Sound":function(){define(["dcl"],function(b){return b(null,{declaredClass:"frozen/sounds/Sound",name:null,complete:!1,formats:{"audio/mpeg":".mp3","audio/webm":".webm","audio/ogg":".ogg","audio/wav":".wav","audio/aac":".aac","audio/x-m4a":".m4a"},probably:null,
maybe:null,constructor:function(b){if(!this.probably)this.probably=[];if(!this.maybe)this.maybe=[];"string"===typeof b&&this.load(b)},load:function(b){this.name=b;this.complete=!0},loop:function(){},play:function(){},_initAudio:function(){},_chooseFormat:function(){if(!this.probably.length&&!this.maybe.length){var b=new Audio,g,d;for(g in this.formats)d=b.canPlayType(g),"probably"===d?this.probably.push(this.formats[g]):"maybe"===d&&this.maybe.push(this.formats[g])}return this.probably.length?this.probably[0]:
this.maybe.length?this.maybe[0]:""},_nextFormat:function(){if(1<this.probably.length)return this.probably.shift(),this.probably[0];if(1===this.probably.length&&(this.probably.length=0,this.maybe.length))return this.maybe[0];if(1<this.maybe.length)return this.maybe.shift(),this.maybe[0];if(1===this.maybe.length)this.maybe.length=0;return""}})})},"frozen/sounds/WebAudio":function(){define("./Sound,../utils/removeExtension,dcl,dojo/on,dojo/has,../shims/AudioContext".split(","),function(b,f,g,d,h){h.add("WebAudio",
function(b){return!!b.AudioContext});var k=null;h("WebAudio")&&(k=new window.AudioContext);return g(b,{declaredClass:"frozen/sounds/WebAudio",audioContext:k,buffer:null,load:function(b){var g=this;this.name=b;var h=f(b);h===b&&(b=h+this._chooseFormat());h=new XMLHttpRequest;h.open("GET",b,!0);h.responseType="arraybuffer";d.once(h,"load",function(a){g.audioContext.decodeAudioData(a.target.response,function(a){g.buffer=a;g.complete=!0},function(){g._nextFormat()?g.load(g.name):g.complete=!0})});h.send()},
loop:function(b){this.buffer&&this._initAudio(b,!0).noteOn(0)},play:function(b,d){this.buffer&&this._initAudio(b,!1).noteOn(d||0)},_initAudio:function(b,d){var d="boolean"===typeof d?d:!1,f=this.audioContext.createBufferSource();f.buffer=this.buffer;f.loop=d;if(b){var a=this.audioContext.createGainNode();a.gain.value=b;f.connect(a);a.connect(this.audioContext.destination)}else f.connect(this.audioContext.destination);return f}})})},"frozen/utils/removeExtension":function(){define(function(){return function(b){var f=
b.lastIndexOf(".");return 0>f?b:b.slice(0,f)}})},"dojo/on":function(){define(["require","./_base/kernel","./has"],function(b,f,g){function d(a,b,c,d,f){if(d=b.match(/(.*):(.*)/))return b=d[2],d=d[1],e.selector(d,b).call(f,a,c);g("touch")&&(j.test(b)&&(c=v(c)),!g("event-orientationchange")&&"orientationchange"==b&&(b="resize",a=window,c=v(c)));m&&(c=m(c));if(a.addEventListener){var h=b in i,n=h?i[b]:b;a.addEventListener(n,c,h);return{remove:function(){a.removeEventListener(n,c,h)}}}b="on"+b;throw Error("Target must be an event emitter");
}function h(){this.cancelable=!1}function k(){this.bubbles=!1}b=window.ScriptEngineMajorVersion;g.add("jscript",b&&b()+ScriptEngineMinorVersion()/10);g.add("event-orientationchange",g("touch")&&!g("android"));g.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);var e=function(a,b,c,f){return"function"==typeof a.on&&"function"!=typeof b?a.on(b,c):e.parse(a,b,c,d,f,this)};e.pausable=function(a,b,c,d){var f,a=e(a,b,function(){if(!f)return c.apply(this,
arguments)},d);a.pause=function(){f=!0};a.resume=function(){f=!1};return a};e.once=function(a,b,c){var d=e(a,b,function(){d.remove();return c.apply(this,arguments)});return d};e.parse=function(a,b,c,e,d,f){if(b.call)return b.call(f,a,c);if(-1<b.indexOf(",")){for(var b=b.split(/\s*,\s*/),g=[],i=0,h;h=b[i++];)g.push(e(a,h,c,d,f));g.remove=function(){for(var a=0;a<g.length;a++)g[a].remove()};return g}return e(a,b,c,d,f)};var j=/^touch/;e.selector=function(a,b,c){return function(d,g){function i(b){for(h=
h&&h.matches?h:f.query;!h.matches(b,a,d);)if(b==d||!1===c||!(b=b.parentNode)||1!=b.nodeType)return;return b}var h="function"==typeof a?{matches:a}:this,m=b.bubble;return m?e(d,m(i),g):e(d,b,function(a){var b=i(a.target);return b&&g.call(b,a)})}};var l=[].slice,a=e.emit=function(a,b,c){var e=l.call(arguments,2),d="on"+b;if("parentNode"in a){var f=e[0]={},g;for(g in c)f[g]=c[g];f.preventDefault=h;f.stopPropagation=k;f.target=a;f.type=b;c=f}do a[d]&&a[d].apply(a,e);while(c&&c.bubbles&&(a=a.parentNode));
return c&&c.cancelable&&c},i={};if(!g("event-stopimmediatepropagation"))var c=function(){this.modified=this.immediatelyStopped=!0},m=function(a){return function(b){if(!b.immediatelyStopped)return b.stopImmediatePropagation=c,a.apply(this,arguments)}};i={focusin:"focus",focusout:"blur"};e.emit=function(b,c,d){if(b.dispatchEvent&&document.createEvent){var f=b.ownerDocument.createEvent("HTMLEvents");f.initEvent(c,!!d.bubbles,!!d.cancelable);for(var g in d)g in f||(f[g]=d[g]);return b.dispatchEvent(f)&&
f}return a.apply(e,arguments)};if(g("touch"))var n=function(){},p=window.orientation,v=function(a){return function(b){var c=b.corrected;if(!c){var e=b.type;try{delete b.type}catch(d){}b.type?(n.prototype=b,c=new n,c.preventDefault=function(){b.preventDefault()},c.stopPropagation=function(){b.stopPropagation()}):(c=b,c.type=e);b.corrected=c;if("resize"==e){if(p==window.orientation)return null;p=window.orientation;c.type="orientationchange";return a.call(this,c)}if(!("rotation"in c))c.rotation=0,c.scale=
1;var e=c.changedTouches[0],f;for(f in e)delete c[f],c[f]=e[f]}return a.call(this,c)}};return e})},"frozen/shims/AudioContext":function(){define(function(){for(var b=["ms","moz","webkit","o"],f=0;f<b.length&&!window.AudioContext;++f)window.AudioContext=window[b[f]+"AudioContext"]})},"frozen/sounds/HTML5Audio":function(){define(["./Sound","../utils/removeExtension","dcl","dojo/on","dojo/has"],function(b,f,g,d,h){h.add("HTML5Audio",function(b){return!!b.Audio});h.add("shittySound",function(){return!(!h("android")&&
!h("ios")||!h("webkit"))});return g(b,{declaredClass:"frozen/sounds/HTML5Audio",audio:null,load:function(b){this.audio=new Audio;var e=this;this.name=b;var g=f(b);g===b&&(b=g+this._chooseFormat());if(h("shittySound"))d.once(document,"touchstart",function(){e.audio.load()}),this._updateCurrentTime=null,d.once(this.audio,"progress",function(){null!==e._updateCurrentTime&&e._updateCurrentTime()});this.audio.pause();this.audio.preload="auto";d.once(this.audio,"error",function(){e._nextFormat()?e.load(e.name):
(e.audio.src=null,e.complete=!0)});d.once(this.audio,"loadeddata",function(){e.complete=!0});this.audio.src=b},loop:function(b){var e=this._initAudio(b,!0);d.once(e,"loadeddata",function(){e.play()})},play:function(b,e){e=e||0;if(h("shittySound"))try{return this.audio.currentTime=e/1E3,this.audio.play()}catch(f){return this._updateCurrentTime=function(){this._updateCurrentTime=null;this.audio.currentTime=e/1E3;return this.audio.play()},this.audio.play()}var g=this._initAudio(b,!1);d.once(g,"loadeddata",
function(){g.currentTime=e/1E3;g.play()})},_initAudio:function(b,e){var e="boolean"===typeof e?e:!1,d=new Audio;d.pause();d.volume=b||1;d.loop=e;d.preload="auto";d.mozLoadFrom?d.mozLoadFrom(this.audio):d.src=this.audio.currentSrc;return d}})})},"frozen/utils/parseString":function(){define(function(){return function(b){0===b.indexOf("{")&&b.lastIndexOf("}")===b.length-1?b=JSON.parse(b.replace(/,/g,'","').replace(/:(?!\/\/)/g,'":"').replace(/\{/,'{"').replace(/\}/,'"}')):0===b.indexOf("[")&&b.lastIndexOf("]")===
b.length-1&&(b=JSON.parse(b.replace(/,/g,'","').replace(/\[/g,'["').replace(/\]/g,'"]')));return b}})},"game/Paddle":function(){define(["dcl","frozen/box2d/entities/Rectangle","frozen/plugins/loadImage!resources/tiles.png"],function(b,f,g){return b(f,{id:"paddle",x:110,y:376,halfWidth:24,halfHeight:8,bigHalfWidth:24,smallHalfWidth:16,smallMillis:0,smallMillisStart:1E4,friction:0,categoryBits:2,draw:function(b){0<this.smallMillis?b.drawImage(g,0,80,32,16,(this.x-this.halfWidth)*this.scale,(this.y-
this.halfHeight)*this.scale,32,16):b.drawImage(g,0,64,48,16,(this.x-this.halfWidth)*this.scale,(this.y-this.halfHeight)*this.scale,48,16)}})})},"frozen/box2d/entities/Rectangle":function(){define(["dcl","./Entity"],function(b,f){return b(f,{declaredClass:"frozen/box2d/entities/Rectangle",halfWidth:1,halfHeight:1,draw:b.superCall(function(b){return function(d,f){var f=f||this.scale||1,k=d.lineWidth;d.lineWidth=this.lineWidth;d.save();d.translate(this.x*f,this.y*f);d.rotate(this.angle);d.translate(-this.x*
f,-this.y*f);d.fillStyle=this.fillStyle;d.strokeStyle=this.strokeStyle;d.fillRect((this.x-this.halfWidth)*f,(this.y-this.halfHeight)*f,2*this.halfWidth*f,2*this.halfHeight*f);d.strokeRect((this.x-this.halfWidth)*f,(this.y-this.halfHeight)*f,2*this.halfWidth*f,2*this.halfHeight*f);d.restore();d.lineWidth=k;b.apply(this,[d,f])}}),scaleShape:b.superCall(function(b){return function(d){this.halfHeight*=d;this.halfWidth*=d;b.apply(this,[d])}}),pointInShape:function(b){return b.x>=this.x-this.halfWidth&&
b.x<=this.x+this.halfWidth&&b.y>=this.y-this.halfHeight&&b.y<=this.y+this.halfHeight}})})},"game/PaddleJoint":function(){define(["dcl","frozen/box2d/joints/Prismatic"],function(b,f){return b(f,{bodyId1:"paddle",bodyId2:"leftWall",id:"pJoint"})})},"frozen/box2d/joints/Prismatic":function(){define(["dcl","dojo/_base/lang","./Joint"],function(b,f,g){var d=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.Joints.b2PrismaticJointDef;return b(g,{declaredClass:"frozen/box2d/joints/Prismatic",axisScale:null,createB2Joint:function(b){if(b&&
b.bodiesMap&&b.b2World&&b.jointsMap&&!b.jointsMap[this.id]){var e=b.bodiesMap[this.bodyId1],g=b.bodiesMap[this.bodyId2];if(e&&g){var l;this.bodyPoint1&&(l=new d(this.bodyPoint1.x,this.bodyPoint1.y));l=l||e.GetWorldCenter();var a=new h,i;i=this.axisScale?new d(this.axisScale.x,this.axisScale.y):new d(1,0);a.Initialize(e,g,l,i);this.jointAttributes&&f.mixin(a,this.jointAttributes);return b.b2World.CreateJoint(a)}}}})})},"frozen/box2d/joints/Joint":function(){define(["dcl","dcl/bases/Mixer"],function(b,
f){return b(f,{declaredClass:"frozen/box2d/joints/Joint",bodyId1:null,bodyId2:null,bodyPoint1:null,jointAttributes:null,scaleJointLocation:function(b){if(b&&this.bodyPoint1)this.bodyPoint1.x*=b,this.bodyPoint1.y*=b,this.alreadyScaled=!0}})})},"game/PowerUp":function(){define(["./Power","dcl"],function(b,f){return f(b,{powerUp:!0,draw:function(b){b.drawImage(this.tiles,96,96,16,16,this.x*this.scale-8,this.y*this.scale-8,16,16)}})})},"game/Power":function(){define(["lodash","dcl","frozen/box2d/entities/Rectangle",
"frozen/plugins/loadImage!resources/tiles.png"],function(b,f,g,d){return f(g,{halfWidth:8,halfHeight:8,staticBody:!1,impulse:1,maskBits:2,groupIndex:-1,tiles:d,constructor:function(){if(!this.id)this.id=b.uniqueId()}})})},"game/PowerDown":function(){define(["./Power","dcl"],function(b,f){return f(b,{powerDown:!0,draw:function(b){b.drawImage(this.tiles,112,96,16,16,this.x*this.scale-8,this.y*this.scale-8,16,16)}})})},"frozen/plugins/loadSound":function(){define(["../ResourceManager","../utils/parseString"],
function(b,f){var g=new b;return{load:function(b,h,k){b=f(b);"string"!==typeof b?Object.keys(b).forEach(function(e){b[e]=h.toUrl(b[e])}):b=h.toUrl(b);var e=g.loadSound(b);k(e)}}})},"game/draw":function(){define(["lodash","frozen/plugins/loadImage!resources/bg_prerendered.png","frozen/plugins/loadImage!resources/logo.png","frozen/plugins/loadImage!resources/tiles.png"],function(b,f,g,d){return function(h){h.font="20px Arial";h.fillStyle="#000";h.drawImage(f,0,0);if(1===this.state.screen){this.entities.paddle.draw(h);
var k=Array.prototype.concat.call(this.state.balls,this.state.currentBricks,this.state.powerUps,this.state.powerDowns);b.forEach(k,function(b){b.draw(h)});h.fillText("lives: "+this.state.lives,20,405);h.textAlign="center";h.fillText("score: "+this.state.score,this.width/2,405);h.textAlign="right";h.fillText("level: "+(this.state.currentLevel+1),300,405);0<this.state.launchMillis&&(k=Math.floor(Math.abs(this.state.launchMillis-3E3)/1E3),h.drawImage(d,32*k,96,32,48,144,180,32,48))}else k=this.width/
2,h.drawImage(g,k-g.width/2,70),h.textAlign="center",0===this.state.screen?this.mobile?h.fillText("Tap to start",k,315):(h.fillText("Click to start",k,315),h.fillText("during the game: use L/R arrow",k,380),h.fillText("keys to skip levels",k,400)):2===this.state.screen?h.fillText("Game Over",k,300):3===this.state.screen&&h.fillText("You Win!",k,300)}})},"game/walls":function(){define({entities:[{x:5,y:182,halfWidth:11,halfHeight:185,staticBody:!0,zone:!1,type:"Rectangle",id:"leftWall"},{x:315,y:182,
halfWidth:11,halfHeight:184.5,staticBody:!0,zone:!1,type:"Rectangle",id:"rightWall"},{x:159,y:8,halfWidth:158,halfHeight:7,staticBody:!0,zone:!1,type:"Rectangle",id:"top"},{x:313,y:401,halfWidth:8,halfHeight:16,staticBody:!0,zone:!1,type:"Rectangle",id:"rightBottom"},{x:6,y:401,halfWidth:10,halfHeight:15.5,staticBody:!0,zone:!1,type:"Rectangle",id:"leftBottom"},{x:-10,y:373,halfWidth:10,halfHeight:37,staticBody:!0,zone:!1,type:"Rectangle",id:"leftBlocker"},{x:330,y:375.5,halfWidth:10,halfHeight:29.5,
staticBody:!0,zone:!1,type:"Rectangle",id:"rightBlocker"}],joints:[],canvas:{height:416,width:320}})},"game/loadLevel":function(){define(["./Brick","./levels","lodash"],function(b,f,g){return function(d){var h=this.width/2-112,d=f[d],k=0;this.removeBodies(this.state.currentBricks);this.state.currentBricks=[];g.forEach(d.bricks,function(e,d){g.forEach(e,function(a,e){if(null!==a){var c=new b({brickType:a,x:h+32*e+16,y:16*d+78});this.addBody(c);this.state.currentBricks.push(c)}},this)},this);var e=
g.shuffle(this.state.currentBricks);g.times(d.powerUps,function(){e[k].powerUpBrick=!0;k++});g.times(d.powerDowns,function(){e[k].powerDownBrick=!0;k++});this.state.currentBricks=e;this.state.launchMillis=3001;if(0<this.entities.paddle.slowMillis)this.entities.paddle.slowMillis=1;this.removeBodies(this.state.balls,this.state.powerUps,this.state.powerDowns);this.state.balls=[];this.state.powerUps=[];this.state.powerDowns=[];this.newBall()}})},"game/Brick":function(){define("lodash,dcl,frozen/box2d/entities/Rectangle,frozen/Animation,frozen/plugins/loadImage!resources/tiles.png,dojo/on".split(","),
function(b,f,g,d,h,k){var e=null;k(h,"load",function(){var b=document.createElement("canvas");b.height=h.height;b.width=h.width;var d=b.getContext("2d");d.translate(b.width,0);d.scale(-1,1);d.drawImage(h,0,0);e=b});return f(g,{img:h,x:100,y:376,halfWidth:15.5,halfHeight:7.5,staticBody:!0,friction:0,dyingAnim:null,birthingAnim:null,dead:!1,dying:!1,dyingMillis:300,birthing:!0,birthingMillis:300,powerUpBrick:!1,powerDownBrick:!1,brick:!0,brickType:0,constructor:function(){if(!this.id)this.id=b.uniqueId()},
getBirthingAnim:function(){if(!this.birthingAnim)this.birthingAnim=d.prototype.createFromSheet(3,100,e,32,16),this.birthingAnim.offsetX=32,this.birthingAnim.offsetY=16*this.brickType;return this.birthingAnim},getDyingAnim:function(){if(!this.dyingAnim)this.dyingAnim=d.prototype.createFromSheet(4,100,h,32,16),this.dyingAnim.offsetX=64,this.dyingAnim.offsetY=16*this.brickType;return this.dyingAnim},updateAnimation:function(b){if(this.dying){if(this.getDyingAnim().update(b),this.dyingMillis-=b,0>=this.dyingMillis)this.dying=
!1,this.dead=!0}else if(this.birthing&&(this.getBirthingAnim().update(b),this.birthingMillis-=b,0>=this.birthingMillis))this.birthing=!1},draw:function(b){this.dead||(this.dying?this.getDyingAnim().draw(b,this.x*this.scale-16,this.y*this.scale-8):this.birthing?this.getBirthingAnim().draw(b,this.x*this.scale-16,this.y*this.scale-8):b.drawImage(this.img,0,16*this.brickType,32,16,this.x*this.scale-16,this.y*this.scale-8,32,16))}})})},"frozen/box2d/BoxGame":function(){define(["../GameCore","./Box","dcl"],
function(b,f,g){return g(b,{box:null,boxUpdating:!0,entities:null,joints:null,constructor:function(){if(!this.box)this.box=new f;if(!this.entities)this.entities={};if(!this.joints)this.joints={}},preUpdate:function(b){this.boxUpdating&&(this.box.update(b),this.box.updateExternalState(this.entities))},addBody:function(b){this.entities[b.id]=b;this.box.addBody(b)},removeBody:function(b){this.box.removeBody(b.id);delete this.entities[b.id]},addJoint:function(b){this.joints[b.id]=b;this.box.addJoint(b)},
removeJoint:function(b){this.box.removeJoint(b.id);delete this.joints[b.id]}})})},"frozen/GameCore":function(){define("dcl,dcl/bases/Mixer,dojo/_base/lang,dojo/dom,./InputManager,./ResourceManager,./shims/RAF".split(","),function(b,f,g,d,h,k){return b(f,{statics:{FONT_SIZE:24},isRunning:!1,canvasId:null,maxStep:40,contextType:"2d",height:0,width:0,resourceManager:null,inputManager:null,loadingForeground:"#00F",loadingBackground:"#FFF",gameAreaId:null,canvasPercentage:0,setHeight:function(b){this.height=
b;this.canvas.height=b},setWidth:function(b){this.width=b;this.canvas.width=b},stop:function(){this.isRunning=!1},run:function(){this.isRunning||(this.init(),this.loadResources(this.resourceManager),this.initInput(this.inputManager),this.launchLoop())},loadResources:function(){},init:function(){if(!this.canvas)this.canvas=d.byId(this.canvasId);if(this.canvas){if(!this.context)this.context=this.canvas.getContext(this.contextType);if(this.context){this.setHeight(this.height||this.canvas.height);this.setWidth(this.width||
this.canvas.width);if(!this.inputManager)this.inputManager=this.gameAreaId&&this.canvasPercentage?new h({canvas:this.canvas,gameArea:d.byId(this.gameAreaId),canvasPercentage:this.canvasPercentage}):new h({canvas:this.canvas});this.inputManager.resize();if(!this.resourceManager)this.resourceManager=new k;this.loadResources(this.resourceManager);this.isRunning=!0}else alert("Sorry, your browser does not support a "+this.contextType+" drawing surface on canvas.  I recommend any browser but Internet Explorer")}else alert("Sorry, your browser does not support canvas.  I recommend any browser but Internet Explorer")},
initInput:function(){},handleInput:function(){},gameLoop:function(){this.currTime=(new Date).getTime();this.elapsedTime=Math.min(this.currTime-this.prevTime,this.maxStep);this.prevTime=this.currTime;this.resourceManager&&!this.resourceManager.resourcesReady()?(this.updateLoadingScreen(this.elapsedTime),this.drawLoadingScreen(this.context)):(this.handleInput(this.inputManager,this.elapsedTime),this.paused||(this.preUpdate(this.elapsedTime),this.update(this.elapsedTime)),this.context.save(),this.draw(this.context),
this.context.restore())},launchLoop:function(){this.elapsedTime=0;var b=Date.now();this.prevTime=this.currTime=b;this.loopRunner=g.hitch(this,this.loopRunner);window.requestAnimationFrame(this.loopRunner)},loopRunner:function(){this.gameLoop();window.requestAnimationFrame(this.loopRunner)},preUpdate:function(){},update:function(){},updateLoadingScreen:function(){},draw:function(b){if("2d"===this.contextType)b.font="14px sans-serif",b.fillText("This game does not have its own draw function!",10,50)},
drawLoadingScreen:function(b){if(this.resourceManager&&"2d"===this.contextType)b.fillStyle=this.loadingBackground,b.fillRect(0,0,this.width,this.height),b.fillStyle=this.loadingForeground,b.strokeStyle=this.loadingForeground,b.font="bold "+Math.floor(this.height/12)+"px sans-serif",b.fillText("Loading... "+this.resourceManager.getPercentComplete()+"%",0.1*this.width,0.55*this.height),b.strokeRect(0.1*this.width,0.7*this.height,0.8*this.width,0.1*this.height),b.fillRect(0.1*this.width,0.7*this.height,
0.8*this.width*this.resourceManager.getPercentComplete()/100,0.1*this.height),b.lineWidth=4}})})},"dojo/dom":function(){define(["./sniff","./_base/window"],function(b,f){if(7>=b("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(g){}var d={};d.byId=b("ie")?function(b,e){if("string"!=typeof b)return b;var d=e||f.doc,g=b&&d.getElementById(b);if(g&&(g.attributes.id.value==b||g.id==b))return g;d=d.all[b];if(!d||d.nodeName)d=[d];for(var a=0;g=d[a++];)if(g.attributes&&g.attributes.id&&g.attributes.id.value==
b||g.id==b)return g}:function(b,d){return("string"==typeof b?(d||f.doc).getElementById(b):b)||null};d.isDescendant=function(b,e){try{b=d.byId(b);for(e=d.byId(e);b;){if(b==e)return!0;b=b.parentNode}}catch(f){}return!1};b.add("css-user-select",function(b,d,f){if(!f)return!1;var b=f.style,d=["Khtml","O","ms","Moz","Webkit"],f=d.length,g="userSelect";do if("undefined"!==typeof b[g])return g;while(f--&&(g=d[f]+"UserSelect"));return!1});var h=b("css-user-select");d.setSelectable=h?function(b,e){d.byId(b).style[h]=
e?"":"none"}:function(b,e){var b=d.byId(b),f=b.getElementsByTagName("*"),g=f.length;if(e)for(b.removeAttribute("unselectable");g--;)f[g].removeAttribute("unselectable");else for(b.setAttribute("unselectable","on");g--;)f[g].setAttribute("unselectable","on")};return d})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(b,f,g){var d={global:b.global,doc:this.document||null,body:function(d){d=d||b.doc;return d.body||d.getElementsByTagName("body")[0]},setContext:function(f,
g){b.global=d.global=f;b.doc=d.doc=g},withGlobal:function(f,g,e,j){var l=b.global;try{return b.global=d.global=f,d.withDoc.call(null,f.document,g,e,j)}finally{b.global=d.global=l}},withDoc:function(f,k,e,j){var l=d.doc,a=g("quirks"),i=g("ie"),c,m,n;try{b.doc=d.doc=f;b.isQuirks=g.add("quirks","BackCompat"==b.doc.compatMode,!0,!0);if(g("ie")&&(n=f.parentWindow)&&n.navigator)c=parseFloat(n.navigator.appVersion.split("MSIE ")[1])||void 0,(m=f.documentMode)&&5!=m&&Math.floor(c)!=m&&(c=m),b.isIE=g.add("ie",
c,!0,!0);e&&"string"==typeof k&&(k=e[k]);return k.apply(e,j||[])}finally{b.doc=d.doc=l,b.isQuirks=g.add("quirks",a,!0,!0),b.isIE=g.add("ie",i,!0,!0)}}};f.mixin(b,d);return d})},"frozen/InputManager":function(){define("./GameAction,./MouseAction,./utils/insideCanvas,dcl,dcl/bases/Mixer,dcl/mixins/Cleanup,dojo/has,dojo/on,dojo/dom-style,dojo/dom-geometry,dojo/_base/lang,dojo/domReady!".split(","),function(b,f,g,d,h,k,e,j,l,a,i){return d([h,k],{keyActions:[],mouseAction:null,touchAction:null,canvas:null,
handleMouse:!0,handleTouch:!0,handleKeys:!0,gameArea:null,canvasPercentage:null,constructor:function(){function a(b){b.remove()}this.handleKeys&&(this.pushCleanup(j(document,"keydown",i.hitch(this,"keyDown")),a),this.pushCleanup(j(document,"keyup",i.hitch(this,"keyReleased")),a));this.handleMouse&&!e("touch")&&(this.pushCleanup(j(document,"mousedown",i.hitch(this,"mouseDown")),a),this.pushCleanup(j(document,"mousemove",i.hitch(this,"mouseMove")),a),this.pushCleanup(j(document,"mouseup",i.hitch(this,
"mouseUp")),a));this.handleTouch&&e("touch")&&(this.pushCleanup(j(document,"touchstart",i.hitch(this,"touchStart")),a),this.pushCleanup(j(document,"touchmove",i.hitch(this,"touchMove")),a),this.pushCleanup(j(document,"touchend",i.hitch(this,"touchEnd")),a));if(!this.mouseAction)this.mouseAction=new f;if(!this.touchAction)this.touchAction=new f;this.gameArea&&this.canvasPercentage&&(this.pushCleanup(j(window,"resize",i.hitch(this,"resize")),a),this.pushCleanup(j(window,"orientationchange",i.hitch(this,
"resize")),a))},mapToKey:function(a,b){if(!this.keyActions)this.keyActions=[];this.keyActions[b]=a},addKeyAction:function(a,d){var e=new b;if(d)e.behavior=e.statics.DETECT_INITAL_PRESS_ONLY;this.mapToKey(e,a);return e},mouseUp:function(a){this.mouseAction.release();this.mouseAction.endPosition=this.getMouseLoc(a)},mouseDown:function(a){a=this.getMouseLoc(a);this.mouseAction.endPosition=null;this.mouseAction.insideCanvas=g(a,this.canvas);this.mouseAction.insideCanvas?(this.mouseAction.press(),this.mouseAction.startPosition=
a,this.mouseAction.position=a):this.mouseAction.startPosition=null},mouseMove:function(a){this.mouseAction.position=this.getMouseLoc(a)},touchStart:function(a){a=this.getMouseLoc(a.changedTouches[0]);this.touchAction.endPosition=null;this.touchAction.insideCanvas=g(a,this.canvas);this.touchAction.insideCanvas?(this.touchAction.press(),this.touchAction.startPosition=a,this.touchAction.position=a):this.touchAction.startPosition=null},touchEnd:function(a){this.touchAction.release();this.touchAction.endPosition=
this.getMouseLoc(a.changedTouches[0])},touchMove:function(a){this.touchAction.position=this.getMouseLoc(a.changedTouches[0]);this.touchAction.startPosition&&a.preventDefault()},getKeyAction:function(a){return this.keyActions.length?this.keyActions[a.keyCode]||this.keyActions[String.fromCharCode(a.keyCode)]:null},keyPressed:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyDown:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyReleased:function(a){(a=this.getKeyAction(a))&&
a.release()},getMouseLoc:function(b){var d=a.position(this.canvas);return this.zoomRatio?{x:Math.round((b.clientX-d.x)/this.zoomRatio),y:Math.round((b.clientY-d.y)/this.zoomRatio)}:{x:Math.round(b.clientX-d.x),y:Math.round(b.clientY-d.y)}},resize:function(){if(this.gameArea&&this.canvasPercentage&&this.canvas){var b=this.canvas.width,d=this.canvas.height,e=a.getMarginExtents(document.body),f=window.innerWidth-e.w,e=window.innerHeight-e.h,d=b/d,g="",i="";f/e>d?(f=e*d,g=f+"px",i=e+"px"):(g=f+"px",i=
Math.round(f/d)+"px");this.zoomRatio=f/b*this.canvasPercentage;l.set(this.gameArea,{width:g,height:i});b=Math.floor(100*this.canvasPercentage)+"%";l.set(this.canvas,{width:b,height:b,display:"block",marginLeft:"auto",marginRight:"auto"})}}})})},"frozen/GameAction":function(){define(["dcl","dcl/bases/Mixer"],function(b,f){return b(f,{name:null,behavior:0,amount:0,state:0,statics:{NORMAL:0,DETECT_INITAL_PRESS_ONLY:1,STATE_RELEASED:0,STATE_PRESSED:1,STATE_WAITING_FOR_RELEASE:2,STATE_MOVED:3},constructor:function(){this.reset()},
reset:function(){this.state=this.statics.STATE_RELEASED;this.amount=0},tap:function(){this.press();this.release()},press:function(){this.state=this.statics.STATE_PRESSED;this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY&&this.pressAmt(1)},pressAmt:function(b){if(this.state!==this.statics.STATE_WAITING_FOR_RELEASE)this.amount+=b,this.state=this.statics.STATE_WAITING_FOR_RELEASE},release:function(){this.state=this.statics.STATE_RELEASED},isPressed:function(){return this.state===this.statics.STATE_PRESSED?
!0:!1},getAmount:function(){var b=this.amount;if(0!==b)if(this.state===this.statics.STATE_RELEASED)this.amount=0;else if(this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY)this.state=this.statics.STATE_WAITING_FOR_RELEASE,this.amount=0;return b}})})},"frozen/MouseAction":function(){define(["dcl","dcl/bases/Mixer","./GameAction"],function(b,f,g){return b([f,g],{startPosition:null,endPosition:null,position:null})})},"frozen/utils/insideCanvas":function(){define(function(){return function(b,f){return 0>
b.x||b.x>f.width||0>b.y||b.y>f.height?!1:!0}})},"dcl/mixins/Cleanup":function(){(function(b){"undefined"!=typeof define?define(["../dcl","./Destroyable"],b):"undefined"!=typeof module?module.exports=b(require("../dcl"),require("./Destroyable")):dclMixinsCleanup=b(dcl,dclMixinsDestroyable)})(function(b,f){return b(f,{declaredClass:"dcl/mixins/Cleanup",constructor:function(){this.__cleanupStack=[]},pushCleanup:function(b,d){var f=d?function(){d(b)}:function(){b.destroy()};this.__cleanupStack.push(f);
return f},popCleanup:function(b){if(b)return this.__cleanupStack.pop();this.__cleanupStack.pop()()},removeCleanup:function(b){for(var d=this.__cleanupStack.length-1;0<=d;--d)if(this.__cleanupStack[d]===b)return this.__cleanupStack.splice(d,1),!0},cleanup:function(){for(;this.__cleanupStack.length;)this.__cleanupStack.pop()()},destroy:function(){this.cleanup()}})})},"dcl/mixins/Destroyable":function(){(function(b){"undefined"!=typeof define?define(["../dcl"],b):"undefined"!=typeof module?module.exports=
b(require("../dcl")):dclMixinsDestroyable=b(dcl)})(function(b){var f=b(null,{declaredClass:"dcl/mixins/Destroyable"});b.chainBefore(f,"destroy");return f})},"dojo/dom-style":function(){define("dojo/dom-style",["./sniff","./dom"],function(b,f){function g(c,d,e){d=d.toLowerCase();if(b("ie")){if("auto"==e){if("height"==d)return c.offsetHeight;if("width"==d)return c.offsetWidth}if("fontweight"==d)switch(e){case 700:return"bold";default:return"normal"}}d in a||(a[d]=i.test(d));return a[d]?k(c,e):e}var d,
h={};d=b("webkit")?function(a){var b;if(1==a.nodeType){var c=a.ownerDocument.defaultView;b=c.getComputedStyle(a,null);if(!b&&a.style)a.style.display="",b=c.getComputedStyle(a,null)}return b||{}}:b("ie")&&(9>b("ie")||b("quirks"))?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){return 1==a.nodeType?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};h.getComputedStyle=d;var k;k=b("ie")?function(a,b){if(!b)return 0;if("medium"==b)return 4;if(b.slice&&"px"==b.slice(-2))return parseFloat(b);
var c=a.style,d=a.runtimeStyle,e=c.left,f=d.left;d.left=a.currentStyle.left;try{c.left=b,b=c.pixelLeft}catch(g){b=0}c.left=e;d.left=f;return b}:function(a,b){return parseFloat(b)||0};h.toPixelValue=k;var e=function(a,b){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(c){return b?{}:null}},j=9>b("ie")||10>b("ie")&&b("quirks")?function(a){try{return e(a).Opacity/100}catch(b){return 1}}:function(a){return d(a).opacity},l=9>b("ie")||10>b("ie")&&b("quirks")?function(a,b){var c=100*
b,d=1==b;a.style.zoom=d?"":1;if(e(a))e(a,1).Opacity=c;else{if(d)return b;a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+c+")"}e(a,1).Enabled=!d;if("tr"==a.tagName.toLowerCase())for(c=a.firstChild;c;c=c.nextSibling)"td"==c.tagName.toLowerCase()&&l(c,b);return b}:function(a,b){return a.style.opacity=b},a={left:!0,top:!0},i=/margin|padding|width|height|max|min|offset/,c=b("ie")?"styleFloat":"cssFloat",m={cssFloat:c,styleFloat:c,"float":c};h.get=function(a,b){var c=f.byId(a),d=arguments.length;
if(2==d&&"opacity"==b)return j(c);var b=m[b]||b,e=h.getComputedStyle(c);return 1==d?e:g(c,b,e[b]||c.style[b])};h.set=function(a,b,c){var d=f.byId(a),e=arguments.length,g="opacity"==b,b=m[b]||b;if(3==e)return g?l(d,c):d.style[b]=c;for(var i in b)h.set(a,i,b[i]);return h.getComputedStyle(d)};return h})},"dojo/dom-geometry":function(){define("dojo/dom-geometry",["./sniff","./_base/window","./dom","./dom-style"],function(b,f,g,d){function h(a,b,c,d,e,f){f=f||"px";a=a.style;if(!isNaN(b))a.left=b+f;if(!isNaN(c))a.top=
c+f;if(0<=d)a.width=d+f;if(0<=e)a.height=e+f}function k(a){return"button"==a.tagName.toLowerCase()||"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function e(a){return"border-box"==j.boxModel||"table"==a.tagName.toLowerCase()||k(a)}var j={boxModel:"content-box"};if(b("ie"))j.boxModel="BackCompat"==document.compatMode?"border-box":"content-box";j.getPadExtents=function(a,b){var a=g.byId(a),c=b||d.getComputedStyle(a),e=d.toPixelValue,f=e(a,c.paddingLeft),h=e(a,
c.paddingTop),j=e(a,c.paddingRight),c=e(a,c.paddingBottom);return{l:f,t:h,r:j,b:c,w:f+j,h:h+c}};j.getBorderExtents=function(a,b){var a=g.byId(a),c=d.toPixelValue,e=b||d.getComputedStyle(a),f="none"!=e.borderLeftStyle?c(a,e.borderLeftWidth):0,h="none"!=e.borderTopStyle?c(a,e.borderTopWidth):0,j="none"!=e.borderRightStyle?c(a,e.borderRightWidth):0,c="none"!=e.borderBottomStyle?c(a,e.borderBottomWidth):0;return{l:f,t:h,r:j,b:c,w:f+j,h:h+c}};j.getPadBorderExtents=function(a,b){var a=g.byId(a),c=b||d.getComputedStyle(a),
e=j.getPadExtents(a,c),c=j.getBorderExtents(a,c);return{l:e.l+c.l,t:e.t+c.t,r:e.r+c.r,b:e.b+c.b,w:e.w+c.w,h:e.h+c.h}};j.getMarginExtents=function(a,b){var a=g.byId(a),c=b||d.getComputedStyle(a),e=d.toPixelValue,f=e(a,c.marginLeft),h=e(a,c.marginTop),j=e(a,c.marginRight),c=e(a,c.marginBottom);return{l:f,t:h,r:j,b:c,w:f+j,h:h+c}};j.getMarginBox=function(a,e){var a=g.byId(a),c=e||d.getComputedStyle(a),f=j.getMarginExtents(a,c),h=a.offsetLeft-f.l,k=a.offsetTop-f.t,l=a.parentNode,o=d.toPixelValue;if(b("mozilla")){var s=
parseFloat(c.left),c=parseFloat(c.top);!isNaN(s)&&!isNaN(c)?(h=s,k=c):l&&l.style&&(l=d.getComputedStyle(l),"visible"!=l.overflow&&(h+="none"!=l.borderLeftStyle?o(a,l.borderLeftWidth):0,k+="none"!=l.borderTopStyle?o(a,l.borderTopWidth):0))}else if((b("opera")||8==b("ie")&&!b("quirks"))&&l)l=d.getComputedStyle(l),h-="none"!=l.borderLeftStyle?o(a,l.borderLeftWidth):0,k-="none"!=l.borderTopStyle?o(a,l.borderTopWidth):0;return{l:h,t:k,w:a.offsetWidth+f.w,h:a.offsetHeight+f.h}};j.getContentBox=function(a,
e){var a=g.byId(a),c=e||d.getComputedStyle(a),f=a.clientWidth,h=j.getPadExtents(a,c),k=j.getBorderExtents(a,c);f?(c=a.clientHeight,k.w=k.h=0):(f=a.offsetWidth,c=a.offsetHeight);b("opera")&&(h.l+=k.l,h.t+=k.t);return{l:h.l,t:h.t,w:f-h.w-k.w,h:c-h.h-k.h}};j.setContentSize=function(a,b,c){var a=g.byId(a),d=b.w,b=b.h;e(a)&&(c=j.getPadBorderExtents(a,c),0<=d&&(d+=c.w),0<=b&&(b+=c.h));h(a,NaN,NaN,d,b)};var l={l:0,t:0,w:0,h:0};j.setMarginBox=function(a,f,c){var a=g.byId(a),m=c||d.getComputedStyle(a),c=f.w,
n=f.h,p=e(a)?l:j.getPadBorderExtents(a,m),m=j.getMarginExtents(a,m);if(b("webkit")&&k(a)){var v=a.style;if(0<=c&&!v.width)v.width="4px";if(0<=n&&!v.height)v.height="4px"}0<=c&&(c=Math.max(c-p.w-m.w,0));0<=n&&(n=Math.max(n-p.h-m.h,0));h(a,f.l,f.t,c,n)};j.isBodyLtr=function(a){a=a||f.doc;return"ltr"==(f.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};j.docScroll=function(a){var a=a||f.doc,d=f.doc.parentWindow||f.doc.defaultView;return"pageXOffset"in d?{x:d.pageXOffset,y:d.pageYOffset}:(d=
b("quirks")?f.body(a):a.documentElement)&&{x:j.fixIeBiDiScrollLeft(d.scrollLeft||0,a),y:d.scrollTop||0}};if(b("ie"))j.getIeDocumentElementOffset=function(a){a=a||f.doc;a=a.documentElement;if(8>b("ie")){var d=a.getBoundingClientRect(),c=d.left,d=d.top;7>b("ie")&&(c+=a.clientLeft,d+=a.clientTop);return{x:0>c?0:c,y:0>d?0:d}}return{x:0,y:0}};j.fixIeBiDiScrollLeft=function(a,d){var d=d||f.doc,c=b("ie");if(c&&!j.isBodyLtr(d)){var e=b("quirks"),g=e?f.body(d):d.documentElement,h=f.global;6==c&&!e&&h.frameElement&&
g.scrollHeight>g.clientHeight&&(a+=g.clientLeft);return 8>c||e?a+g.clientWidth-g.scrollWidth:-a}return a};j.position=function(a,d){var a=g.byId(a),c=f.body(a.ownerDocument),e=a.getBoundingClientRect(),e={x:e.left,y:e.top,w:e.right-e.left,h:e.bottom-e.top};if(9>b("ie")){var h=j.getIeDocumentElementOffset(a.ownerDocument);e.x-=h.x+(b("quirks")?c.clientLeft+c.offsetLeft:0);e.y-=h.y+(b("quirks")?c.clientTop+c.offsetTop:0)}d&&(c=j.docScroll(a.ownerDocument),e.x+=c.x,e.y+=c.y);return e};j.getMarginSize=
function(a,b){var a=g.byId(a),c=j.getMarginExtents(a,b||d.getComputedStyle(a)),e=a.getBoundingClientRect();return{w:e.right-e.left+c.w,h:e.bottom-e.top+c.h}};j.normalizeEvent=function(a){if(!("layerX"in a))a.layerX=a.offsetX,a.layerY=a.offsetY};return j})},"dojo/domReady":function(){define(["./has"],function(){function b(a){k?a(g):e.push(a)}var f=this,g=document,d={loaded:1,complete:1},h="string"!=typeof g.readyState,k=!!d[g.readyState];if(h)g.readyState="loading";if(!k){var e=[],j=[],l=function(a){a=
a||f.event;if(!(k||"readystatechange"==a.type&&!d[g.readyState])){k=1;if(h)g.readyState="complete";for(;e.length;)e.shift()(g)}},a=function(a,b){a.addEventListener(b,l,!1);e.push(function(){a.removeEventListener(b,l,!1)})};a(g,"DOMContentLoaded");a(f,"load");"onreadystatechange"in g?a(g,"readystatechange"):h||j.push(function(){return d[g.readyState]});if(j.length){var i=function(){if(!k){for(var a=j.length;a--;)if(j[a]()){l("poller");return}setTimeout(i,30)}};i()}}b.load=function(a,d,e){b(e)};return b})},
"frozen/shims/RAF":function(){define(function(){for(var b=0,f=["ms","moz","webkit","o"],g=0;g<f.length&&!window.requestAnimationFrame;++g)window.requestAnimationFrame=window[f[g]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f[g]+"CancelAnimationFrame"]||window[f[g]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame)window.requestAnimationFrame=function(d){var f=(new Date).getTime(),g=Math.max(0,16-(f-b)),e=window.setTimeout(function(){d(f+g)},g);b=f+g;return e};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(b){clearTimeout(b)}})},"frozen/box2d/Box":function(){define(["dcl","dcl/bases/Mixer","dojo/_base/lang"],function(b,f){var g=Box2D.Common.Math.b2Vec2,d=Box2D.Dynamics.b2BodyDef,h=Box2D.Dynamics.b2Body,k=Box2D.Dynamics.b2FixtureDef,e=Box2D.Dynamics.b2World,j=Box2D.Collision.Shapes.b2PolygonShape,l=Box2D.Collision.Shapes.b2CircleShape;return b(f,{intervalRate:60,adaptive:!1,bodiesMap:null,fixturesMap:null,jointsMap:null,b2World:null,gravityX:0,gravityY:9.8,allowSleep:!0,resolveCollisions:!1,
contactListener:null,collisions:null,scale:30,constructor:function(a){if(a&&a.intervalRate)this.intervalRate=parseInt(a.intervalRate,10);this.bodiesMap={};this.fixturesMap={};this.jointsMap={};this.b2World=new e(new g(this.gravityX,this.gravityY),this.allowSleep);this.resolveCollisions&&this.addContactListener(this.contactListener||this)},update:function(a){if(this.resolveCollisions)this.collisions={};var b=Date.now();a?this.b2World.Step(a/1E3,10,10):this.b2World.Step(this.adaptive?(b-this.lastTimestamp)/
1E3:1/this.intervalRate,10,10);this.b2World.ClearForces();return Date.now()-b},getState:function(){for(var a={},b=this.b2World.GetBodyList();b;b=b.m_next)if(b.IsActive()&&"undefined"!==typeof b.GetUserData()&&null!==b.GetUserData()&&(a[b.GetUserData()]={x:b.GetPosition().x,y:b.GetPosition().y,angle:b.GetAngle(),center:{x:b.GetWorldCenter().x,y:b.GetWorldCenter().y},linearVelocity:b.m_linearVelocity,angularVelocity:b.m_angularVelocity},this.resolveCollisions))a[b.GetUserData()].collisions=this.collisions[b.GetUserData()]||
null;return a},updateExternalState:function(a){var b=this.getState(),c;for(c in b){var d=a[c];d&&!d.staticBody&&d.update(b[c])}},setBodies:function(a){for(var b in a)this.addBody(a[b]);this.ready=!0},addBody:function(a){if(!a.alreadyScaled)a.scaleShape(1/this.scale),a.scale=this.scale;var b=new d,c=new k,e,f,p,v;c.restitution=a.restitution;c.density=a.density;c.friction=a.friction;if(null!=a.maskBits)c.filter.maskBits=a.maskBits;if(null!=a.categoryBits)c.filter.categoryBits=a.categoryBits;if(null!=
a.groupIndex)c.filter.groupIndex=a.groupIndex;b.type=a.staticBody?h.b2_staticBody:h.b2_dynamicBody;b.position.x=a.x;b.position.y=a.y;b.userData=a.id;b.angle=a.angle;b.linearDamping=a.linearDamping;b.angularDamping=a.angularDamping;var o=this.b2World.CreateBody(b);if(a.radius)c.shape=new l(a.radius),o.CreateFixture(c);else if(a.points){f=[];for(b=0;b<a.points.length;b++)p=new g,p.Set(a.points[b].x,a.points[b].y),f[b]=p;c.shape=new j;c.shape.SetAsArray(f,f.length);o.CreateFixture(c)}else if(a.polys)for(e=
0;e<a.polys.length;e++){f=a.polys[e];v=[];for(b=0;b<f.length;b++)p=new g,p.Set(f[b].x,f[b].y),v[b]=p;c.shape=new j;c.shape.SetAsArray(v,v.length);o.CreateFixture(c)}else c.shape=new j,c.shape.SetAsBox(a.halfWidth,a.halfHeight),o.CreateFixture(c);this.bodiesMap[a.id]=o},setPosition:function(a,b,c){this.bodiesMap[a].SetPosition(new g(b,c))},setAngle:function(a,b){this.bodiesMap[a].SetAngle(b)},setLinearVelocity:function(a,b,c){this.bodiesMap[a].SetLinearVelocity(new g(b,c))},setAngularVelocity:function(a,
b){this.bodiesMap[a].SetAngularVelocity(b)},applyImpulseDegrees:function(a,b,c){a=this.bodiesMap[a];a.ApplyImpulse(new g(Math.sin(b*(Math.PI/180))*c,-1*Math.cos(b*(Math.PI/180))*c),a.GetWorldCenter())},applyForceDegrees:function(a,b,c){a=this.bodiesMap[a];a.ApplyForce(new g(Math.sin(b*(Math.PI/180))*c,-1*Math.cos(b*(Math.PI/180))*c),a.GetWorldCenter())},applyImpulse:function(a,b,c){a=this.bodiesMap[a];a.ApplyImpulse(new g(Math.sin(b)*c,-1*Math.cos(b)*c),a.GetWorldCenter())},applyForce:function(a,
b,c){a=this.bodiesMap[a];a.ApplyForce(new g(Math.sin(b)*c,-1*Math.cos(b)*c),a.GetWorldCenter())},applyTorque:function(a,b){this.bodiesMap[a].ApplyTorque(b)},setGravity:function(a){this.b2World.SetGravity(new g(a.x,a.y))},removeBody:function(a){this.bodiesMap[a]&&(this.fixturesMap[a]&&this.bodiesMap[a].DestroyFixture(this.fixturesMap[a]),this.b2World.DestroyBody(this.bodiesMap[a]),delete this.bodiesMap[a])},wakeUpBody:function(a){this.bodiesMap[a]&&this.bodiesMap[a].SetAwake(!0)},addContactListener:function(a){var b=
new Box2D.Dynamics.b2ContactListener;if(a.beginContact)b.BeginContact=function(b){a.beginContact(b.GetFixtureA().GetBody().GetUserData(),b.GetFixtureB().GetBody().GetUserData())};if(a.endContact)b.endContact=function(b){a.endContact(b.GetFixtureA().GetBody().GetUserData(),b.GetFixtureB().GetBody().GetUserData())};if(a.postSolve)b.PostSolve=function(b,d){a.postSolve(b.GetFixtureA().GetBody().GetUserData(),b.GetFixtureB().GetBody().GetUserData(),d.normalImpulses[0])};this.b2World.SetContactListener(b)},
destroyJoint:function(a){this.removeJoint(a)},removeJoint:function(a){this.jointsMap[a]&&(this.b2World.DestroyJoint(this.jointsMap[a]),delete this.jointsMap[a])},addJoint:function(a){if(a&&a.id&&!this.jointsMap[a.id]){if(!a.alreadyScaled&&a.scaleJointLocation)a.scaleJointLocation(1/this.scale),a.scale=this.scale;var b=a.createB2Joint(this);b&&(this.jointsMap[a.id]=b)}},beginContact:function(){},endContact:function(){},postSolve:function(a,b,c){this.collisions[a]=this.collisions[a]||[];this.collisions[a].push({id:b,
impulse:c});this.collisions[b]=this.collisions[b]||[];this.collisions[b].push({id:a,impulse:c})}})})}}});(function(){require({cache:{}});require.boot&&require.apply(null,require.boot)})();