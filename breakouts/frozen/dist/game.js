//>>built
/*

 Lo-Dash 1.3.1 (Custom Build) <http://lodash.com/>
 Build: `lodash modern -o ./dist/lodash.js`
 Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 Available under MIT license <http://lodash.com/license>
*/
(function(d,i){var g,a,h,l=function(){},j=function(a){for(var b in a)return 0;return 1},b={}.toString,c=function(a){return"[object Function]"==b.call(a)},o=function(a){return"[object String]"==b.call(a)},e=function(a){return"[object Array]"==b.call(a)},f=function(a,b){if(a)for(var c=0;c<a.length;)b(a[c++])},n=function(a,b){for(var c in b)a[c]=b[c];return a},p=function(a,b){return n(Error(a),{src:"dojoLoader",info:b})},r=1,u=function(){return"_"+r++},m=function(a,b,c){return fa(a,b,c,0,m)},q=this,
w=q.document,$=w&&w.createElement("DiV"),t=m.has=function(a){return c(s[a])?s[a]=s[a](q,w,$):s[a]},s=t.cache=i.hasCache;t.add=function(a,b,c,f){(void 0===s[a]||f)&&(s[a]=b);return c&&t(a)};for(var v in d.has)t.add(v,d.has[v],0,1);m.async=1;var E=new Function("return eval(arguments[0]);");m.eval=function(a,b){return E(a+"\r\n////@ sourceURL="+b)};var C={},x=m.signal=function(a,b){var c=C[a];f(c&&c.slice(0),function(a){a.apply(null,e(b)?b:[b])})},ua=m.on=function(a,b){var c=C[a]||(C[a]=[]);c.push(b);
return{remove:function(){for(var a=0;a<c.length;a++)if(c[a]===b){c.splice(a,1);break}}}},Na=[],Oa={},ga=[],va={},Pa=m.map={},aa=[],F={},Ga="",ha={},wa={};v={};var T=function(a){var b,c,f,e;for(b in wa)c=wa[b],(f=b.match(/^url\:(.+)/))?ha["url:"+yb(f[1],a)]=c:"*now"==b?e=c:"*noref"!=b&&(f=Qa(b,a),ha[f.mid]=ha["url:"+f.url]=c);e&&e(S(a));wa={}},oa=function(a){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){return"\\"+a})},ba=function(a,b){b.splice(0,b.length);for(var c in a)b.push([c,a[c],
RegExp("^"+oa(c)+"(/|$)"),c.length]);b.sort(function(a,b){return b[3]-a[3]});return b},ia=function(a){var b=a.name;b||(b=a,a={name:b});a=n({main:"main"},a);a.location=a.location?a.location:b;if(a.packageMap)Pa[b]=a.packageMap;if(!a.main.indexOf("./"))a.main=a.main.substring(2);va[b]=a},Ha=[],O=function(a,b,c){for(var e in a){if("waitSeconds"==e)m.waitms=1E3*(a[e]||0);"cacheBust"==e&&(Ga=a[e]?o(a[e])?a[e]:(new Date).getTime()+"":"");if("baseUrl"==e||"combo"==e)m[e]=a[e];a[e]!==s&&(m.rawConfig[e]=a[e],
"has"!=e&&t.add("config-"+e,a[e],0,b))}if(!m.baseUrl)m.baseUrl="./";/\/$/.test(m.baseUrl)||(m.baseUrl+="/");for(e in a.has)t.add(e,a.has[e],0,b);f(a.packages,ia);for(h in a.packagePaths)f(a.packagePaths[h],function(a){var b=h+"/"+a;o(a)&&(a={name:a});a.location=b;ia(a)});ba(n(Pa,a.map),aa);f(aa,function(a){a[1]=ba(a[1],[]);if("*"==a[0])aa.star=a});ba(n(Oa,a.paths),ga);f(a.aliases,function(a){o(a[0])&&(a[0]=RegExp("^"+oa(a[0])+"$"));Na.push(a)});if(b)Ha.push({config:a.config});else for(e in a.config)b=
U(e,c),b.config=n(b.config||{},a.config[e]);if(a.cache)T(),wa=a.cache,a.cache["*noref"]&&T();x("config",[a,m.rawConfig])};m.rawConfig={};O(i,1);O(d,1);O(v,1);var K=function(a){pa(function(){f(a.deps,Ia)})},fa=function(a,b,c,f,h){var d;if(o(a)){if((d=U(a,f,!0))&&d.executed)return d.result;throw p("undefinedModule",a);}e(a)||(O(a,0,f),a=b,b=c);if(e(a))if(a.length){for(var c="require*"+u(),j,g=[],i=0;i<a.length;)j=a[i++],g.push(U(j,f));d=n(k("",c,0,""),{injected:2,deps:g,def:b||l,require:f?f.require:
m,gc:1});F[d.mid]=d;K(d);var q=W&&0!="sync";pa(function(){xa(d,q)});d.executed||z.push(d);y()}else b&&b();return h},S=function(a){if(!a)return m;var b=a.require;if(!b)b=function(c,e,f){return fa(c,e,f,a,b)},a.require=n(b,m),b.module=a,b.toUrl=function(b){return yb(b,a)},b.toAbsMid=function(b){return lb(b,a)};return b},z=[],B=[],A={},ja=function(a){a.injected=1;A[a.mid]=1;a.url&&(A[a.url]=a.pack||1);Sa()},ka=function(a){a.injected=2;delete A[a.mid];a.url&&delete A[a.url];j(A)&&Ja()},X=m.idle=function(){return!B.length&&
j(A)&&!z.length&&!W},N=function(a,b){if(b)for(var c=0;c<b.length;c++)if(b[c][2].test(a))return b[c];return 0},zb=function(a){for(var b=[],c,e,a=a.replace(/\\/g,"/").split("/");a.length;)c=a.shift(),".."==c&&b.length&&".."!=e?(b.pop(),e=b[b.length-1]):"."!=c&&b.push(e=c);return b.join("/")},k=function(a,b,c,e){return{pid:a,mid:b,pack:c,url:e,executed:0,def:0}},Ab=function(a,b,e,d,h,j,l,i){var n,o,m,q;q=/^\./.test(a);if(/(^\/)|(\:)|(\.js$)/.test(a)||q&&!b)return k(0,a,0,a);a=zb(q?b.mid+"/../"+a:a);
if(/^\./.test(a))throw p("irrationalPath",a);b&&(m=N(b.mid,j));(m=(m=m||j.star)&&N(a,m[1]))&&(a=m[1]+a.substring(m[3]));b=(g=a.match(/^([^\/]+)(\/(.+))?$/))?g[1]:"";(n=e[b])?a=b+"/"+(o=g[3]||n.main):b="";var $=0;f(Na,function(b){var e=a.match(b[0]);e&&0<e.length&&($=c(b[1])?a.replace(b[0],b[1]):b[1])});if($)return Ab($,0,e,d,h,j,l,i);if(e=d[a])return i?k(e.pid,e.mid,e.pack,e.url):d[a];d=(m=N(a,l))?m[1]+a.substring(m[3]):b?n.location+"/"+o:a;/(^\/)|(\:)/.test(d)||(d=h+d);return k(b,a,n,zb(d+".js"))},
Qa=function(a,b){return Ab(a,b,va,F,m.baseUrl,aa,ga)},Bb=function(a,b,c){return a.normalize?a.normalize(b,function(a){return lb(a,c)}):lb(b,c)},Cb=0,U=function(a,b,c){var e,f;(e=a.match(/^(.+?)\!(.*)$/))?(f=U(e[1],b,c),5===f.executed&&!f.load&&da(f),f.load?(e=Bb(f,e[2],b),a=f.mid+"!"+(f.dynamic?++Cb+"!":"")+e):(e=e[2],a=f.mid+"!"+ ++Cb+"!waitingForPlugin"),a={plugin:f,mid:a,req:S(b),prid:e}):a=Qa(a,b);return F[a.mid]||!c&&(F[a.mid]=a)},lb=m.toAbsMid=function(a,b){return Qa(a,b).mid},yb=m.toUrl=function(a,
b){var c=Qa(a+"/x",b),e=c.url;return ya(0===c.pid?a:e.substring(0,e.length-5))},za={injected:2,executed:5,def:3,result:3},P=function(a){return F[a]=n({mid:a},za)},Ta=P("require"),la=P("exports"),Y=P("module"),G={},Aa=0,da=function(a){var b=a.result;a.dynamic=b.dynamic;a.normalize=b.normalize;a.load=b.load;return a},Ua=function(a){var b={};f(a.loadQ,function(c){var e=Bb(a,c.prid,c.req.module),f=a.dynamic?c.mid.replace(/waitingForPlugin$/,e):a.mid+"!"+e,e=n(n({},c),{mid:f,prid:e,injected:0});F[f]||
La(F[f]=e);b[c.mid]=F[f];ka(c);delete F[c.mid]});a.loadQ=0;var c=function(a){for(var c=a.deps||[],e=0;e<c.length;e++)(a=b[c[e].mid])&&(c[e]=a)},e;for(e in F)c(F[e]);f(z,c)},qa=function(b){m.trace("loader-finish-exec",[b.mid]);b.executed=5;b.defOrder=Aa++;b.loadQ&&(da(b),Ua(b));for(a=0;a<z.length;)z[a]===b?z.splice(a,1):a++;/^require\*/.test(b.mid)&&delete F[b.mid]},Va=[],xa=function(a,b){if(4===a.executed)return m.trace("loader-circular-dependency",[Va.concat(a.mid).join("->")]),!a.def||b?G:a.cjs&&
a.cjs.exports;if(!a.executed){if(!a.def)return G;var e=a.mid,f=a.deps||[],d,h=[],k=0;for(a.executed=4;k<f.length;){d=f[k++];d=d===Ta?S(a):d===la?a.cjs.exports:d===Y?a.cjs:xa(d,b);if(d===G)return a.executed=0,m.trace("loader-exec-module",["abort",e]),G;h.push(d)}m.trace("loader-run-factory",[a.mid]);e=a.def;h=c(e)?e.apply(null,h):e;a.result=void 0===h&&a.cjs?a.cjs.exports:h;qa(a)}return a.result},W=0,pa=function(a){try{W++,a()}finally{W--}X()&&x("idle",[])},y=function(){W||pa(function(){for(var a,
b,c=0;c<z.length;)a=Aa,b=z[c],xa(b),a!=Aa?c=0:c++})};void 0===t("dojo-loader-eval-hint-url")&&t.add("dojo-loader-eval-hint-url",1);var ya=function(a){a+="";return a+(Ga?(/\?/.test(a)?"&":"?")+Ga:"")},La=function(a){var b=a.plugin;5===b.executed&&!b.load&&da(b);var c=function(b){a.result=b;ka(a);qa(a);y()};b.load?b.load(a.prid,a.req,c):b.loadQ?b.loadQ.push(a):(b.loadQ=[a],z.unshift(b),Ia(b))},ma=0,ra=0,Ba=0,Wa=function(a,b){t("config-stripStrict")&&(a=a.replace(/"use strict"/g,""));Ba=1;a===ma?ma.call(null):
m.eval(a,t("dojo-loader-eval-hint-url")?b.url:b.mid);Ba=0},Ia=function(a){var b=a.mid,c=a.url;if(!a.executed&&!a.injected&&!(A[b]||a.url&&(a.pack&&A[a.url]===a.pack||1==A[a.url])))if(ja(a),a.plugin)La(a);else{var e=function(){Xa(a);2!==a.injected&&(ka(a),n(a,za),m.trace("loader-define-nonmodule",[a.url]));y()};(ma=ha[b]||ha["url:"+a.url])?(m.trace("loader-inject",["cache",a.mid,c]),Wa(ma,a),e()):(m.trace("loader-inject",["script",a.mid,c]),ra=a,m.injectUrl(ya(c),e,a),ra=0)}},sa=function(a,b,e){m.trace("loader-define-module",
[a.mid,b]);if(2===a.injected)return x("error",p("multipleDefine",a)),a;n(a,{deps:b,def:e,cjs:{id:a.mid,uri:a.url,exports:a.result={},setExports:function(b){a.cjs.exports=b},config:function(){return a.config}}});for(var f=0;f<b.length;f++)b[f]=U(b[f],a);ka(a);if(!c(e)&&!b.length)a.result=e,qa(a);return a},Xa=function(a,b){for(var c=[],e,d;B.length;)d=B.shift(),b&&(d[0]=b.shift()),e=d[0]&&U(d[0])||a,c.push([e,d[1],d[2]]);T(a);f(c,function(a){K(sa.apply(null,a))})},Ja=l,Sa=l;t.add("ie-event-behavior",
!!w.attachEvent&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var Ca=function(a,b,c,e){if(t("ie-event-behavior"))return a.attachEvent(c,e),function(){a.detachEvent(c,e)};a.addEventListener(b,e,!1);return function(){a.removeEventListener(b,e,!1)}},Ya=Ca(window,"load","onload",function(){m.pageLoaded=1;"complete"!=w.readyState&&(w.readyState="complete");Ya()}),Da=w.getElementsByTagName("script")[0],Za=Da.parentNode;m.injectUrl=function(a,b,c){var c=c.node=w.createElement("script"),
e=Ca(c,"load","onreadystatechange",function(a){var a=a||window.event,c=a.target||a.srcElement;if("load"===a.type||/complete|loaded/.test(c.readyState))e(),f(),b&&b()}),f=Ca(c,"error","onerror",function(b){e();f();x("error",p("scriptError",[a,b]))});c.type="text/javascript";c.charset="utf-8";c.src=a;Za.insertBefore(c,Da);return c};m.log=l;m.trace=l;P=function(a,b,e){var f=arguments.length,d=["require","exports","module"],h=[0,a,b];1==f?h=[0,c(a)?d:[],a]:2==f&&o(a)?h=[a,c(b)?d:[],b]:3==f&&(h=[a,b,e]);
m.trace("loader-define",h.slice(0,2));if((f=h[0]&&U(h[0]))&&!A[f.mid])K(sa(f,h[1],h[2]));else if(!t("ie-event-behavior")||Ba)B.push(h);else{f=f||ra;if(!f)for(a in A)if((d=F[a])&&d.node&&"interactive"===d.node.readyState){f=d;break}f?(T(f),K(sa(f,h[1],h[2]))):x("error",p("ieDefineFailed",h[0]));y()}};P.amd={vendor:"dojotoolkit.org"};n(n(m,i.loaderPatch),d.loaderPatch);ua("error",function(a){try{if(console.error(a),a instanceof Error)for(var b in a);}catch(c){}});n(m,{uid:u,cache:ha,packs:va});if(!q.define)q.define=
P,q.require=m,f(Ha,function(a){O(a)}),ua=v.deps||d.deps||i.deps,v=v.callback||d.callback||i.callback,m.boot=ua||v?[ua||[],v]:0})(this.dojoConfig||this.djConfig||this.require||{},{async:1,baseUrl:"./",hasCache:{"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-loader":1,dom:1,"host-browser":1},packages:[{location:"../Breakouts",name:"Breakouts"},{location:".",name:"dojo"},{location:"../dcl",main:"dcl",name:"dcl"},{location:"../lodash",main:"lodash",name:"lodash"},{location:"../hammer",
main:"hammer",name:"hammer"},{location:"../frozen",main:"GameCore",name:"frozen"},{location:"../game",main:"game",name:"game"},{location:"../sounds",name:"sounds"}]});
require({cache:{"dist/game":function(){define([],1)},"game/game":function(){define("./initInput,./handleInput,./update,./draw,./walls,./Paddle,./PaddleJoint,./Ball,./loadLevel,lodash,dojo/has,frozen/box2d/BoxGame,frozen/box2d/Box,frozen/box2d/entities/Rectangle".split(","),function(d,i,g,a,h,l,j,b,c,o,e,f,n,p){var r=new f({height:416,width:320,box:new n({resolveCollisions:!0,gravityY:0}),boxUpdating:!1,canvasId:"canvas",gameAreaId:e("touch")?"gameArea":null,canvasPercentage:e("touch")?0.98:null,mobile:e("touch")?
!0:!1,handleInput:i,update:g,draw:a,loadLevel:c,state:{screen:0,lives:3,currentLevel:0,score:0,balls:[],powerUps:[],powerDowns:[],currentBricks:[],launchMillis:0,prevLaunchMillis:3001},initInput:d,newBall:function(){var a=new b;this.state.balls.push(a);this.addBody(a);this.box.applyImpulseDegrees(a.id,155,0.75*a.impulse)}});o.forEach(h.entities,function(a){r.addBody(new p(a))});r.addBody(new l);r.addJoint(new j);r.run()})},"game/initInput":function(){define(["dojo/keys"],function(d){return function(i){i.addKeyAction(d.LEFT_ARROW,
!0);i.addKeyAction(d.RIGHT_ARROW,!0);i.on("mousemove",i.mousemove)}})},"dojo/keys":function(){define(["./_base/kernel","./sniff"],function(d,i){return d.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:i("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,
NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:i("mac")&&!i("air")?i("safari")?91:224:17}})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(d,
i,g,a){var h,d={},l={},j={config:i,global:this,dijit:d,dojox:l},d={dojo:["dojo",j],dijit:["dijit",d],dojox:["dojox",l]},a=g.map&&g.map[a.id.match(/[^\/]+/)[0]];for(h in a)d[h]?d[h][0]=a[h]:d[h]=[a[h],{}];for(h in d)a=d[h],a[1]._scopeName=a[0],i.noGlobals||(this[a[0]]=a[1]);j.scopeMap=d;j.baseUrl=j.config.baseUrl=g.baseUrl;j.isAsync=g.async;j.locale=i.locale;i="$Rev$".match(/\d+/);j.version={major:1,minor:8,patch:3,flag:"",revision:i?+i[0]:NaN,toString:function(){var a=j.version;return a.major+"."+
a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};Function("d","d.eval = function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(j);j.exit=function(){};j.deprecated=j.experimental=function(){};j._hasResource={};return j})},"dojo/has":function(){define(["require","module"],function(d){var i=d.has||function(){};i.add("touch","ontouchstart"in document);i.add("device-width",screen.availWidth||innerWidth);d=document.createElement("form");i.add("dom-attributes-explicit",0==
d.attributes.length);i.add("dom-attributes-specified-flag",0<d.attributes.length&&40>d.attributes.length);i.clearElement=function(d){d.innerHTML="";return d};i.normalize=function(d,a){var h=d.match(/[\?:]|[^:\?]*/g),l=0,j=function(a){var c=h[l++];if(":"==c)return 0;if("?"==h[l++]){if(!a&&i(c))return j();j(!0);return j(a)}return c||0};return(d=j())&&a(d)};i.load=function(d,a,h){d?a([d],h):h()};return i})},"dojo/_base/config":function(){define(["../has","require"],function(d,i){var g={},a=i.rawConfig,
h;for(h in a)g[h]=a[h];return g})},"dojo/sniff":function(){define(["./has"],function(d){var i=navigator,g=i.userAgent,i=i.appVersion,a=parseFloat(i);d.add("air",0<=g.indexOf("AdobeAIR"));d.add("khtml",0<=i.indexOf("Konqueror")?a:void 0);d.add("webkit",parseFloat(g.split("WebKit/")[1])||void 0);d.add("chrome",parseFloat(g.split("Chrome/")[1])||void 0);d.add("safari",0<=i.indexOf("Safari")&&!d("chrome")?parseFloat(i.split("Version/")[1]):void 0);d.add("mac",0<=i.indexOf("Macintosh"));d.add("quirks",
"BackCompat"==document.compatMode);d.add("ios",/iPhone|iPod|iPad/.test(g));d.add("android",parseFloat(g.split("Android ")[1])||void 0);if(!d("webkit")){0<=g.indexOf("Opera")&&d.add("opera",9.8<=a?parseFloat(g.split("Version/")[1])||a:a);0<=g.indexOf("Gecko")&&!d("khtml")&&!d("webkit")&&d.add("mozilla",a);d("mozilla")&&d.add("ff",parseFloat(g.split("Firefox/")[1]||g.split("Minefield/")[1])||void 0);if(document.all&&!d("opera"))g=parseFloat(i.split("MSIE ")[1])||void 0,(i=document.documentMode)&&5!=
i&&Math.floor(g)!=i&&(g=i),d.add("ie",g);d.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return d})},"game/handleInput":function(){define(["./levels","dojo/keys"],function(d,i){return function(g){if(0===this.state.screen&&g.mouseAction.isPressed())this.state.screen=1,this.loadLevel(0);var a=g.mouseAction.position;if(a){var h=this.entities.paddle;if(1===this.state.screen&&h)a=a.x/this.box.scale,a<h.halfWidth?a=h.halfWidth:a>this.width/this.box.scale-h.halfWidth&&(a=this.width/this.box.scale-
h.halfWidth),0>=this.state.launchMillis?this.box.setPosition(h.id,a,h.y):h.x=a}g.keyActions[i.LEFT_ARROW].getAmount()&&0<this.state.currentLevel?(this.state.currentLevel--,this.loadLevel(this.state.currentLevel)):g.keyActions[i.RIGHT_ARROW].getAmount()&&this.state.currentLevel<d.length-1&&(this.state.currentLevel++,this.loadLevel(this.state.currentLevel))}})},"game/levels":function(){define(function(){return[{name:"letsa begin",bricks:[[null,null,3,1,3,null,null],[1,0,3,3,3,0,1],[null,0,0,0,0,0,null]],
powerUps:1,powerDowns:1},{name:"how's it going?",bricks:[[null,3,1,3,1,3,null],[null,0,0,0,0,0,null],[3,0,2,0,2,0,3],[3,0,0,0,0,0,3],[3,0,null,null,null,0,3],[null,0,0,0,0,0,null]],powerUps:1,powerDowns:1},{name:"tie fighta!",bricks:[[null,0,null,3,null,0,null],[0,null,0,1,0,null,0],[0,3,0,1,0,3,0],[0,null,0,1,0,null,0],[null,0,null,null,null,0,null],[2,null,2,null,2,null,2]],powerUps:2,powerDowns:2},{name:"swirl",bricks:[[2,3,1,0,2,3,1],[0,null,null,null,null,null,null],[1,null,1,0,2,3,1],[3,null,
3,null,null,null,0],[2,null,2,null,2,null,2],[0,null,0,1,3,null,3],[1,null,null,null,null,null,1],[3,2,0,1,3,2,0]],powerUps:2,powerDowns:3}]})},"game/update":function(){define("./Ball,./Paddle,./PaddleJoint,./levels,./PowerUp,./PowerDown,lodash,frozen/plugins/loadSound!sounds/brickDeath,frozen/plugins/loadSound!sounds/countdownBlip,frozen/plugins/loadSound!sounds/powerup,frozen/plugins/loadSound!sounds/powerdown,frozen/plugins/loadSound!sounds/recover".split(","),function(d,i,g,a,h,l,j,b,c,o,e,f){return function(n){if(1===
this.state.screen){var p=this.entities.paddle,r,u,m=!1;j.forEach(this.state.currentBricks,function(a){a.dead||(a.updateAnimation(n),m=!0)});if(!m)this.state.currentLevel++,this.state.currentLevel<a.length?this.loadLevel(this.state.currentLevel):this.state.screen=3;if(0<this.state.launchMillis)this.prevLaunchMillis=this.state.launchMillis,this.state.launchMillis-=n,0<=this.state.launchMillis&&Math.floor(this.prevLaunchMillis/1E3)!==Math.floor(this.state.launchMillis/1E3)&&c.play(),this.boxUpdating=
0>=this.state.launchMillis?!0:!1;else if(this.boxUpdating=!0,this.state.balls=j.filter(this.state.balls,function(a){if(a.y<this.height/this.box.scale)return a.updateAnimation(n),!0;this.removeBody(a);return!1},this),p&&p.collisions&&(j.forEach(p.collisions,function(a){a=this.entities[a.id];if(a.ball&&a.y<p.y){var b=45*((a.x-p.x)/(p.halfWidth+a.radius));this.removeBody(a);this.addBody(a);this.box.applyImpulseDegrees(a.id,b,a.impulse)}else if(a.powerUp)this.removeBody(a),this.state.powerUps=j.reject(this.state.powerUps,
{id:a.id}),this.newBall(),o.play();else if(a.powerDown)this.removeBody(a),this.state.powerDowns=j.reject(this.state.powerDowns,{id:a.id}),0<p.smallMillis?p.smallMillis=p.smallMillisStart:(u=new i({x:p.x*p.scale,y:p.y*p.scale,halfWidth:p.smallHalfWidth,smallMillis:p.smallMillisStart}),this.removeJoint(this.joints.pJoint),this.removeBody(p),this.addBody(u),this.addJoint(new g)),e.play()},this),this.box.setLinearVelocity(p.id,0)),p&&0<p.smallMillis&&(p.smallMillis-=n,0>=p.smallMillis&&(u=new i({x:p.x*
p.scale,y:p.y*p.scale,halfWidth:p.bigHalfWidth}),this.removeJoint(this.joints.pJoint),this.removeBody(p),this.addBody(u),this.addJoint(new g),f.play())),j.forEach(this.state.balls,function(a,c){a.collisions&&j.forEach(a.collisions,function(a){if((a=this.entities[a.id])&&a.brick)a.dying=!0,this.removeBody(a),b.play(0.5),a.powerUpBrick?(a=new h({x:a.x*a.scale,y:a.y*a.scale}),this.addBody(a),this.box.applyImpulseDegrees(a.id,180,a.impulse),this.state.powerUps.push(a)):a.powerDownBrick&&(a=new l({x:a.x*
a.scale,y:a.y*a.scale}),this.addBody(a),this.box.applyImpulseDegrees(a.id,180,a.impulse),this.state.powerDowns.push(a)),this.state.score+=100},this);if(a.linearVelocity&&3>Math.abs(a.linearVelocity.y)){if(a.slowY++,1<a.slowY&&300<a.aliveTime)this.box.removeBody(a.id),r=new d({x:a.x*a.scale,y:a.y*a.scale,id:a.id}),this.state.balls[c]=r,this.addBody(r),this.box.applyImpulseDegrees(a.id,0<a.linearVelocity.y?0<a.linearVelocity.x?45:315:0<a.linearVelocity.x?135:225,a.impulse),r.slowY=0}else a.slowY=0},
this),0===this.state.balls.length)this.state.lives--,0<this.state.lives?(this.newBall(),this.state.launchMillis=3001):this.state.screen=2}}})},"game/Ball":function(){define(["lodash","dcl","frozen/box2d/entities/Circle","frozen/Animation","frozen/plugins/loadImage!resources/tiles.png"],function(d,i,g,a,h){return i(g,{x:60,y:210,ball:!0,radius:8,img:h,anim:null,restitution:1,friction:0,impulse:2.5,slowY:0,aliveTime:0,groupIndex:-1,constructor:function(){if(!this.id)this.id=d.uniqueId();this.anim=a.prototype.createFromSheet(5,
200,this.img,16,16);this.anim.offsetX=48;this.anim.offsetY=64},updateAnimation:function(a){this.anim.update(a);this.aliveTime+=a},draw:function(a){this.anim.draw(a,Math.floor((this.x-this.radius)*this.scale),Math.floor((this.y-this.radius)*this.scale))}})})},"lodash/lodash":function(){(function(d){function i(a,b,c){for(var c=(c||0)-1,e=a.length;++c<e;)if(a[c]===b)return c;return-1}function g(a,b){var c=typeof b,a=a.cache;if("boolean"==c||null==b)return a[b];"number"!=c&&"string"!=c&&(c="object");
var e="number"==c?b:$+b,a=a[c]||(a[c]={});return"object"==c?a[e]&&-1<i(a[e],b)?0:-1:a[e]?0:-1}function a(a){var b=this.cache,c=typeof a;if("boolean"==c||null==a)b[a]=!0;else{"number"!=c&&"string"!=c&&(c="object");var e="number"==c?a:$+a,f=b[c]||(b[c]={});if("object"==c){if((f[e]||(f[e]=[])).push(a)==this.array.length)b[c]=!1}else f[e]=!0}}function h(a){return a.charCodeAt(0)}function l(a,b){var c=a.index,e=b.index,a=a.criteria,b=b.criteria;if(a!==b){if(a>b||"undefined"==typeof a)return 1;if(a<b||
"undefined"==typeof b)return-1}return c<e?-1:1}function j(b){var c=-1,e=b.length,d=o();d["false"]=d["null"]=d["true"]=d.undefined=!1;var h=o();h.array=b;h.cache=d;for(h.push=a;++c<e;)h.push(b[c]);return!1===d.object?(f(h),null):h}function b(a){return"\\"+A[a]}function c(){return u.pop()||[]}function o(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,leading:!1,maxWait:0,"null":!1,number:null,object:null,push:null,string:null,trailing:!1,"true":!1,undefined:!1,value:null}}
function e(a){a.length=0;u.length<s&&u.push(a)}function f(a){var b=a.cache;b&&f(b);a.array=a.cache=a.criteria=a.object=a.number=a.string=a.value=null;m.length<s&&m.push(a)}function n(a,b,c){b||(b=0);"undefined"==typeof c&&(c=a?a.length:0);for(var e=-1,c=c-b||0,f=Array(0>c?0:c);++e<c;)f[e]=a[b+e];return f}function p(a){function k(a){return a&&"object"==typeof a&&!Q(a)&&I.call(a,"__wrapped__")?a:new m(a)}function m(a){this.__wrapped__=a}function u(a,b,c,e){function f(){var e=arguments,ab=h?this:b;d||
(a=b[j]);c.length&&(e=e.length?(e=H.call(e),g?e.concat(c):c.concat(e)):c);return this instanceof f?(ab=G(a.prototype)?bb(a.prototype):{},e=a.apply(ab,e),G(e)?e:ab):a.apply(ab,e)}var d=Y(a),h=!c,j=b;if(h)var g=e,c=b;else if(!d){if(!e)throw new Ib;b=a}return f}function s(a){return Db[a]}function A(){var a=(a=k.indexOf)===Xa?i:a;return a}function U(a){return function(b,c,e,f){"boolean"!=typeof c&&null!=c&&(f=e,e=!(f&&f[c]===b)?c:r,c=!1);null!=e&&(e=k.createCallback(e,f));return a(b,c,e,f)}}function X(a){var b,
c;if(!(a&&M.call(a)==K)||(b=a.constructor,Y(b)&&!(b instanceof b)))return!1;ta(a,function(a,b){c=b});return c===r||I.call(a,c)}function ja(a){return Jb[a]}function za(a,b,f,d,h,j){var g=a;"boolean"!=typeof b&&null!=b&&(d=f,f=b,b=!1);if("function"==typeof f){f="undefined"==typeof d?f:k.createCallback(f,d,1);g=f(g);if("undefined"!=typeof g)return g;g=a}if(d=G(g)){var l=M.call(g);if(!z[l])return g;var i=Q(g)}if(!d||!b)return d?i?n(g):ob({},g):g;d=ea[l];switch(l){case ba:case ia:return new d(+g);case O:case S:return new d(g);
case fa:return d(g.source,Na.exec(g))}l=!h;h||(h=c());j||(j=c());for(var m=h.length;m--;)if(h[m]==a)return j[m];g=i?d(g.length):{};if(i){if(I.call(a,"index"))g.index=a.index;if(I.call(a,"input"))g.input=a.input}h.push(a);j.push(g);(i?y:D)(a,function(a,c){g[c]=za(a,b,f,r,h,j)});l&&(e(h),e(j));return g}function P(a){var b=[];ta(a,function(a,c){Y(a)&&b.push(c)});return b.sort()}function Ta(a){for(var b=-1,c=R(a),e=c.length,f={};++b<e;){var d=c[b];f[a[d]]=d}return f}function la(a,b,f,d,h,j){var g=f===
w;if("function"==typeof f&&!g){var f=k.createCallback(f,d,2),l=f(a,b);if("undefined"!=typeof l)return!!l}if(a===b)return 0!==a||1/a==1/b;var i=typeof a,n=typeof b;if(a===a&&(!a||"function"!=i&&"object"!=i)&&(!b||"function"!=n&&"object"!=n))return!1;if(null==a||null==b)return a===b;n=M.call(a);i=M.call(b);n==T&&(n=K);i==T&&(i=K);if(n!=i)return!1;switch(n){case ba:case ia:return+a==+b;case O:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case fa:case S:return a==ca(b)}i=n==oa;if(!i){if(I.call(a,"__wrapped__ ")||
I.call(b,"__wrapped__"))return la(a.__wrapped__||a,b.__wrapped__||b,f,d,h,j);if(n!=K)return!1;var n=a.constructor,m=b.constructor;if(n!=m&&(!Y(n)||!(n instanceof n&&Y(m)&&m instanceof m)))return!1}m=!h;h||(h=c());j||(j=c());for(n=h.length;n--;)if(h[n]==a)return j[n]==b;var p=0,l=!0;h.push(a);j.push(b);if(i){n=a.length;p=b.length;l=p==a.length;if(!l&&!g)return l;for(;p--;)if(i=n,m=b[p],g)for(;i--&&!(l=la(a[i],m,f,d,h,j)););else if(!(l=la(a[p],m,f,d,h,j)))break;return l}ta(b,function(b,c,e){if(I.call(e,
c))return p++,l=I.call(a,c)&&la(a[c],b,f,d,h,j)});l&&!g&&ta(a,function(a,b,c){if(I.call(c,b))return l=-1<--p});m&&(e(h),e(j));return l}function Y(a){return"function"==typeof a}function G(a){return!(!a||!B[typeof a])}function Aa(a){return"number"==typeof a||M.call(a)==O}function da(a){return"string"==typeof a||M.call(a)==S}function Ua(a,b,f){var d=arguments,h=0,j=2;if(!G(a))return a;if(f===w)var g=d[3],l=d[4],i=d[5];else{var n=!0,l=c(),i=c();if("number"!=typeof f)j=d.length;3<j&&"function"==typeof d[j-
2]?g=k.createCallback(d[--j-1],d[j--],2):2<j&&"function"==typeof d[j-1]&&(g=d[--j])}for(;++h<j;)(Q(d[h])?y:D)(d[h],function(b,c){var e,$a,f=b,d=a[c];if(b&&(($a=Q(b))||pb(b))){for(f=l.length;f--;)if(e=l[f]==b){d=i[f];break}if(!e){var nb;if(g&&(f=g(d,b),nb="undefined"!=typeof f))d=f;nb||(d=$a?Q(d)?d:[]:pb(d)?d:{});l.push(b);i.push(d);nb||(d=Ua(d,b,w,g,l,i))}}else g&&(f=g(d,b),"undefined"==typeof f&&(f=b)),"undefined"!=typeof f&&(d=f);a[c]=d});n&&(e(l),e(i));return a}function qa(a){for(var b=-1,c=R(a),
e=c.length,f=J(e);++b<e;)f[b]=a[c[b]];return f}function Va(a,b,c){var e=-1,f=A(),d=a?a.length:0,h=!1,c=(0>c?Z(0,d+c):c)||0;d&&"number"==typeof d?h=-1<(da(a)?a.indexOf(b,c):f(a,b,c)):D(a,function(a){if(++e>=c)return!(h=a===b)});return h}function xa(a,b,c){var e=!0,b=k.createCallback(b,c),c=-1,f=a?a.length:0;if("number"==typeof f)for(;++c<f&&(e=!!b(a[c],c,a)););else D(a,function(a,c,f){return e=!!b(a,c,f)});return e}function W(a,b,c){var e=[],b=k.createCallback(b,c),c=-1,f=a?a.length:0;if("number"==
typeof f)for(;++c<f;){var d=a[c];b(d,c,a)&&e.push(d)}else D(a,function(a,c,f){b(a,c,f)&&e.push(a)});return e}function pa(a,b,c){var b=k.createCallback(b,c),c=-1,e=a?a.length:0;if("number"==typeof e)for(;++c<e;){var f=a[c];if(b(f,c,a))return f}else{var d;D(a,function(a,c,e){if(b(a,c,e))return d=a,!1});return d}}function y(a,b,c){var e=-1,f=a?a.length:0,b=b&&"undefined"==typeof c?b:k.createCallback(b,c);if("number"==typeof f)for(;++e<f&&!(!1===b(a[e],e,a)););else D(a,b);return a}function ya(a,b,c){var e=
-1,f=a?a.length:0,b=k.createCallback(b,c);if("number"==typeof f)for(var d=J(f);++e<f;)d[e]=b(a[e],e,a);else d=[],D(a,function(a,c,f){d[++e]=b(a,c,f)});return d}function La(a,b,c){var e=-Infinity,f=e;if(!b&&Q(a))for(var c=-1,d=a.length;++c<d;){var j=a[c];j>f&&(f=j)}else b=!b&&da(a)?h:k.createCallback(b,c),y(a,function(a,c,d){c=b(a,c,d);c>e&&(e=c,f=a)});return f}function ma(a,b){var c=-1,e=a?a.length:0;if("number"==typeof e)for(var f=J(e);++c<e;)f[c]=a[c][b];return f||ya(a,b)}function ra(a,b,c,e){if(!a)return c;
var f=3>arguments.length,b=k.createCallback(b,e,4),d=-1,h=a.length;if("number"==typeof h)for(f&&(c=a[++d]);++d<h;)c=b(c,a[d],d,a);else D(a,function(a,e,d){c=f?(f=!1,a):b(c,a,e,d)});return c}function Ba(a,b,c,e){var f=a?a.length:0,d=3>arguments.length;if("number"!=typeof f)var h=R(a),f=h.length;b=k.createCallback(b,e,4);y(a,function(e,j,g){j=h?h[--f]:--f;c=d?(d=!1,a[j]):b(c,a[j],j,g)});return c}function Wa(a,b,c){var e,b=k.createCallback(b,c),c=-1,f=a?a.length:0;if("number"==typeof f)for(;++c<f&&!(e=
b(a[c],c,a)););else D(a,function(a,c,f){return!(e=b(a,c,f))});return!!e}function Ia(a){var b=-1,c=A(),e=a?a.length:0,d=Ea.apply(L,H.call(arguments,1)),h=[],l=e>=t&&c===i;if(l){var n=j(d);n?(c=g,d=n):l=!1}for(;++b<e;)n=a[b],0>c(d,n)&&h.push(n);l&&f(d);return h}function sa(a,b,c){if(a){var e=0,f=a.length;if("number"!=typeof b&&null!=b)for(var d=-1,b=k.createCallback(b,c);++d<f&&b(a[d],d,a);)e++;else if(e=b,null==e||c)return a[0];return n(a,0,cb(Z(0,e),f))}}function Xa(a,b,c){if("number"==typeof c)var e=
a?a.length:0,c=0>c?Z(0,e+c):c||0;else if(c)return c=Sa(a,b),a[c]===b?c:-1;return a?i(a,b,c):-1}function Ja(a,b,c){if("number"!=typeof b&&null!=b)for(var e=0,f=-1,d=a?a.length:0,b=k.createCallback(b,c);++f<d&&b(a[f],f,a);)e++;else e=null==b||c?1:Z(0,b);return n(a,e)}function Sa(a,b,c,e){for(var f=0,d=a?a.length:f,c=c?k.createCallback(c,e,1):ib,b=c(b);f<d;)e=f+d>>>1,c(a[e])<b?f=e+1:d=e;return f}function Ca(a){for(var b=-1,c=a?La(ma(a,"length")):0,e=J(0>c?0:c);++b<c;)e[b]=ma(a,b);return e}function Ya(a,
b){for(var c=-1,e=a?a.length:0,f={};++c<e;){var d=a[c];b?f[d]=b[c]:f[d[0]]=d[1]}return f}function Da(a,b){return Eb.fastBind||na&&2<arguments.length?na.call.apply(na,arguments):u(a,b,H.call(arguments,2))}function Za(a,b,c){function e(){db(k);db(m);l=0;k=m=null}function f(){var b=p&&(!o||1<l);e();b&&(!1!==i&&(n=new Ra),j=a.apply(g,h))}function d(){e();if(p||i!==b)n=new Ra,j=a.apply(g,h)}var h,j,g,l=0,n=0,i=!1,k=null,m=null,p=!0,b=Z(0,b||0);if(!0===c)var o=!0,p=!1;else if(G(c))o=c.leading,i="maxWait"in
c&&Z(b,c.maxWait||0),p="trailing"in c?c.trailing:p;return function(){h=arguments;g=this;l++;db(m);if(!1===i)o&&2>l&&(j=a.apply(g,h));else{var c=new Ra;!k&&!o&&(n=c);var e=i-(c-n);0>=e?(db(k),k=null,n=c,j=a.apply(g,h)):k||(k=eb(d,e))}b!==i&&(m=eb(f,b));return j}}function vb(a){var b=H.call(arguments,1);return eb(function(){a.apply(r,b)},1)}function ib(a){return a}function wb(a){y(P(a),function(b){var c=k[b]=a[b];k.prototype[b]=function(){var a=this.__wrapped__,b=[a];fb.apply(b,arguments);b=c.apply(k,
b);return a&&"object"==typeof a&&a===b?this:new m(b)}})}function xb(){return this.__wrapped__}var a=a?N.defaults(d.Object(),a,N.pick(d,ha)):d,J=a.Array,jb=a.Boolean,Ra=a.Date,kb=a.Function,V=a.Math,Hb=a.Number,Ka=a.Object,mb=a.RegExp,ca=a.String,Ib=a.TypeError,L=[],qb=Ka.prototype,Kb=a._,Fa=mb("^"+ca(qb.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Lb=V.ceil,db=a.clearTimeout,Ea=L.concat,Fb=V.floor,Mb=kb.prototype.toString,Ma=Fa.test(Ma=Ka.getPrototypeOf)&&
Ma,I=qb.hasOwnProperty,fb=L.push,gb=a.setImmediate,eb=a.setTimeout,M=qb.toString,na=Fa.test(na=M.bind)&&na,bb=Fa.test(bb=Ka.create)&&bb,rb=Fa.test(rb=J.isArray)&&rb,Nb=a.isFinite,Ob=a.isNaN,hb=Fa.test(hb=Ka.keys)&&hb,Z=V.max,cb=V.min,sb=a.parseInt,Gb=V.random,H=L.slice,V=Fa.test(a.attachEvent),V=na&&!/\n|true/.test(na+V),ea={};ea[oa]=J;ea[ba]=jb;ea[ia]=Ra;ea[Ha]=kb;ea[K]=Ka;ea[O]=Hb;ea[fa]=mb;ea[S]=ca;m.prototype=k.prototype;var Eb=k.support={};Eb.fastBind=na&&!V;k.templateSettings={escape:/<%-([\s\S]+?)%>/g,
evaluate:/<%([\s\S]+?)%>/g,interpolate:Oa,variable:"",imports:{_:k}};var Q=rb,R=!hb?function(a){var b,c=[];if(!a||!B[typeof a])return c;for(b in a)I.call(a,b)&&c.push(b);return c}:function(a){return!G(a)?[]:hb(a)},Db={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jb=Ta(Db),ob=function(a,b,c){var e,f=a,d=f;if(!f)return d;var h=arguments,j=0,g="number"==typeof c?2:h.length;if(3<g&&"function"==typeof h[g-2])var l=k.createCallback(h[--g-1],h[g--],2);else 2<g&&"function"==typeof h[g-1]&&
(l=h[--g]);for(;++j<g;)if((f=h[j])&&B[typeof f])for(var n=-1,i=B[typeof f]&&R(f),m=i?i.length:0;++n<m;)e=i[n],d[e]=l?l(d[e],f[e]):f[e];return d},tb=function(a,b,c){var e,f=a,d=f;if(!f)return d;for(var h=arguments,j=0,g="number"==typeof c?2:h.length;++j<g;)if((f=h[j])&&B[typeof f])for(var l=-1,i=B[typeof f]&&R(f),n=i?i.length:0;++l<n;)e=i[l],"undefined"==typeof d[e]&&(d[e]=f[e]);return d},ta=function(a,b,c){var e;if(!a||!B[typeof a])return a;b=b&&"undefined"==typeof c?b:k.createCallback(b,c);for(e in a)if(!1===
b(a[e],e,a))break;return a},D=function(a,b,c){if(!a||!B[typeof a])return a;for(var b=b&&"undefined"==typeof c?b:k.createCallback(b,c),e=-1,f=B[typeof a]&&R(a),d=f?f.length:0;++e<d&&!(c=f[e],!1===b(a[c],c,a)););return a},pb=function(a){if(!(a&&M.call(a)==K))return!1;var b=a.valueOf,c="function"==typeof b&&(c=Ma(b))&&Ma(c);return c?a==c||Ma(a)==c:X(a)},jb=U(function $a(a,b,c){for(var e=-1,f=a?a.length:0,d=[];++e<f;){var h=a[e];c&&(h=c(h,e,a));Q(h)?fb.apply(d,b?h:$a(h)):d.push(h)}return d}),ub=U(function(a,
b,d){var h=-1,l=A(),n=a?a.length:0,k=[],m=!b&&n>=t&&l===i,p=d||m?c():k;if(m){var o=j(p);o?(l=g,p=o):(m=!1,p=d?p:(e(p),k))}for(;++h<n;){var o=a[h],q=d?d(o,h,a):o;if(b?!h||p[p.length-1]!==q:0>l(p,q))(d||m)&&p.push(q),k.push(o)}m?(e(p.array),f(p)):d&&e(p);return k});V&&ka&&"function"==typeof gb&&(vb=Da(gb,a));gb=8==sb(va+"08")?sb:function(a,b){return sb(da(a)?a.replace(Pa,""):a,b||0)};k.after=function(a,b){return 1>a?b():function(){if(1>--a)return b.apply(this,arguments)}};k.assign=ob;k.at=function(a){for(var b=
-1,c=Ea.apply(L,H.call(arguments,1)),e=c.length,f=J(e);++b<e;)f[b]=a[c[b]];return f};k.bind=Da;k.bindAll=function(a){for(var b=1<arguments.length?Ea.apply(L,H.call(arguments,1)):P(a),c=-1,e=b.length;++c<e;){var f=b[c];a[f]=Da(a[f],a)}return a};k.bindKey=function(a,b){return u(a,b,H.call(arguments,2),w)};k.compact=function(a){for(var b=-1,c=a?a.length:0,e=[];++b<c;){var f=a[b];f&&e.push(f)}return e};k.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,
b)];return b[0]}};k.countBy=function(a,b,c){var e={},b=k.createCallback(b,c);y(a,function(a,c,f){c=ca(b(a,c,f));I.call(e,c)?e[c]++:e[c]=1});return e};k.createCallback=function(a,b,c){if(null==a)return ib;var e=typeof a;if("function"!=e){if("object"!=e)return function(b){return b[a]};var f=R(a);return function(b){for(var c=f.length,e=!1;c--&&(e=la(b[f[c]],a[f[c]],w)););return e}}return"undefined"==typeof b||ga&&!ga.test(Mb.call(a))?a:1===c?function(c){return a.call(b,c)}:2===c?function(c,e){return a.call(b,
c,e)}:4===c?function(c,e,f,d){return a.call(b,c,e,f,d)}:function(c,e,f){return a.call(b,c,e,f)}};k.debounce=Za;k.defaults=tb;k.defer=vb;k.delay=function(a,b){var c=H.call(arguments,2);return eb(function(){a.apply(r,c)},b)};k.difference=Ia;k.filter=W;k.flatten=jb;k.forEach=y;k.forIn=ta;k.forOwn=D;k.functions=P;k.groupBy=function(a,b,c){var e={},b=k.createCallback(b,c);y(a,function(a,c,f){c=ca(b(a,c,f));(I.call(e,c)?e[c]:e[c]=[]).push(a)});return e};k.initial=function(a,b,c){if(!a)return[];var e=0,
f=a.length;if("number"!=typeof b&&null!=b)for(var d=f,b=k.createCallback(b,c);d--&&b(a[d],d,a);)e++;else e=null==b||c?1:b||e;return n(a,0,cb(Z(0,f-e),f))};k.intersection=function(a){for(var b=arguments,d=b.length,h=-1,l=c(),n=-1,k=A(),m=a?a.length:0,p=[],o=c();++h<d;){var q=b[h];l[h]=k===i&&(q?q.length:0)>=t&&j(h?b[h]:o)}a:for(;++n<m;){var w=l[0],q=a[n];if(0>(w?g(w,q):k(o,q))){h=d;for((w||o).push(q);--h;)if(w=l[h],0>(w?g(w,q):k(b[h],q)))continue a;p.push(q)}}for(;d--;)(w=l[d])&&f(w);e(l);e(o);return p};
k.invert=Ta;k.invoke=function(a,b){var c=H.call(arguments,2),e=-1,f="function"==typeof b,d=a?a.length:0,h=J("number"==typeof d?d:0);y(a,function(a){h[++e]=(f?b:a[b]).apply(a,c)});return h};k.keys=R;k.map=ya;k.max=La;k.memoize=function(a,b){function c(){var e=c.cache,f=$+(b?b.apply(this,arguments):arguments[0]);return I.call(e,f)?e[f]:e[f]=a.apply(this,arguments)}c.cache={};return c};k.merge=Ua;k.min=function(a,b,c){var e=Infinity,f=e;if(!b&&Q(a))for(var c=-1,d=a.length;++c<d;){var j=a[c];j<f&&(f=
j)}else b=!b&&da(a)?h:k.createCallback(b,c),y(a,function(a,c,d){c=b(a,c,d);c<e&&(e=c,f=a)});return f};k.omit=function(a,b,c){var e=A(),f="function"==typeof b,d={};if(f)b=k.createCallback(b,c);else var h=Ea.apply(L,H.call(arguments,1));ta(a,function(a,c,j){if(f?!b(a,c,j):0>e(h,c))d[c]=a});return d};k.once=function(a){var b,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};k.pairs=function(a){for(var b=-1,c=R(a),e=c.length,f=J(e);++b<e;){var d=c[b];f[b]=[d,a[d]]}return f};
k.partial=function(a){return u(a,H.call(arguments,1))};k.partialRight=function(a){return u(a,H.call(arguments,1),null,w)};k.pick=function(a,b,c){var e={};if("function"!=typeof b)for(var f=-1,d=Ea.apply(L,H.call(arguments,1)),h=G(a)?d.length:0;++f<h;){var j=d[f];j in a&&(e[j]=a[j])}else b=k.createCallback(b,c),ta(a,function(a,c,f){b(a,c,f)&&(e[c]=a)});return e};k.pluck=ma;k.range=function(a,b,c){a=+a||0;c=+c||1;null==b&&(b=a,a=0);for(var e=-1,b=Z(0,Lb((b-a)/c)),f=J(b);++e<b;)f[e]=a,a+=c;return f};
k.reject=function(a,b,c){b=k.createCallback(b,c);return W(a,function(a,c,e){return!b(a,c,e)})};k.rest=Ja;k.shuffle=function(a){var b=-1,c=a?a.length:0,e=J("number"==typeof c?c:0);y(a,function(a){var c=Fb(Gb()*(++b+1));e[b]=e[c];e[c]=a});return e};k.sortBy=function(a,b,c){var e=-1,d=a?a.length:0,h=J("number"==typeof d?d:0),b=k.createCallback(b,c);y(a,function(a,c,f){var d=h[++e]=o();d.criteria=b(a,c,f);d.index=e;d.value=a});d=h.length;for(h.sort(l);d--;)a=h[d],h[d]=a.value,f(a);return h};k.tap=function(a,
b){b(a);return a};k.throttle=function(a,b,c){var e=!0,d=!0;!1===c?e=!1:G(c)&&(e="leading"in c?c.leading:e,d="trailing"in c?c.trailing:d);c=o();c.leading=e;c.maxWait=b;c.trailing=d;a=Za(a,b,c);f(c);return a};k.times=function(a,b,c){for(var a=-1<(a=+a)?a:0,e=-1,f=J(a),b=k.createCallback(b,c,1);++e<a;)f[e]=b(e);return f};k.toArray=function(a){return a&&"number"==typeof a.length?n(a):qa(a)};k.transform=function(a,b,c,e){var f=Q(a),b=k.createCallback(b,e,4);null==c&&(f?c=[]:(e=a&&a.constructor,c=G(e&&
e.prototype)?bb(e&&e.prototype):{}));(f?y:D)(a,function(a,e,f){return b(c,a,e,f)});return c};k.union=function(a){Q(a)||(arguments[0]=a?H.call(a):L);return ub(Ea.apply(L,arguments))};k.uniq=ub;k.unzip=Ca;k.values=qa;k.where=W;k.without=function(a){return Ia(a,H.call(arguments,1))};k.wrap=function(a,b){return function(){var c=[a];fb.apply(c,arguments);return b.apply(this,c)}};k.zip=function(a){return a?Ca(arguments):[]};k.zipObject=Ya;k.collect=ya;k.drop=Ja;k.each=y;k.extend=ob;k.methods=P;k.object=
Ya;k.select=W;k.tail=Ja;k.unique=ub;wb(k);k.chain=k;k.prototype.chain=function(){return this};k.clone=za;k.cloneDeep=function(a,b,c){return za(a,!0,b,c)};k.contains=Va;k.escape=function(a){return null==a?"":ca(a).replace(F,s)};k.every=xa;k.find=pa;k.findIndex=function(a,b,c){for(var e=-1,f=a?a.length:0,b=k.createCallback(b,c);++e<f;)if(b(a[e],e,a))return e;return-1};k.findKey=function(a,b,c){var e,b=k.createCallback(b,c);D(a,function(a,c,f){if(b(a,c,f))return e=c,!1});return e};k.has=function(a,b){return a?
I.call(a,b):!1};k.identity=ib;k.indexOf=Xa;k.isArguments=function(a){return M.call(a)==T};k.isArray=Q;k.isBoolean=function(a){return!0===a||!1===a||M.call(a)==ba};k.isDate=function(a){return a?"object"==typeof a&&M.call(a)==ia:!1};k.isElement=function(a){return a?1===a.nodeType:!1};k.isEmpty=function(a){var b=!0;if(!a)return b;var c=M.call(a),e=a.length;if(c==oa||c==S||c==T||c==K&&"number"==typeof e&&Y(a.splice))return!e;D(a,function(){return b=!1});return b};k.isEqual=la;k.isFinite=function(a){return Nb(a)&&
!Ob(parseFloat(a))};k.isFunction=Y;k.isNaN=function(a){return Aa(a)&&a!=+a};k.isNull=function(a){return null===a};k.isNumber=Aa;k.isObject=G;k.isPlainObject=pb;k.isRegExp=function(a){return a?"object"==typeof a&&M.call(a)==fa:!1};k.isString=da;k.isUndefined=function(a){return"undefined"==typeof a};k.lastIndexOf=function(a,b,c){var e=a?a.length:0;for("number"==typeof c&&(e=(0>c?Z(0,e+c):cb(c,e-1))+1);e--;)if(a[e]===b)return e;return-1};k.mixin=wb;k.noConflict=function(){a._=Kb;return this};k.parseInt=
gb;k.random=function(a,b){null==a&&null==b&&(b=1);a=+a||0;null==b?(b=a,a=0):b=+b||0;var c=Gb();return a%1||b%1?a+cb(c*(b-a+parseFloat("1e-"+((c+"").length-1))),b):a+Fb(c*(b-a+1))};k.reduce=ra;k.reduceRight=Ba;k.result=function(a,b){var c=a?a[b]:r;return Y(c)?a[b]():c};k.runInContext=p;k.size=function(a){var b=a?a.length:0;return"number"==typeof b?b:R(a).length};k.some=Wa;k.sortedIndex=Sa;k.template=function(a,c,e){var f=k.templateSettings;a||(a="");var e=tb({},e,f),d=tb({},e.imports,f.imports),f=
R(d),d=qa(d),h,j=0,g=e.interpolate||aa,l="__p += '",g=mb((e.escape||aa).source+"|"+g.source+"|"+(g===Oa?ua:aa).source+"|"+(e.evaluate||aa).source+"|$","g");a.replace(g,function(c,e,f,d,g,n){f||(f=d);l+=a.slice(j,n).replace(Ga,b);e&&(l+="' +\n__e("+e+") +\n'");g&&(h=!0,l+="';\n"+g+";\n__p += '");f&&(l+="' +\n((__t = ("+f+")) == null ? '' : __t) +\n'");j=n+c.length;return c});var l=l+"';\n",n=g=e.variable;n||(g="obj",l="with ("+g+") {\n"+l+"\n}\n");l=(h?l.replace(v,""):l).replace(E,"$1").replace(C,
"$1;");l="function("+g+") {\n"+(n?"":g+" || ("+g+" = {});\n")+"var __t, __p = '', __e = _.escape"+(h?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";e="\n/*\n//@ sourceURL="+(e.sourceURL||"/lodash/template/source["+wa++ +"]")+"\n*/";try{var i=kb(f,"return "+l+e).apply(r,d)}catch(m){throw m.source=l,m;}if(c)return i(c);i.source=l;return i};k.unescape=function(a){return null==a?"":ca(a).replace(x,ja)};k.uniqueId=function(a){var b=++q;return ca(null==
a?"":a)+b};k.all=xa;k.any=Wa;k.detect=pa;k.findWhere=pa;k.foldl=ra;k.foldr=Ba;k.include=Va;k.inject=ra;D(k,function(a,b){k.prototype[b]||(k.prototype[b]=function(){var b=[this.__wrapped__];fb.apply(b,arguments);return a.apply(k,b)})});k.first=sa;k.last=function(a,b,c){if(a){var e=0,f=a.length;if("number"!=typeof b&&null!=b)for(var d=f,b=k.createCallback(b,c);d--&&b(a[d],d,a);)e++;else if(e=b,null==e||c)return a[f-1];return n(a,Z(0,f-e))}};k.take=sa;k.head=sa;D(k,function(a,b){k.prototype[b]||(k.prototype[b]=
function(b,c){var e=a(this.__wrapped__,b,c);return null==b||c&&"function"!=typeof b?e:new m(e)})});k.VERSION="1.3.1";k.prototype.toString=function(){return ca(this.__wrapped__)};k.prototype.value=xb;k.prototype.valueOf=xb;y(["join","pop","shift"],function(a){var b=L[a];k.prototype[a]=function(){return b.apply(this.__wrapped__,arguments)}});y(["push","reverse","sort","unshift"],function(a){var b=L[a];k.prototype[a]=function(){b.apply(this.__wrapped__,arguments);return this}});y(["concat","slice","splice"],
function(a){var b=L[a];k.prototype[a]=function(){return new m(b.apply(this.__wrapped__,arguments))}});return k}var r,u=[],m=[],q=0,w={},$=+new Date+"",t=75,s=40,v=/\b__p \+= '';/g,E=/\b(__p \+=) '' \+/g,C=/(__e\(.*?\)|\b__t\)) \+\n'';/g,x=/&(?:amp|lt|gt|quot|#39);/g,ua=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Na=/\w*$/,Oa=/<%=([\s\S]+?)%>/g,ga=(ga=/\bthis\b/)&&ga.test(p)&&ga,va=" \t\u000b\u000c\u00a0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",
Pa=RegExp("^["+va+"]*0+(?=.$)"),aa=/($^)/,F=/[&<>"']/g,Ga=/['\n\r\t\u2028\u2029\\]/g,ha="Array,Boolean,Date,Function,Math,Number,Object,RegExp,String,_,attachEvent,clearTimeout,isFinite,isNaN,parseInt,setImmediate,setTimeout".split(","),wa=0,T="[object Arguments]",oa="[object Array]",ba="[object Boolean]",ia="[object Date]",Ha="[object Function]",O="[object Number]",K="[object Object]",fa="[object RegExp]",S="[object String]",z={};z[Ha]=!1;z[T]=z[oa]=z[ba]=z[ia]=z[O]=z[K]=z[fa]=z[S]=!0;var B={"boolean":!1,
"function":!0,object:!0,number:!1,string:!1,undefined:!1},A={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},ja=B[typeof exports]&&exports,ka=B[typeof module]&&module&&module.exports==ja&&module,X=B[typeof global]&&global;if(X&&(X.global===X||X.window===X))d=X;var N=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(d._=N,define(function(){return N})):ja&&!ja.nodeType?ka?(ka.exports=N)._=N:ja._=N:d._=N})(this)},"dcl/dcl":function(){(function(d){"undefined"!=
typeof define?define(["./mini"],d):"undefined"!=typeof module?module.exports=d(require("./mini")):dcl=d(dcl)})(function(d){function i(){}function g(a,d,b){var c=a||i,h=d||i,e=b||i,f=function(){var a;c.apply(this,arguments);try{a=e.apply(this,arguments)}catch(b){a=b}h.call(this,arguments,a);if(a instanceof Error)throw a;return a};f.advices={b:a,a:d,f:b};return f}function a(a){return function(h,b){var c=h._m,g;c&&((g=+c.w[b]||0)&&g!=a&&d._e("set chaining",b,h,a,g),c.w[b]=a)}}var h=d(d.Super,{constructor:function(){this.b=
this.f.before;this.a=this.f.after;this.f=this.f.around}});d.mix(d,{Advice:h,advise:function(a){return new h(a)},before:function(a){return new h({before:a})},after:function(a){return new h({after:a})},around:d.superCall,chainBefore:a(1),chainAfter:a(2),isInstanceOf:function(a,d){if(a instanceof d)return!0;var b=a.constructor._m,c;if(b)for(b=b.b,c=b.length-1;0<=c;--c)if(b[c]===d)return!0;return!1},_sb:function(a,h,b,c){var c=c[b]=d._ec(h,b,"f"),i=d._ec(h,b,"b").reverse(),h=d._ec(h,b,"a"),c=a?d._st(c,
1==a?function(a){return d._sc(a.reverse())}:d._sc,b):d._ss(c,b);return!i.length&&!h.length?c||function(){}:g(d._sc(i),d._sc(h),c)}});return d})},"dcl/mini":function(){(function(d){"undefined"!=typeof define?define([],d):"undefined"!=typeof module?module.exports=d():dcl=d()})(function(){function d(b,e){var f=[0],j,i,n,o,t,s,v,E,C=0,x;if(b)if(b instanceof Array){o={};v=b.slice(0).reverse();for(E=v.length-1;0<=E;--E)if(i=v[E],i._u=i._u||a++,j=i._m){for(s=j.b,C=s.length-1;0<C;--C)x=s[C]._u,o[x]=(o[x]||
0)+1;v[E]=s.slice(0)}else v[E]=[i];t={};a:for(;v.length;){for(E=0;E<v.length;++E)if(s=v[E],i=s[0],x=i._u,!o[x]){t[x]||(f.push(i),t[x]=1);s.shift();s.length?--o[s[0]._u]:v.splice(E,1);continue a}d._e("cycle",e,v)}b=b[0];C=f.length-((o=b._m)&&b===f[f.length-(C=o.b.length)]?C:1)-1}else b._u=b._u||a++,f=f.concat((o=b._m)?o.b:b);j=b?d.delegate(b[l]):{};for(s=b&&(o=b._m)?d.delegate(o.w):{constructor:2};0<C;--C)if(i=f[C],o=i._m,c(j,o&&o.h||i[l]),o)for(x in v=o.w)s[x]=(+s[x]||0)|v[x];for(x in e)g(o=e[x])?
s[x]=+s[x]||0:j[x]=o;t={b:f,h:e,w:s,c:{}};f[0]={_m:t,prototype:j};i=j;o=t.w;s=t.b;v=t.c;for(n in o)i[n]=d._sb(o[n],s,n,v);n=j[h];n._m=t;n[l]=j;f[0]=n;return d._p(n)}function i(a){this.f=a}function g(a){return a instanceof i}var a=0,h="constructor",l="prototype",j=function(){},b={},c,o,e,f,n;(c=function(a,b){for(var c in b)a[c]=b[c]})(d,{mix:c,delegate:function(a){j[l]=a;a=new j;j[l]=null;return a},Super:i,superCall:function(a){return new i(a)},_p:function(a){return a},_e:function(a){throw Error("dcl: "+
a);},_f:function(a,b){var c=a.f(b);c.ctr=a.ctr;return c},_ec:o=function(a,c,e){for(var f=a.length-1,d=[],h,j,i="f"==e;h=a[f];--f)if((j=h._m)?(j=j.h).hasOwnProperty(c)&&(g(j=j[c])?i?j.f:j=j[e]:i):i&&(j=h[l][c])&&j!==b[c])j.ctr=h,d.push(j);return d},_sc:f=function(a){var b=a.length,c;return!b?0:1==b?(c=a[0],function(){c.apply(this,arguments)}):function(){for(var c=0;c<b;++c)a[c].apply(this,arguments)}},_ss:e=function(a,c){for(var e=0,f,j=b[c];f=a[e];++e)j=g(f)?a[e]=d._f(f,j,c):f;return c!=h?j:function(){j.apply(this,
arguments)}},_st:n=function(a,b,c){for(var e=0,f,j,l=0;f=a[e];++e)g(f)&&(j=e-l,a[e]=d._f(f,!j?0:1==j?a[l]:b(a.slice(l,e)),c),l=e);j=e-l;return!j?0:1==j&&c!=h?a[l]:b(l?a.slice(l):a)},_sb:function(a,b,c,d){b=d[c]=o(b,c,"f");return(a?n(b,f,c):e(b,c))||function(){}}});return d})},"frozen/box2d/entities/Circle":function(){define(["dcl","./Entity","../../utils/distance"],function(d,i,g){return d(i,{declaredClass:"frozen/box2d/entities/Circle",radius:1,draw:d.superCall(function(a){return function(d,g){var g=
g||this.scale||1,j=d.lineWidth;d.lineWidth=this.lineWidth;d.fillStyle=this.fillStyle;d.strokeStyle=this.strokeStyle;d.beginPath();d.arc(this.x*g,this.y*g,this.radius*g,0,2*Math.PI,!0);d.closePath();d.fill();d.stroke();this.staticBody||(d.save(),d.translate(this.x*g,this.y*g),d.rotate(this.angle),d.translate(-this.x*g,-this.y*g),d.beginPath(),d.moveTo(this.x*g,this.y*g),d.lineTo(this.x*g,this.y*g-this.radius*g),d.closePath(),d.stroke(),d.restore());d.lineWidth=j;a.apply(this,[d,g])}}),scaleShape:d.superCall(function(a){return function(d){this.radius*=
d;a.apply(this,[d])}}),pointInShape:function(a){return g(a,this)<=this.radius}})})},"frozen/box2d/entities/Entity":function(){define(["dcl","dcl/bases/Mixer","lodash"],function(d,i,g){return d(i,{declaredClass:"frozen/box2d/entities/Entity",id:0,x:0,y:0,scale:null,fixedRotation:!1,angle:0,center:null,restitution:0.3,density:1,friction:0.9,linearDamping:0,linearVelocity:null,angularVelocity:0,angularDamping:0,staticBody:!1,fillStyle:"rgba(128,128,128,0.5)",strokeStyle:"#000",lineWidth:1,maskBits:null,
categoryBits:null,groupIndex:null,sensor:!1,update:function(a){g.assign(this,a)},draw:function(a,d){var d=d||this.scale||1,g=a.lineWidth;a.lineWidth=this.lineWidth;a.fillStyle=this.strokeStyle;a.beginPath();a.arc(this.x*d,this.y*d,4,0,2*Math.PI,!0);a.closePath();a.fill();if(this.center)a.fillStyle="yellow",a.beginPath(),a.arc(this.center.x*d,this.center.y*d,2,0,2*Math.PI,!0),a.closePath(),a.fill();a.lineWidth=g},scaleShape:function(a){this.x*=a;this.y*=a;this.alreadyScaled=!0}})})},"dcl/bases/Mixer":function(){(function(d){"undefined"!=
typeof define?define(["../mini"],d):"undefined"!=typeof module?module.exports=d(require("../mini")):dclBasesMixer=d(dcl)})(function(d){return d(null,{declaredClass:"dcl/bases/Mixer",constructor:function(i){d.mix(this,i)}})})},"frozen/utils/distance":function(){define(function(){return function(d,i){return Math.sqrt((i.x-d.x)*(i.x-d.x)+(i.y-d.y)*(i.y-d.y))}})},"frozen/Animation":function(){define(["./AnimFrame","dcl","dcl/bases/Mixer"],function(d,i,g){var a=i(g,{currFrameIndex:0,animTime:0,totalDuration:0,
height:64,width:64,image:null,offsetX:0,offsetY:0,constructor:function(){this.start()},createFromSheet:function(d,g,j,b,c,i){j=new a({image:j,height:c,width:b});b=Array.isArray(g);c=1;i||(i=0);for(var e=0;e<d;e++)c=b?g[e]:g,j.addFrame(c,e,i);return j},clone:function(){return new a({image:this.image,frames:this.frames,totalDuration:this.totalDuration})},addFrame:function(a,g,j){if(!this.frames)this.frames=[];this.totalDuration+=a;this.frames.push(new d({endTime:this.totalDuration,image:this.image,
imgSlotX:g,imgSlotY:j}))},start:function(){this.currFrameIndex=this.animTime=0},update:function(a){if(1<this.frames.length){this.animTime+=a;if(this.animTime>=this.totalDuration)this.animTime%=this.totalDuration,this.currFrameIndex=0;for(;this.animTime>this.frames[this.currFrameIndex].endTime;)this.currFrameIndex++}},getCurrentFrame:function(){return 0===this.frames.length?null:this.frames[this.currFrameIndex]},draw:function(a,d,g){var b=this.getCurrentFrame();a.drawImage(this.image,b.imgSlotX*this.width+
this.offsetX,b.imgSlotY*this.height+this.offsetY,this.width,this.height,d,g,this.width,this.height)}});return a})},"frozen/AnimFrame":function(){define(["dcl","dcl/bases/Mixer"],function(d,i){return d(i,{endTime:0,imgSlotX:0,imgSlotY:0,image:null})})},"frozen/plugins/loadImage":function(){define(["../ResourceManager","../utils/parseString"],function(d,i){var g=new d;return{load:function(a,d,l){a=i(a);a=g.loadImage(a);l(a)}}})},"frozen/ResourceManager":function(){define("require,./plugins/sound!,dcl,dcl/bases/Mixer,lodash,dojo/on".split(","),
function(d,i,g,a,h,l){function j(a,b){var c=b;a&&(c=[a,b].join("/"));return c.replace(/\/{2,}/g,"/")}function b(a){var b=document.createElement("canvas");b.height=a.height;b.width=a.width;var c=b.getContext("2d");c.translate(b.width,0);c.scale(-1,1);c.drawImage(a,0,0);return b.toDataURL()}function c(a){var b=document.createElement("canvas");b.height=a.height;b.width=a.width;var c=b.getContext("2d");c.translate(0,b.height);c.scale(1,-1);c.drawImage(a,0,0);return b.toDataURL()}var o=g(null,{name:"",
img:null,complete:!1,constructor:function(a){var b=this;b.name=a;b.img=new Image;l.once(b.img,"load",function(){b.complete=!0})},load:function(){this.img.src=d.toUrl(this.name)}});return g(a,{allLoaded:!1,imageDir:null,soundDir:null,resourceList:{},loadImage:function(a){var b=!1;if("object"!==typeof a)if("string"===typeof a)b=!0,a=[a];else return;var c=this,a=h.transform(a,function(a,b,e){b=j(c.imageDir,b);if(c.resourceList[b])return a[e]=c.resourceList[b].img;c.allLoaded=!1;var f=new o(b);f.load();
c.resourceList[b]=f;a[e]=f.img});return b?a[0]:a},loadSound:function(a){var b=!1;if("object"!==typeof a)if("string"===typeof a)b=!0,a=[a];else return;var c=this,a=h.transform(a,function(a,b,e){b=j(c.soundDir,b);if(c.resourceList[b])return a[e]=c.resourceList[b];c.allLoaded=!1;var f=new i(b);c.resourceList[b]=f;a[e]=f});return b?a[0]:a},flipImage:function(a,b,c){this.allLoaded=!1;var d=new o(a);this.resourceList[a]=d;l.once(b,"load",function(){d.img.src=c(b)});h.any(this.resourceList,function(a){if(a.img===
b&&a.complete)return d.img.src=c(b),!0});return d.img},flipImageX:function(a,c){return this.flipImage(a,c,b)},flipImageY:function(a,b){return this.flipImage(a,b,c)},resourcesReady:function(){if(!this.allLoaded){for(var a in this.resourceList)if(!this.resourceList[a].complete)return!1;this.allLoaded=!0}return!0},getPercentComplete:function(){var a=0,b=0,c;for(c in this.resourceList){var d=this.resourceList[c];b++;d.complete&&(a+=1)}return 0===b?0:Math.round(100*(a/b))}})})},"frozen/plugins/sound":function(){define(["../sounds/Sound",
"../sounds/WebAudio","../sounds/HTML5Audio","dojo/has"],function(d,i,g,a){return{load:function(h,l,j){return a("WebAudio")?j(i):a("HTML5Audio")?j(g):j(d)}}})},"frozen/sounds/Sound":function(){define(["dcl","dojo/has","dojo/sniff"],function(d,i){i.add("shittySound",function(){return!(!i("android")&&!i("ios")||!i("webkit"))});return d(null,{declaredClass:"frozen/sounds/Sound",name:null,complete:!1,formats:{"audio/mpeg":".mp3","audio/webm":".webm","audio/ogg":".ogg","audio/wav":".wav","audio/aac":".aac",
"audio/x-m4a":".m4a"},probably:null,maybe:null,constructor:function(d){if(!this.probably)this.probably=[];if(!this.maybe)this.maybe=[];"string"===typeof d&&this.load(d)},load:function(d){this.name=d;this.complete=!0},loop:function(){},play:function(){},_initAudio:function(){},_chooseFormat:function(){if(!this.probably.length&&!this.maybe.length){var d=new Audio,a,h;for(a in this.formats)h=d.canPlayType(a),"probably"===h?this.probably.push(this.formats[a]):"maybe"===h&&this.maybe.push(this.formats[a])}return this.probably.length?
this.probably[0]:this.maybe.length?this.maybe[0]:""},_nextFormat:function(){if(1<this.probably.length)return this.probably.shift(),this.probably[0];if(1===this.probably.length&&(this.probably.length=0,this.maybe.length))return this.maybe[0];if(1<this.maybe.length)return this.maybe.shift(),this.maybe[0];if(1===this.maybe.length)this.maybe.length=0;return""}})})},"frozen/sounds/WebAudio":function(){define("require,./Sound,../utils/removeExtension,dcl,dojo/on,dojo/has,../shims/AudioContext".split(","),
function(d,i,g,a,h,l){l.add("WebAudio",function(a){return!!a.AudioContext});var j=null;if(l("WebAudio")&&(j=new window.AudioContext,l("shittySound")))h.once(document,"touchstart",function(){var a=j.createBufferSource();a.buffer=j.createBuffer(1,1,22050);a.connect(j.destination);a.start(0)});return a(i,{declaredClass:"frozen/sounds/WebAudio",audioContext:j,buffer:null,load:function(a){var c=this;this.name=a;var j=g(a);j===a&&(a=j+this._chooseFormat());a=d.toUrl(a);j=new XMLHttpRequest;j.open("GET",
a,!0);j.responseType="arraybuffer";h.once(j,"load",function(a){c.audioContext.decodeAudioData(a.target.response,function(a){c.buffer=a;c.complete=!0},function(){c._nextFormat()?c.load(c.name):c.complete=!0})});j.send()},loop:function(a){this.buffer&&this._initAudio(a,!0).start(0)},play:function(a,c){this.buffer&&this._initAudio(a,!1).start(c||0)},_initAudio:function(a,c){var c="boolean"===typeof c?c:!1,d=this.audioContext.createBufferSource();d.buffer=this.buffer;d.loop=c;if(a){var e=this.audioContext.createGain();
e.gain.value=a;d.connect(e);e.connect(this.audioContext.destination)}else d.connect(this.audioContext.destination);return d}})})},"frozen/utils/removeExtension":function(){define(function(){return function(d){return d.replace(/(.*)\.[^.]{1,4}$/,"")}})},"dojo/on":function(){define(["require","./_base/kernel","./has"],function(d,i,g){function a(a,c,d,f,h){if(f=c.match(/(.*):(.*)/))return c=f[2],f=f[1],j.selector(f,c).call(h,a,d);g("touch")&&(b.test(c)&&(d=u(d)),!g("event-orientationchange")&&"orientationchange"==
c&&(c="resize",a=window,d=u(d)));n&&(d=n(d));if(a.addEventListener){var i=c in e,l=i?e[c]:c;a.addEventListener(l,d,i);return{remove:function(){a.removeEventListener(l,d,i)}}}c="on"+c;throw Error("Target must be an event emitter");}function h(){this.cancelable=!1}function l(){this.bubbles=!1}d=window.ScriptEngineMajorVersion;g.add("jscript",d&&d()+ScriptEngineMinorVersion()/10);g.add("event-orientationchange",g("touch")&&!g("android"));g.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&
!!window.Event.prototype.stopImmediatePropagation);var j=function(b,c,e,d){return"function"==typeof b.on&&"function"!=typeof c?b.on(c,e):j.parse(b,c,e,a,d,this)};j.pausable=function(a,b,c,e){var d,a=j(a,b,function(){if(!d)return c.apply(this,arguments)},e);a.pause=function(){d=!0};a.resume=function(){d=!1};return a};j.once=function(a,b,c){var e=j(a,b,function(){e.remove();return c.apply(this,arguments)});return e};j.parse=function(a,b,c,e,d,f){if(b.call)return b.call(f,a,c);if(-1<b.indexOf(",")){for(var b=
b.split(/\s*,\s*/),h=[],j=0,g;g=b[j++];)h.push(e(a,g,c,d,f));h.remove=function(){for(var a=0;a<h.length;a++)h[a].remove()};return h}return e(a,b,c,d,f)};var b=/^touch/;j.selector=function(a,b,c){return function(e,d){function f(b){for(h=h&&h.matches?h:i.query;!h.matches(b,a,e);)if(b==e||!1===c||!(b=b.parentNode)||1!=b.nodeType)return;return b}var h="function"==typeof a?{matches:a}:this,g=b.bubble;return g?j(e,g(f),d):j(e,b,function(a){var b=f(a.target);return b&&d.call(b,a)})}};var c=[].slice,o=j.emit=
function(a,b,e){var d=c.call(arguments,2),f="on"+b;if("parentNode"in a){var j=d[0]={},g;for(g in e)j[g]=e[g];j.preventDefault=h;j.stopPropagation=l;j.target=a;j.type=b;e=j}do a[f]&&a[f].apply(a,d);while(e&&e.bubbles&&(a=a.parentNode));return e&&e.cancelable&&e},e={};if(!g("event-stopimmediatepropagation"))var f=function(){this.modified=this.immediatelyStopped=!0},n=function(a){return function(b){if(!b.immediatelyStopped)return b.stopImmediatePropagation=f,a.apply(this,arguments)}};e={focusin:"focus",
focusout:"blur"};j.emit=function(a,b,c){if(a.dispatchEvent&&document.createEvent){var e=a.ownerDocument.createEvent("HTMLEvents");e.initEvent(b,!!c.bubbles,!!c.cancelable);for(var d in c)d in e||(e[d]=c[d]);return a.dispatchEvent(e)&&e}return o.apply(j,arguments)};if(g("touch"))var p=function(){},r=window.orientation,u=function(a){return function(b){var c=b.corrected;if(!c){var e=b.type;try{delete b.type}catch(d){}b.type?(p.prototype=b,c=new p,c.preventDefault=function(){b.preventDefault()},c.stopPropagation=
function(){b.stopPropagation()}):(c=b,c.type=e);b.corrected=c;if("resize"==e){if(r==window.orientation)return null;r=window.orientation;c.type="orientationchange";return a.call(this,c)}if(!("rotation"in c))c.rotation=0,c.scale=1;var e=c.changedTouches[0],f;for(f in e)delete c[f],c[f]=e[f]}return a.call(this,c)}};return j})},"frozen/shims/AudioContext":function(){define(function(){for(var d=["ms","moz","webkit","o"],i=0;i<d.length&&!window.AudioContext;++i)window.AudioContext=window[d[i]+"AudioContext"]})},
"frozen/sounds/HTML5Audio":function(){define("require,./Sound,../utils/removeExtension,dcl,dojo/on,dojo/has".split(","),function(d,i,g,a,h,l){l.add("HTML5Audio",function(a){return!!a.Audio});return a(i,{declaredClass:"frozen/sounds/HTML5Audio",audio:null,load:function(a){this.audio=new Audio;var b=this;this.name=a;var c=g(a);c===a&&(a=c+this._chooseFormat());a=d.toUrl(a);if(l("shittySound"))h.once(document,"touchstart",function(){var a=b.audio.volume;b.audio.volume=0;b.audio.play();b.audio.pause();
b.audio.volume=a}),this._updateCurrentTime=null,h.once(this.audio,"progress",function(){null!==b._updateCurrentTime&&b._updateCurrentTime()});this.audio.pause();this.audio.preload="auto";h.once(this.audio,"error",function(){b._nextFormat()?b.load(b.name):(b.audio.src=null,b.complete=!0)});h.once(this.audio,"loadeddata",function(){b.complete=!0});this.audio.src=a},loop:function(a){var b=this._initAudio(a,!0);h.once(b,"loadeddata",function(){b.play()})},play:function(a,b){b=b||0;if(l("shittySound"))try{return this.audio.currentTime=
b/1E3,this.audio.play()}catch(c){return this._updateCurrentTime=function(){this._updateCurrentTime=null;this.audio.currentTime=b/1E3;return this.audio.play()},this.audio.play()}var d=this._initAudio(a,!1);h.once(d,"loadeddata",function(){d.currentTime=b/1E3;d.play()})},_initAudio:function(a,b){var b="boolean"===typeof b?b:!1,c=new Audio;c.pause();c.volume=a||1;c.loop=b;c.preload="auto";c.mozLoadFrom?c.mozLoadFrom(this.audio):c.src=this.audio.currentSrc;return c}})})},"frozen/utils/parseString":function(){define(function(){return function(d){0===
d.indexOf("{")&&d.lastIndexOf("}")===d.length-1?d=JSON.parse(d.replace(/,/g,'","').replace(/:(?!\/\/)/g,'":"').replace(/\{/,'{"').replace(/\}/,'"}')):0===d.indexOf("[")&&d.lastIndexOf("]")===d.length-1&&(d=JSON.parse(d.replace(/,/g,'","').replace(/\[/g,'["').replace(/\]/g,'"]')));return d}})},"game/Paddle":function(){define(["dcl","frozen/box2d/entities/Rectangle","frozen/plugins/loadImage!resources/tiles.png"],function(d,i,g){return d(i,{id:"paddle",x:110,y:376,halfWidth:24,halfHeight:8,bigHalfWidth:24,
smallHalfWidth:16,smallMillis:0,smallMillisStart:1E4,friction:0,categoryBits:2,draw:function(a){0<this.smallMillis?a.drawImage(g,0,80,32,16,(this.x-this.halfWidth)*this.scale,(this.y-this.halfHeight)*this.scale,32,16):a.drawImage(g,0,64,48,16,(this.x-this.halfWidth)*this.scale,(this.y-this.halfHeight)*this.scale,48,16)}})})},"frozen/box2d/entities/Rectangle":function(){define(["dcl","./Entity"],function(d,i){return d(i,{declaredClass:"frozen/box2d/entities/Rectangle",halfWidth:1,halfHeight:1,draw:d.superCall(function(d){return function(a,
h){var h=h||this.scale||1,i=a.lineWidth;a.lineWidth=this.lineWidth;a.save();a.translate(this.x*h,this.y*h);a.rotate(this.angle);a.translate(-this.x*h,-this.y*h);a.fillStyle=this.fillStyle;a.strokeStyle=this.strokeStyle;a.fillRect((this.x-this.halfWidth)*h,(this.y-this.halfHeight)*h,2*this.halfWidth*h,2*this.halfHeight*h);a.strokeRect((this.x-this.halfWidth)*h,(this.y-this.halfHeight)*h,2*this.halfWidth*h,2*this.halfHeight*h);a.restore();a.lineWidth=i;d.apply(this,[a,h])}}),scaleShape:d.superCall(function(d){return function(a){this.halfHeight*=
a;this.halfWidth*=a;d.apply(this,[a])}}),pointInShape:function(d){return d.x>=this.x-this.halfWidth&&d.x<=this.x+this.halfWidth&&d.y>=this.y-this.halfHeight&&d.y<=this.y+this.halfHeight}})})},"game/PaddleJoint":function(){define(["dcl","frozen/box2d/joints/Prismatic"],function(d,i){return d(i,{bodyId1:"paddle",bodyId2:"leftWall",id:"pJoint"})})},"frozen/box2d/joints/Prismatic":function(){define(["dcl","lodash","./Joint"],function(d,i,g){var a=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.Joints.b2PrismaticJointDef;
return d(g,{declaredClass:"frozen/box2d/joints/Prismatic",axisScale:null,createB2Joint:function(d){if(d&&d.bodiesMap&&d.b2World&&d.jointsMap&&!d.jointsMap[this.id]){var j=d.bodiesMap[this.bodyId1],b=d.bodiesMap[this.bodyId2];if(j&&b){var c;this.bodyPoint1&&(c=new a(this.bodyPoint1.x,this.bodyPoint1.y));c=c||j.GetWorldCenter();var g=new h,e;e=this.axisScale?new a(this.axisScale.x,this.axisScale.y):new a(1,0);g.Initialize(j,b,c,e);this.jointAttributes&&i.assign(g,this.jointAttributes);return d.b2World.CreateJoint(g)}}}})})},
"frozen/box2d/joints/Joint":function(){define(["dcl","dcl/bases/Mixer"],function(d,i){return d(i,{declaredClass:"frozen/box2d/joints/Joint",bodyId1:null,bodyId2:null,bodyPoint1:null,jointAttributes:null,scaleJointLocation:function(d){if(d&&this.bodyPoint1)this.bodyPoint1.x*=d,this.bodyPoint1.y*=d,this.alreadyScaled=!0}})})},"game/PowerUp":function(){define(["./Power","dcl"],function(d,i){return i(d,{powerUp:!0,draw:function(d){d.drawImage(this.tiles,96,96,16,16,this.x*this.scale-8,this.y*this.scale-
8,16,16)}})})},"game/Power":function(){define(["lodash","dcl","frozen/box2d/entities/Rectangle","frozen/plugins/loadImage!resources/tiles.png"],function(d,i,g,a){return i(g,{halfWidth:8,halfHeight:8,staticBody:!1,impulse:1,maskBits:2,groupIndex:-1,tiles:a,constructor:function(){if(!this.id)this.id=d.uniqueId()}})})},"game/PowerDown":function(){define(["./Power","dcl"],function(d,i){return i(d,{powerDown:!0,draw:function(d){d.drawImage(this.tiles,112,96,16,16,this.x*this.scale-8,this.y*this.scale-
8,16,16)}})})},"frozen/plugins/loadSound":function(){define(["../ResourceManager","../utils/parseString"],function(d,i){var g=new d;return{load:function(a,d,l){a=i(a);a=g.loadSound(a);l(a)}}})},"game/draw":function(){define(["lodash","frozen/plugins/loadImage!resources/bg_prerendered.png","frozen/plugins/loadImage!resources/logo.png","frozen/plugins/loadImage!resources/tiles.png"],function(d,i,g,a){return function(h){h.font="20px Arial";h.fillStyle="#000";h.drawImage(i,0,0);if(1===this.state.screen){this.entities.paddle.draw(h);
var l=this.state.balls.concat(this.state.currentBricks,this.state.powerUps,this.state.powerDowns);d.forEach(l,function(a){a.draw(h)});h.fillText("lives: "+this.state.lives,20,405);h.textAlign="center";h.fillText("score: "+this.state.score,this.width/2,405);h.textAlign="right";h.fillText("level: "+(this.state.currentLevel+1),300,405);0<this.state.launchMillis&&(l=Math.floor(Math.abs(this.state.launchMillis-3E3)/1E3),h.drawImage(a,32*l,96,32,48,144,180,32,48))}else l=this.width/2,h.drawImage(g,l-g.width/
2,70),h.textAlign="center",0===this.state.screen?this.mobile?h.fillText("Tap to start",l,315):(h.fillText("Click to start",l,315),h.fillText("during the game: use L/R arrow",l,380),h.fillText("keys to skip levels",l,400)):2===this.state.screen?h.fillText("Game Over",l,300):3===this.state.screen&&h.fillText("You Win!",l,300)}})},"game/walls":function(){define({entities:[{x:5,y:182,halfWidth:11,halfHeight:185,staticBody:!0,zone:!1,type:"Rectangle",id:"leftWall"},{x:315,y:182,halfWidth:11,halfHeight:184.5,
staticBody:!0,zone:!1,type:"Rectangle",id:"rightWall"},{x:159,y:8,halfWidth:158,halfHeight:7,staticBody:!0,zone:!1,type:"Rectangle",id:"top"},{x:313,y:401,halfWidth:8,halfHeight:16,staticBody:!0,zone:!1,type:"Rectangle",id:"rightBottom"},{x:6,y:401,halfWidth:10,halfHeight:15.5,staticBody:!0,zone:!1,type:"Rectangle",id:"leftBottom"},{x:-10,y:373,halfWidth:10,halfHeight:37,staticBody:!0,zone:!1,type:"Rectangle",id:"leftBlocker"},{x:330,y:375.5,halfWidth:10,halfHeight:29.5,staticBody:!0,zone:!1,type:"Rectangle",
id:"rightBlocker"}],joints:[],canvas:{height:416,width:320}})},"game/loadLevel":function(){define(["./Brick","./levels","lodash"],function(d,i,g){return function(a){var h=this.width/2-112,a=i[a],l=0;this.removeBodies(this.state.currentBricks);this.state.currentBricks=[];g.forEach(a.bricks,function(a,c){g.forEach(a,function(a,b){if(null!==a){var f=new d({brickType:a,x:h+32*b+16,y:16*c+78});this.addBody(f);this.state.currentBricks.push(f)}},this)},this);var j=g.shuffle(this.state.currentBricks);g.times(a.powerUps,
function(){j[l].powerUpBrick=!0;l++});g.times(a.powerDowns,function(){j[l].powerDownBrick=!0;l++});this.state.currentBricks=j;this.state.launchMillis=3001;if(0<this.entities.paddle.slowMillis)this.entities.paddle.slowMillis=1;this.removeBodies(this.state.balls,this.state.powerUps,this.state.powerDowns);this.state.balls=[];this.state.powerUps=[];this.state.powerDowns=[];this.newBall()}})},"game/Brick":function(){define("lodash,dcl,frozen/box2d/entities/Rectangle,frozen/Animation,frozen/ResourceManager,frozen/plugins/loadImage!resources/tiles.png".split(","),
function(d,i,g,a,h,l){var j=h.prototype.flipImageX("flipped",l);return i(g,{img:l,x:100,y:376,halfWidth:15.5,halfHeight:7.5,staticBody:!0,friction:0,dyingAnim:null,birthingAnim:null,dead:!1,dying:!1,dyingMillis:300,birthing:!0,birthingMillis:300,powerUpBrick:!1,powerDownBrick:!1,brick:!0,brickType:0,constructor:function(){if(!this.id)this.id=d.uniqueId()},getBirthingAnim:function(){if(!this.birthingAnim)this.birthingAnim=a.prototype.createFromSheet(3,100,j,32,16),this.birthingAnim.offsetX=32,this.birthingAnim.offsetY=
16*this.brickType;return this.birthingAnim},getDyingAnim:function(){if(!this.dyingAnim)this.dyingAnim=a.prototype.createFromSheet(4,100,l,32,16),this.dyingAnim.offsetX=64,this.dyingAnim.offsetY=16*this.brickType;return this.dyingAnim},updateAnimation:function(a){if(this.dying){if(this.getDyingAnim().update(a),this.dyingMillis-=a,0>=this.dyingMillis)this.dying=!1,this.dead=!0}else if(this.birthing&&(this.getBirthingAnim().update(a),this.birthingMillis-=a,0>=this.birthingMillis))this.birthing=!1},draw:function(a){this.dead||
(this.dying?this.getDyingAnim().draw(a,this.x*this.scale-16,this.y*this.scale-8):this.birthing?this.getBirthingAnim().draw(a,this.x*this.scale-16,this.y*this.scale-8):a.drawImage(this.img,0,16*this.brickType,32,16,this.x*this.scale-16,this.y*this.scale-8,32,16))}})})},"frozen/box2d/BoxGame":function(){define(["../GameCore","./Box","lodash","dcl"],function(d,i,g,a){return a(d,{box:null,boxUpdating:!0,entities:null,joints:null,constructor:function(){if(!this.box)this.box=new i;if(!this.entities)this.entities=
{};if(!this.joints)this.joints={}},beforeUpdate:function(a){this.boxUpdating&&(this.box.update(a),this.box.updateExternalState(this.entities))},addBody:function(a){this.entities[a.id]=a;this.box.addBody(a)},addBodies:function(){var a=g.flatten(arguments,!0),d=this;g.forEach(a,function(a){d.addBody(a)})},removeBody:function(a){this.box.removeBody(a.id);delete this.entities[a.id]},removeBodies:function(){var a=g.flatten(arguments,!0),d=this;g.forEach(a,function(a){d.removeBody(a)})},addJoint:function(a){this.joints[a.id]=
a;this.box.addJoint(a)},addJoints:function(){var a=g.flatten(arguments,!0),d=this;g.forEach(a,function(a){d.addJoint(a)})},removeJoint:function(a){this.box.removeJoint(a.id);delete this.joints[a.id]},removeJoints:function(){var a=g.flatten(arguments,!0),d=this;g.forEach(a,function(a){d.removeJoint(a)})}})})},"frozen/GameCore":function(){define("dcl,dcl/advise,dcl/bases/Mixer,lodash,./InputManager,./ResourceManager,./shims/RAF".split(","),function(d,i,g,a,h,l){return d(g,{statics:{FONT_SIZE:24},isRunning:!1,
canvasId:null,maxStep:40,contextType:"2d",height:0,width:0,resourceManager:null,inputManager:null,loadingForeground:"#00F",loadingBackground:"#FFF",gameAreaId:null,canvasPercentage:0,requestId:null,constructor:function(){var a=this.preUpdate||this.beforeUpdate;a&&i.before(this,"update",a)},setHeight:function(a){this.height=a;this.canvas.height=a},setWidth:function(a){this.width=a;this.canvas.width=a},stop:function(){window.cancelAnimationFrame(this.requestId);this.requestId=null;this.isRunning=!1},
run:function(){this.isRunning||(this.init(),this.initInput(this.inputManager),this.launchLoop())},loadResources:function(){},init:function(){if(!this.canvas)this.canvas=document.getElementById(this.canvasId);if(this.canvas){if(!this.context)this.context=this.canvas.getContext(this.contextType);if(this.context){this.setHeight(this.height||this.canvas.height);this.setWidth(this.width||this.canvas.width);if(!this.inputManager)this.inputManager=this.gameAreaId&&this.canvasPercentage?new h({canvas:this.canvas,
gameArea:document.getElementById(this.gameAreaId),canvasPercentage:this.canvasPercentage}):new h({canvas:this.canvas});this.inputManager.resize();if(!this.resourceManager)this.resourceManager=new l;this.loadResources(this.resourceManager);this.isRunning=!0}else alert("Sorry, your browser does not support a "+this.contextType+" drawing surface on canvas.  I recommend any browser but Internet Explorer")}else alert("Sorry, your browser does not support canvas.  I recommend any browser but Internet Explorer")},
initInput:function(){},handleInput:function(){},gameLoop:function(){this.currTime=(new Date).getTime();this.elapsedTime=Math.min(this.currTime-this.prevTime,this.maxStep);this.prevTime=this.currTime;this.resourceManager&&!this.resourceManager.resourcesReady()?(this.updateLoadingScreen(this.elapsedTime),this.drawLoadingScreen(this.context)):(this.handleInput(this.inputManager,this.elapsedTime),this.paused||this.update(this.elapsedTime),this.context.save(),this.draw(this.context),this.context.restore())},
launchLoop:function(){this.elapsedTime=0;var d=Date.now();this.prevTime=this.currTime=d;this.loopRunner=a.bind(this.loopRunner,this);this.requestId=window.requestAnimationFrame(this.loopRunner)},loopRunner:function(){this.gameLoop();this.requestId=window.requestAnimationFrame(this.loopRunner)},update:function(){},updateLoadingScreen:function(){},draw:function(a){if("2d"===this.contextType)a.font="14px sans-serif",a.fillText("This game does not have its own draw function!",10,50)},drawLoadingScreen:function(a){if(this.resourceManager&&
"2d"===this.contextType)a.fillStyle=this.loadingBackground,a.fillRect(0,0,this.width,this.height),a.fillStyle=this.loadingForeground,a.strokeStyle=this.loadingForeground,a.font="bold "+Math.floor(this.height/12)+"px sans-serif",a.fillText("Loading... "+this.resourceManager.getPercentComplete()+"%",0.1*this.width,0.55*this.height),a.strokeRect(0.1*this.width,0.7*this.height,0.8*this.width,0.1*this.height),a.fillRect(0.1*this.width,0.7*this.height,0.8*this.width*this.resourceManager.getPercentComplete()/
100,0.1*this.height),a.lineWidth=4}})})},"dcl/advise":function(){(function(d){"undefined"!=typeof define?define([],d):"undefined"!=typeof module?module.exports=d():advise=d()})(function(){function d(a,d){this.nb=this.pb=this.na=this.pa=this.nf=this.pf=this;this.i=a;this.n=d}function i(a){var d=function(){var d,b,c=arguments;for(d=a.pb;d!==a;d=d.pb)d.b.apply(this,c);try{a.pf!==a&&(b=a.pf.f.apply(this,c))}catch(g){b=g}for(d=a.na;d!==a;d=d.na)d.a.call(this,c,b);if(b instanceof Error)throw b;return b};
d.adviceNode=a;return d}function g(a,g,j){var b=a[g],c;b&&b.adviceNode&&b.adviceNode instanceof d?c=b.adviceNode:(c=new d(a,g),b&&b.advices?(b=b.advices,c.a(b.b,b.a,b.f)):c.a(0,0,b),a[g]=i(c));"function"==typeof j&&(j=j(g,a));return c.a(j.before,j.after,0,j.around)}var a=d.prototype={a:function(a,i,j,b){var c=new d(this.i,this.n);c.p=this;c.b=a;this._a("b",c);c.a=i;this._a("a",c);c.f=j;this._a("f",c,b);if(c.o=b)c.f=g._f(b,c.pf.f,this);return c},_a:function(a,d,g){if(d[a]||g)g="n"+a,a="p"+a,(d[a]=
this[a])[g]=(d[g]=this)[a]=d},r:function(a){this._r("b",a);this._r("a",a);this._r("f",a)},_r:function(a,d){var g="n"+a,b="p"+a;d[g][b]=d[b];d[b][g]=d[g]},destroy:function(){var a=this.pf.f,d=this.nf,i=this.p;this.r(this);if(d!==this)for(;d!==i;a=d.f,d=d.nf)if(d.o)d.f=g._f(d.o,a,this);this.i=0}};a.unadvise=a.destroy;g.before=function(a,d,i){return g(a,d,{before:i})};g.after=function(a,d,i){return g(a,d,{after:i})};g.around=function(a,d,i){return g(a,d,{around:i})};g.Node=d;g._f=function(a,d){return a(d)};
return g})},"frozen/InputManager":function(){define("./GameAction,./MouseAction,./TouchAction,./utils/insideCanvas,dcl,dcl/bases/Mixer,dcl/mixins/Cleanup,dojo/has,dojo/on,lodash,hammer,dojo/domReady!".split(","),function(d,i,g,a,h,l,j,b,c,o,e){return h([l,j],{keyActions:null,mouseAction:null,touchAction:null,canvas:null,handleMouse:!0,handleTouch:!0,handleKeys:!0,gameArea:null,canvasPercentage:null,emulateMouse:!0,hammer:null,on:function(a,b){var c=this.hammer,d=this.removeCleanup;c.on(a,b);var e=
this.pushCleanup([a,b],function(a){c.off.apply(c,a)});return{remove:function(){d(e);e()}}},constructor:function(){function a(b){b.remove()}o.bindAll(this);if(!this.hammer)this.hammer=e(document,{drag_max_touches:0,hold:!1});if(!this.keyActions)this.keyActions={};this.handleKeys&&(this.pushCleanup(c(document,"keydown",this.keydown),a),this.pushCleanup(c(document,"keyup",this.keyup),a));if(this.emulateMouse){if(this.on("touch",this.mousedown),this.on("drag",this.mousemove),this.on("release",this.mouseup),
!this.mouseAction)this.mouseAction=new i}else if(this.on("touch",this.touchstart),this.on("drag",this.touchmove),this.on("release",this.touchend),!this.touchAction)this.touchAction=new g;this.gameArea&&this.canvasPercentage&&(this.pushCleanup(c(window,"resize",this.resize),a),this.pushCleanup(c(window,"orientationchange",this.resize),a))},insideCanvas:function(b){return a(b,this.canvas)},mapToKey:function(a,b){this.keyActions[b]=a},addKeyAction:function(a,b){var c=new d;if(b)c.behavior=c.statics.DETECT_INITAL_PRESS_ONLY;
this.mapToKey(c,a);return c},mouseUp:function(a){this.mouseup(a)},mouseup:function(a){this.mouseAction.release(this.normalizePoint(a.gesture.touches[0]))},mouseDown:function(a){this.mousedown(a)},mousedown:function(a){this.mouseAction.release(null);a=this.normalizePoint(a.gesture.touches[0]);this.mouseAction.insideCanvas=this.insideCanvas(a);this.mouseAction.press(a)},mouseMove:function(a){this.mousemove(a)},mousemove:function(a){this.mouseAction.position=this.normalizePoint(a.gesture?a.gesture.touches[0]:
a)},touchStart:function(a){this.touchstart(a)},touchstart:function(a){this.touchAction.release(null);a=o.map(a.gesture.touches,this.normalizePoint);this.touchAction.insideCanvas=o.some(a,this.insideCanvas);this.touchAction.press(a)},touchEnd:function(a){this.touchend(a)},touchend:function(a){this.touchAction.release(o.map(a.gesture.touches,this.normalizePoint))},touchMove:function(a){this.touchmove(a)},touchmove:function(a){this.touchAction.positions=o.map(a.gesture.touches,this.normalizePoint);this.touchAction.startPositions&&
a.preventDefault()},getKeyAction:function(a){return this.keyActions?this.keyActions[a.keyCode]||this.keyActions[String.fromCharCode(a.keyCode)]:null},keyPressed:function(a){this.keydown(a)},keyDown:function(a){this.keydown(a)},keydown:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyReleased:function(a){this.keyup(a)},keyup:function(a){(a=this.getKeyAction(a))&&a.release()},getMouseLoc:function(a){return this.normalizePoint(a)},normalizePoint:function(a){var b,c;c=this.canvas.getBoundingClientRect();
b=c.left;c=c.top;return this.zoomRatio?{x:Math.round((a.clientX-b)/this.zoomRatio),y:Math.round((a.clientY-c)/this.zoomRatio)}:{x:Math.round(a.clientX-b),y:Math.round(a.clientY-c)}},resize:function(){var a,b;if(this.gameArea&&this.canvasPercentage&&this.canvas){var c=this.canvas.width,d=this.canvas.height,e=window.getComputedStyle(document.body,null)||{};a=parseFloat(e.marginLeft)||0;var g=parseFloat(e.marginTop)||0;b=parseFloat(e.marginRight)||0;e=parseFloat(e.marginBottom)||0;a+=b;b=g+e;g=window.innerWidth-
a;a=window.innerHeight-b;d=c/d;e=b="";g/a>d?(g=a*d,b=g+"px",e=a+"px"):(b=g+"px",e=Math.round(g/d)+"px");this.zoomRatio=g/c*this.canvasPercentage;this.gameArea.style.width=b;this.gameArea.style.height=e;c=Math.floor(100*this.canvasPercentage)+"%";this.canvas.style.width=c;this.canvas.style.height=c;this.canvas.style.display="block";this.canvas.style.marginLeft="auto";this.canvas.style.marginRight="auto"}}})})},"frozen/GameAction":function(){define(["dcl","dcl/bases/Mixer"],function(d,i){return d(i,
{name:null,behavior:0,amount:0,state:0,statics:{NORMAL:0,DETECT_INITAL_PRESS_ONLY:1,STATE_RELEASED:0,STATE_PRESSED:1,STATE_WAITING_FOR_RELEASE:2,STATE_MOVED:3},constructor:function(){this.reset()},reset:function(){this.state=this.statics.STATE_RELEASED;this.amount=0},tap:function(){this.press();this.release()},press:function(){this.state=this.statics.STATE_PRESSED;this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY&&this.pressAmt(1)},pressAmt:function(d){if(this.state!==this.statics.STATE_WAITING_FOR_RELEASE)this.amount+=
d,this.state=this.statics.STATE_WAITING_FOR_RELEASE},release:function(){this.state=this.statics.STATE_RELEASED},isPressed:function(){return this.state===this.statics.STATE_PRESSED?!0:!1},getAmount:function(){var d=this.amount;if(0!==d)if(this.state===this.statics.STATE_RELEASED)this.amount=0;else if(this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY)this.state=this.statics.STATE_WAITING_FOR_RELEASE,this.amount=0;return d}})})},"frozen/MouseAction":function(){define(["dcl","./GameAction"],function(d,
i){return d(i,{startPosition:null,endPosition:null,position:null,insideCanvas:null,press:d.superCall(function(d){return function(a){this.position=this.startPosition=a;d.apply(this)}}),release:d.superCall(function(d){return function(a){this.endPosition=a;d.apply(this)}})})})},"frozen/TouchAction":function(){define(["dcl","./GameAction"],function(d,i){return d(i,{startPositions:null,endPositions:null,positions:null,insideCanvas:null,press:d.superCall(function(d){return function(a){this.positions=this.startPositions=
a;d.apply(this)}}),release:d.superCall(function(d){return function(a){this.endPositions=a;d.apply(this)}})})})},"frozen/utils/insideCanvas":function(){define(function(){return function(d,i){return 0>d.x||d.x>i.width||0>d.y||d.y>i.height?!1:!0}})},"dcl/mixins/Cleanup":function(){(function(d){"undefined"!=typeof define?define(["../dcl","./Destroyable"],d):"undefined"!=typeof module?module.exports=d(require("../dcl"),require("./Destroyable")):dclMixinsCleanup=d(dcl,dclMixinsDestroyable)})(function(d,
i){return d(i,{declaredClass:"dcl/mixins/Cleanup",constructor:function(){this.__cleanupStack=[]},pushCleanup:function(d,a){var h=a?function(){a(d)}:function(){d.destroy()};this.__cleanupStack.push(h);return h},popCleanup:function(d){if(d)return this.__cleanupStack.pop();this.__cleanupStack.pop()()},removeCleanup:function(d){for(var a=this.__cleanupStack.length-1;0<=a;--a)if(this.__cleanupStack[a]===d)return this.__cleanupStack.splice(a,1),!0},cleanup:function(){for(;this.__cleanupStack.length;)this.__cleanupStack.pop()()},
destroy:function(){this.cleanup()}})})},"dcl/mixins/Destroyable":function(){(function(d){"undefined"!=typeof define?define(["../dcl"],d):"undefined"!=typeof module?module.exports=d(require("../dcl")):dclMixinsDestroyable=d(dcl)})(function(d){var i=d(null,{declaredClass:"dcl/mixins/Destroyable"});d.chainBefore(i,"destroy");return i})},"hammer/hammer":function(){(function(d,i){function g(){if(!a.READY){a.event.determineEventTypes();for(var b in a.gestures)a.gestures.hasOwnProperty(b)&&a.detection.register(a.gestures[b]);
a.event.onTouch(a.DOCUMENT,a.EVENT_MOVE,a.detection.detect);a.event.onTouch(a.DOCUMENT,a.EVENT_END,a.detection.detect);a.READY=!0}}var a=function(b,c){return new a.Instance(b,c||{})};a.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};a.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled;a.HAS_TOUCHEVENTS="ontouchstart"in d;a.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;
a.NO_MOUSEEVENTS=a.HAS_TOUCHEVENTS&&navigator.userAgent.match(a.MOBILE_REGEX);a.EVENT_TYPES={};a.DIRECTION_DOWN="down";a.DIRECTION_LEFT="left";a.DIRECTION_UP="up";a.DIRECTION_RIGHT="right";a.POINTER_MOUSE="mouse";a.POINTER_TOUCH="touch";a.POINTER_PEN="pen";a.EVENT_START="start";a.EVENT_MOVE="move";a.EVENT_END="end";a.DOCUMENT=document;a.plugins={};a.READY=!1;a.Instance=function(b,c){var d=this;g();this.element=b;this.enabled=!0;this.options=a.utils.extend(a.utils.extend({},a.defaults),c||{});this.options.stop_browser_behavior&&
a.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior);a.event.onTouch(b,a.EVENT_START,function(b){d.enabled&&a.detection.startDetect(d,b)});return this};a.Instance.prototype={on:function(a,c){for(var d=a.split(" "),e=0;e<d.length;e++)this.element.addEventListener(d[e],c,!1);return this},off:function(a,c){for(var d=a.split(" "),e=0;e<d.length;e++)this.element.removeEventListener(d[e],c,!1);return this},trigger:function(b,c){var d=a.DOCUMENT.createEvent("Event");d.initEvent(b,
!0,!0);d.gesture=c;var e=this.element;if(a.utils.hasParent(c.target,e))e=c.target;e.dispatchEvent(d);return this},enable:function(a){this.enabled=a;return this}};var h=null,l=!1,j=!1;a.event={bindDom:function(a,c,d){for(var c=c.split(" "),e=0;e<c.length;e++)a.addEventListener(c[e],d,!1)},onTouch:function(b,c,d){var e=this;this.bindDom(b,a.EVENT_TYPES[c],function(f){var g=f.type.toLowerCase();if(!g.match(/mouse/)||!j){g.match(/touch/)||g.match(/pointerdown/)||g.match(/mouse/)&&1===f.which?l=!0:g.match(/mouse/)&&
1!==f.which&&(l=!1);g.match(/touch|pointer/)&&(j=!0);var i=0;if(l){a.HAS_POINTEREVENTS&&c!=a.EVENT_END?i=a.PointerEvent.updatePointer(c,f):g.match(/touch/)?i=f.touches.length:j||(i=g.match(/up/)?0:1);if(0<i&&c==a.EVENT_END)c=a.EVENT_MOVE;else if(!i)c=a.EVENT_END;!i&&null!==h?f=h:h=f;d.call(a.detection,e.collectEventData(b,c,f));a.HAS_POINTEREVENTS&&c==a.EVENT_END&&(i=a.PointerEvent.updatePointer(c,f))}i||(h=null,j=l=!1,a.PointerEvent.reset())}})},determineEventTypes:function(){var b;b=a.HAS_POINTEREVENTS?
a.PointerEvent.getEvents():a.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];a.EVENT_TYPES[a.EVENT_START]=b[0];a.EVENT_TYPES[a.EVENT_MOVE]=b[1];a.EVENT_TYPES[a.EVENT_END]=b[2]},getTouchList:function(b){if(a.HAS_POINTEREVENTS)return a.PointerEvent.getTouchList();if(b.touches)return b.touches;b.indentifier=1;return[b]},collectEventData:function(b,c,d){var b=this.getTouchList(d,c),e=a.POINTER_TOUCH;if(d.type.match(/mouse/)||
a.PointerEvent.matchType(a.POINTER_MOUSE,d))e=a.POINTER_MOUSE;return{center:a.utils.getCenter(b),timeStamp:(new Date).getTime(),target:d.target,touches:b,eventType:c,pointerType:e,srcEvent:d,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation();this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return a.detection.stopDetect()}}}};a.PointerEvent={pointers:{},getTouchList:function(){var a=
this,c=[];Object.keys(a.pointers).sort().forEach(function(d){c.push(a.pointers[d])});return c},updatePointer:function(b,c){b==a.EVENT_END?this.pointers={}:(c.identifier=c.pointerId,this.pointers[c.pointerId]=c);return Object.keys(this.pointers).length},matchType:function(b,c){if(!c.pointerType)return!1;var d={};d[a.POINTER_MOUSE]=c.pointerType==c.MSPOINTER_TYPE_MOUSE||c.pointerType==a.POINTER_MOUSE;d[a.POINTER_TOUCH]=c.pointerType==c.MSPOINTER_TYPE_TOUCH||c.pointerType==a.POINTER_TOUCH;d[a.POINTER_PEN]=
c.pointerType==c.MSPOINTER_TYPE_PEN||c.pointerType==a.POINTER_PEN;return d[b]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};a.utils={extend:function(a,c,d){for(var e in c)a[e]!==i&&d||(a[e]=c[e]);return a},hasParent:function(a,c){for(;a;){if(a==c)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var c=[],d=[],e=0,f=a.length;e<f;e++)c.push(a[e].pageX),d.push(a[e].pageY);
return{pageX:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2,pageY:(Math.min.apply(Math,d)+Math.max.apply(Math,d))/2}},getVelocity:function(a,c,d){return{x:Math.abs(c/a)||0,y:Math.abs(d/a)||0}},getAngle:function(a,c){return 180*Math.atan2(c.pageY-a.pageY,c.pageX-a.pageX)/Math.PI},getDirection:function(b,c){var d=Math.abs(b.pageX-c.pageX),e=Math.abs(b.pageY-c.pageY);return d>=e?0<b.pageX-c.pageX?a.DIRECTION_LEFT:a.DIRECTION_RIGHT:0<b.pageY-c.pageY?a.DIRECTION_UP:a.DIRECTION_DOWN},getDistance:function(a,
c){var d=c.pageX-a.pageX,e=c.pageY-a.pageY;return Math.sqrt(d*d+e*e)},getScale:function(a,c){return 2<=a.length&&2<=c.length?this.getDistance(c[0],c[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,c){return 2<=a.length&&2<=c.length?this.getAngle(c[1],c[0])-this.getAngle(a[1],a[0]):0},isVertical:function(b){return b==a.DIRECTION_UP||b==a.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,c){var d,e="webkit,khtml,moz,ms,o,".split(",");if(c&&a.style){for(var f=0;f<e.length;f++)for(var g in c)c.hasOwnProperty(g)&&
(d=g,e[f]&&(d=e[f]+d.substring(0,1).toUpperCase()+d.substring(1)),a.style[d]=c[g]);if("none"==c.userSelect)a.onselectstart=function(){return!1}}}};a.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(b,c){if(!this.current)this.stopped=!1,this.current={inst:b,startEvent:a.utils.extend({},c),lastEvent:!1,name:""},this.detect(c)},detect:function(b){if(this.current&&!this.stopped){for(var b=this.extendEventData(b),c=this.current.inst.options,d=0,e=this.gestures.length;d<
e;d++){var f=this.gestures[d];if(!this.stopped&&!1!==c[f.name]&&!1===f.handler.call(f,b,this.current.inst)){this.stopDetect();break}}if(this.current)this.current.lastEvent=b;b.eventType==a.EVENT_END&&!b.touches.length-1&&this.stopDetect();return b}},stopDetect:function(){this.previous=a.utils.extend({},this.current);this.current=null;this.stopped=!0},extendEventData:function(b){var c=this.current.startEvent;if(c&&(b.touches.length!=c.touches.length||b.touches===c.touches)){c.touches=[];for(var d=
0,e=b.touches.length;d<e;d++)c.touches.push(a.utils.extend({},b.touches[d]))}var d=b.timeStamp-c.timeStamp,e=b.center.pageX-c.center.pageX,f=b.center.pageY-c.center.pageY,g=a.utils.getVelocity(d,e,f);a.utils.extend(b,{deltaTime:d,deltaX:e,deltaY:f,velocityX:g.x,velocityY:g.y,distance:a.utils.getDistance(c.center,b.center),angle:a.utils.getAngle(c.center,b.center),direction:a.utils.getDirection(c.center,b.center),scale:a.utils.getScale(c.touches,b.touches),rotation:a.utils.getRotation(c.touches,b.touches),
startEvent:c});return b},register:function(b){var c=b.defaults||{};c[b.name]===i&&(c[b.name]=!0);a.utils.extend(a.defaults,c,!0);b.index=b.index||1E3;this.gestures.push(b);this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0});return this.gestures}};a.gestures=a.gestures||{};a.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(b,c){switch(b.eventType){case a.EVENT_START:clearTimeout(this.timer);a.detection.current.name=
this.name;this.timer=setTimeout(function(){"hold"==a.detection.current.name&&c.trigger("hold",b)},c.options.hold_timeout);break;case a.EVENT_MOVE:b.distance>c.options.hold_threshold&&clearTimeout(this.timer);break;case a.EVENT_END:clearTimeout(this.timer)}}};a.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(b,c){if(b.eventType==a.EVENT_END){var d=a.detection.previous,e=!1;if(!(b.deltaTime>
c.options.tap_max_touchtime||b.distance>c.options.tap_max_distance))if(d&&"tap"==d.name&&b.timeStamp-d.lastEvent.timeStamp<c.options.doubletap_interval&&b.distance<c.options.doubletap_distance&&(c.trigger("doubletap",b),e=!0),!e||c.options.tap_always)a.detection.current.name="tap",c.trigger(a.detection.current.name,b)}}};a.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:0.7},handler:function(b,c){if(b.eventType==a.EVENT_END&&!(0<c.options.swipe_max_touches&&b.touches.length>
c.options.swipe_max_touches)&&(b.velocityX>c.options.swipe_velocity||b.velocityY>c.options.swipe_velocity))c.trigger(this.name,b),c.trigger(this.name+b.direction,b)}};a.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(b,c){if(a.detection.current.name!=this.name&&this.triggered)c.trigger(this.name+"end",b),
this.triggered=!1;else if(!(0<c.options.drag_max_touches&&b.touches.length>c.options.drag_max_touches))switch(b.eventType){case a.EVENT_START:this.triggered=!1;break;case a.EVENT_MOVE:if(b.distance<c.options.drag_min_distance&&a.detection.current.name!=this.name)break;if(a.detection.current.name!=this.name&&(a.detection.current.name=this.name,c.options.correct_for_drag_min_distance)){var d=Math.abs(c.options.drag_min_distance/b.distance);a.detection.current.startEvent.center.pageX+=b.deltaX*d;a.detection.current.startEvent.center.pageY+=
b.deltaY*d;b=a.detection.extendEventData(b)}if(a.detection.current.lastEvent.drag_locked_to_axis||c.options.drag_lock_to_axis&&c.options.drag_lock_min_distance<=b.distance)b.drag_locked_to_axis=!0;d=a.detection.current.lastEvent.direction;if(b.drag_locked_to_axis&&d!==b.direction)b.direction=a.utils.isVertical(d)?0>b.deltaY?a.DIRECTION_UP:a.DIRECTION_DOWN:0>b.deltaX?a.DIRECTION_LEFT:a.DIRECTION_RIGHT;if(!this.triggered)c.trigger(this.name+"start",b),this.triggered=!0;c.trigger(this.name,b);c.trigger(this.name+
b.direction,b);(c.options.drag_block_vertical&&a.utils.isVertical(b.direction)||c.options.drag_block_horizontal&&!a.utils.isVertical(b.direction))&&b.preventDefault();break;case a.EVENT_END:this.triggered&&c.trigger(this.name+"end",b),this.triggered=!1}}};a.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(b,c){if(a.detection.current.name!=this.name&&this.triggered)c.trigger(this.name+
"end",b),this.triggered=!1;else if(!(2>b.touches.length))switch(c.options.transform_always_block&&b.preventDefault(),b.eventType){case a.EVENT_START:this.triggered=!1;break;case a.EVENT_MOVE:var d=Math.abs(1-b.scale),e=Math.abs(b.rotation);if(d<c.options.transform_min_scale&&e<c.options.transform_min_rotation)break;a.detection.current.name=this.name;if(!this.triggered)c.trigger(this.name+"start",b),this.triggered=!0;c.trigger(this.name,b);e>c.options.transform_min_rotation&&c.trigger("rotate",b);
d>c.options.transform_min_scale&&(c.trigger("pinch",b),c.trigger("pinch"+(1>b.scale?"in":"out"),b));break;case a.EVENT_END:this.triggered&&c.trigger(this.name+"end",b),this.triggered=!1}}};a.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(b,c){c.options.prevent_mouseevents&&b.pointerType==a.POINTER_MOUSE?b.stopDetect():(c.options.prevent_default&&b.preventDefault(),b.eventType==a.EVENT_START&&c.trigger(this.name,b))}};a.gestures.Release=
{name:"release",index:Infinity,handler:function(b,c){b.eventType==a.EVENT_END&&c.trigger(this.name,b)}};"function"==typeof define&&"object"==typeof define.amd&&define.amd?(d.Hammer=a,define(function(){return a})):"object"===typeof module&&"object"===typeof module.exports?module.exports=a:d.Hammer=a})(this)},"dojo/domReady":function(){define(["./has"],function(){function d(a){l?a(g):j.push(a)}var i=this,g=document,a={loaded:1,complete:1},h="string"!=typeof g.readyState,l=!!a[g.readyState];if(h)g.readyState=
"loading";if(!l){var j=[],b=[],c=function(b){b=b||i.event;if(!(l||"readystatechange"==b.type&&!a[g.readyState])){l=1;if(h)g.readyState="complete";for(;j.length;)j.shift()(g)}},o=function(a,b){a.addEventListener(b,c,!1);j.push(function(){a.removeEventListener(b,c,!1)})};o(g,"DOMContentLoaded");o(i,"load");"onreadystatechange"in g?o(g,"readystatechange"):h||b.push(function(){return a[g.readyState]});if(b.length){var e=function(){if(!l){for(var a=b.length;a--;)if(b[a]()){c("poller");return}setTimeout(e,
30)}};e()}}d.load=function(a,b,c){d(c)};return d})},"frozen/shims/RAF":function(){define(function(){for(var d=0,i=["ms","moz","webkit","o"],g=0;g<i.length&&!window.requestAnimationFrame;++g)window.requestAnimationFrame=window[i[g]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[g]+"CancelAnimationFrame"]||window[i[g]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame)window.requestAnimationFrame=function(a){var g=(new Date).getTime(),i=Math.max(0,16-(g-d)),j=window.setTimeout(function(){a(g+
i)},i);d=g+i;return j};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(a){clearTimeout(a)}})},"frozen/box2d/Box":function(){define(["dcl","dcl/bases/Mixer","./listeners/Contact"],function(d,i,g){var a=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.b2BodyDef,l=Box2D.Dynamics.b2Body,j=Box2D.Dynamics.b2FixtureDef,b=Box2D.Dynamics.b2World,c=Box2D.Collision.Shapes.b2PolygonShape,o=Box2D.Collision.Shapes.b2CircleShape;return d(i,{intervalRate:60,adaptive:!1,bodiesMap:null,fixturesMap:null,
jointsMap:null,b2World:null,gravityX:0,gravityY:9.8,allowSleep:!0,resolveCollisions:!1,contactListener:null,collisions:null,scale:30,constructor:function(c){if(c&&c.intervalRate)this.intervalRate=parseInt(c.intervalRate,10);this.bodiesMap={};this.fixturesMap={};this.jointsMap={};this.b2World=new b(new a(this.gravityX,this.gravityY),this.allowSleep);if(this.resolveCollisions)this.contactListener=new g;this.contactListener&&this.addContactListener(this.contactListener)},update:function(a){this.contactListener&&
this.contactListener.reset&&this.contactListener.reset();var b=Date.now();a?this.b2World.Step(a/1E3,10,10):this.b2World.Step(this.adaptive?(b-this.lastTimestamp)/1E3:1/this.intervalRate,10,10);this.b2World.ClearForces();return Date.now()-b},getState:function(){for(var a={},b=this.b2World.GetBodyList();b;b=b.m_next)if(b.IsActive()&&"undefined"!==typeof b.GetUserData()&&null!==b.GetUserData()&&(a[b.GetUserData()]={x:b.GetPosition().x,y:b.GetPosition().y,angle:b.GetAngle(),center:{x:b.GetWorldCenter().x,
y:b.GetWorldCenter().y},linearVelocity:b.m_linearVelocity,angularVelocity:b.m_angularVelocity},this.contactListener&&this.contactListener.collisions))a[b.GetUserData()].collisions=this.contactListener.collisions[b.GetUserData()]||null;return a},updateExternalState:function(a){var b=this.getState(),c;for(c in b){var d=a[c];d&&!d.staticBody&&d.update(b[c])}},setBodies:function(a){for(var b in a)this.addBody(a[b]);this.ready=!0},addBody:function(b){if(!b.alreadyScaled)b.scaleShape(1/this.scale),b.scale=
this.scale;var d=new h,g=new j,i,r,u,m;g.restitution=b.restitution;g.density=b.density;g.friction=b.friction;g.isSensor=b.sensor||!1;if(null!=b.maskBits)g.filter.maskBits=b.maskBits;if(null!=b.categoryBits)g.filter.categoryBits=b.categoryBits;if(null!=b.groupIndex)g.filter.groupIndex=b.groupIndex;d.type=b.staticBody?l.b2_staticBody:l.b2_dynamicBody;d.position.x=b.x;d.position.y=b.y;d.userData=b.id;d.angle=b.angle;d.linearDamping=b.linearDamping;b.fixedRotation?d.fixedRotation=!0:d.angularDamping=
b.angularDamping;var q=this.b2World.CreateBody(d);if(b.radius)g.shape=new o(b.radius),q.CreateFixture(g);else if(b.points){r=[];for(d=0;d<b.points.length;d++)u=new a,u.Set(b.points[d].x,b.points[d].y),r[d]=u;g.shape=new c;g.shape.SetAsArray(r,r.length);q.CreateFixture(g)}else if(b.polys)for(i=0;i<b.polys.length;i++){r=b.polys[i];m=[];for(d=0;d<r.length;d++)u=new a,u.Set(r[d].x,r[d].y),m[d]=u;g.shape=new c;g.shape.SetAsArray(m,m.length);q.CreateFixture(g)}else g.shape=new c,g.shape.SetAsBox(b.halfWidth,
b.halfHeight),q.CreateFixture(g);this.bodiesMap[b.id]=q},setPosition:function(b,c,d){this.bodiesMap[b].SetPosition(new a(c,d))},setAngle:function(a,b){this.bodiesMap[a].SetAngle(b)},setLinearVelocity:function(b,c,d){this.bodiesMap[b].SetLinearVelocity(new a(c,d))},setAngularVelocity:function(a,b){this.bodiesMap[a].SetAngularVelocity(b)},applyImpulseDegrees:function(b,c,d){b=this.bodiesMap[b];b.ApplyImpulse(new a(Math.sin(c*(Math.PI/180))*d,-1*Math.cos(c*(Math.PI/180))*d),b.GetWorldCenter())},applyForceDegrees:function(b,
c,d){b=this.bodiesMap[b];b.ApplyForce(new a(Math.sin(c*(Math.PI/180))*d,-1*Math.cos(c*(Math.PI/180))*d),b.GetWorldCenter())},applyImpulse:function(b,c,d){b=this.bodiesMap[b];b.ApplyImpulse(new a(Math.sin(c)*d,-1*Math.cos(c)*d),b.GetWorldCenter())},applyForce:function(b,c,d){b=this.bodiesMap[b];b.ApplyForce(new a(Math.sin(c)*d,-1*Math.cos(c)*d),b.GetWorldCenter())},applyTorque:function(a,b){this.bodiesMap[a].ApplyTorque(b)},setGravity:function(b){this.b2World.SetGravity(new a(b.x,b.y))},removeBody:function(a){this.bodiesMap[a]&&
(this.fixturesMap[a]&&this.bodiesMap[a].DestroyFixture(this.fixturesMap[a]),this.b2World.DestroyBody(this.bodiesMap[a]),delete this.bodiesMap[a])},wakeUpBody:function(a){this.bodiesMap[a]&&this.bodiesMap[a].SetAwake(!0)},addContactListener:function(a){var b=new Box2D.Dynamics.b2ContactListener;if(a.beginContact)b.BeginContact=function(b){a.beginContact(b.m_fixtureA.m_body.m_userData,b.m_fixtureB.m_body.m_userData,b)};if(a.endContact)b.EndContact=function(b){a.endContact(b.m_fixtureA.m_body.m_userData,
b.m_fixtureB.m_body.m_userData,b)};if(a.preSolve)b.PreSolve=function(b,c){a.preSolve(b.m_fixtureA.m_body.m_userData,b.m_fixtureB.m_body.m_userData,c,b)};if(a.postSolve)b.PostSolve=function(b,c){a.postSolve(b.m_fixtureA.m_body.m_userData,b.m_fixtureB.m_body.m_userData,c,b)};this.b2World.SetContactListener(b)},removeJoint:function(a){this.jointsMap[a]&&(this.b2World.DestroyJoint(this.jointsMap[a]),delete this.jointsMap[a])},addJoint:function(a){if(a&&a.id&&!this.jointsMap[a.id]){if(!a.alreadyScaled&&
a.scaleJointLocation)a.scaleJointLocation(1/this.scale),a.scale=this.scale;var b=a.createB2Joint(this);b&&(this.jointsMap[a.id]=b)}}})})},"frozen/box2d/listeners/Contact":function(){define(["dcl","dcl/bases/Mixer"],function(d,i){return d(i,{declaredClass:"frozen/box2d/listeners/Contact",constructor:function(){this.collisions=this.collisions||{}},collisions:null,reset:function(){this.collisions={}},postSolve:function(d,a,h){this.collisions[d]=this.collisions[d]||[];this.collisions[d].push({id:a,impulse:h.normalImpulses[0]});
this.collisions[a]=this.collisions[a]||[];this.collisions[a].push({id:d,impulse:h.normalImpulses[0]})}})})}}});(function(){require({cache:{}});require.boot&&require.apply(null,require.boot)})();