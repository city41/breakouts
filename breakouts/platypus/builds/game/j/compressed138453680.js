(function(){var a={};platypus=this.platypus||{};platypus.breakout=a;a.settings={global:{initialScene:"load",fps:60,rootElement:"root",aspectRatio:0.7692307692307693,nativeAssetResolution:320,resizeFont:true},aspects:[{ogg:["firefox","opera","chrome"],m4aCombined:["android","silk","ipod","ipad","iphone"],mp3:["msie","safari"]}],assets:{death:{id:"death",src:{ogg:"a/brickDeath.ogg",mp3:"a/brickDeath.mp3",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:2050,length:190}}}},blip:{id:"blip",src:{ogg:"a/countdownBlip.ogg",mp3:"a/countdownBlip.mp3",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:3050,length:160}}}},down:{id:"down",src:{ogg:"a/powerdown.ogg",mp3:"a/powerdown.mp3",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:4050,length:270}}}},up:{id:"up",src:{ogg:"a/powerup.ogg",mp3:"a/powerup.mp3",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:5050,length:440}}}},recover:{id:"recover",src:{ogg:"a/recover.ogg",mp3:"a/recover.mp3",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:6050,length:400}}}},logo:{id:"logo",src:"i/logo.png"},title:{id:"title",src:"i/bg_prerendered.png"},tiles:{id:"tiles",src:"i/tiles.png",data:{rows:9,columns:12}}},includes:{CreateJS:{id:"CreateJS",src:"http://code.createjs.com/createjs-2013.02.12.min.js"},Browser:{id:"Browser",src:"../engine/browser.js"},Main:{id:"Main",src:"../engine/main.js"},MainCSS:{id:"MainCSS",src:"../game/css/main.css"},GameCSS:{id:"GameCSS",src:"../game/css/game.css"},FullScreenCSS:{id:"FullScreenCSS",src:"../game/css/fullscreen.css"}},classes:{Game:{id:"Game",src:"../engine/game.js"},ComponentFactory:{id:"ComponentFactory",src:"../engine/factory.js"},Entity:{id:"Entity",src:"../engine/entity.js"},Scene:{id:"Scene",src:"../engine/scene.js"},"Collision-Shape":{id:"Collision-Shape",src:"../engine/collision-shape.js"},"Collision-Data-Container":{id:"Collision-Data-Container",src:"../engine/collision-data-container.js"},AABB:{id:"AABB",src:"../engine/aabb.js"},Vector2D:{id:"Vector2D",src:"../engine/vector2D.js"}},components:{"asset-loader":{id:"asset-loader",src:"../engine/components/asset-loader.js"},"enable-ios-audio":{id:"enable-ios-audio",src:"../engine/components/enable-ios-audio.js"},"handler-collision":{id:"handler-collision",src:"../engine/components/handler-collision.js"},"handler-controller":{id:"handler-controller",src:"../engine/components/handler-controller.js"},"tiled-loader":{id:"tiled-loader",src:"../engine/components/tiled-loader.js"},"handler-render-createjs":{id:"handler-render-createjs",src:"../engine/components/handler-render-createjs.js"},"handler-render-dom":{id:"handler-render-dom",src:"../engine/components/handler-render-dom.js"},"handler-ai":{id:"handler-ai",src:"../engine/components/handler-ai.js"},"handler-logic":{id:"handler-logic",src:"../engine/components/handler-logic.js"},camera:{id:"camera",src:"../engine/components/camera.js"},"collision-group":{id:"collision-group",src:"../engine/components/collision-group.js"},audio:{id:"audio",src:"../engine/components/audio.js"},"broadcast-events":{id:"broadcast-events",src:"../engine/components/broadcast-events.js"},"change-scene":{id:"change-scene",src:"../engine/components/change-scene.js"},"dom-element":{id:"dom-element",src:"../engine/components/dom-element.js"},"entity-container":{id:"entity-container",src:"../engine/components/entity-container.js"},"entity-controller":{id:"entity-controller",src:"../engine/components/entity-controller.js"},fullscreen:{id:"fullscreen",src:"../engine/components/fullscreen.js"},"random-events":{id:"random-events",src:"../engine/components/random-events.js"},"render-debug":{id:"render-debug",src:"../engine/components/render-debug.js"},"render-tiles":{id:"render-tiles",src:"../engine/components/render-tiles.js"},"render-animation":{id:"render-animation",src:"../engine/components/render-animation.js"},"render-image":{id:"render-image",src:"../engine/components/render-image.js"},"logic-button":{id:"logic-button",src:"../engine/components/logic-button.js"},"logic-delay-message":{id:"logic-delay-message",src:"../engine/components/logic-delay-message.js"},"logic-destroy-me":{id:"logic-destroy-me",src:"../engine/components/logic-destroy-me.js"},"logic-directional-movement":{id:"logic-directional-movement",src:"../engine/components/logic-directional-movement.js"},"logic-gravity":{id:"logic-gravity",src:"../engine/components/logic-gravity.js"},"logic-rebounder":{id:"logic-rebounder",src:"../engine/components/logic-rebounder.js"},"logic-state-machine":{id:"logic-state-machine",src:"../engine/components/logic-state-machine.js"},"component-switcher":{id:"component-switcher",src:"../engine/components/component-switcher.js"},"render-destroy-me":{id:"render-destroy-me",src:"../engine/components/render-destroy-me.js"},"entity-linker":{id:"entity-linker",src:"../engine/components/entity-linker.js"},"logic-spawner":{id:"logic-spawner",src:"../engine/components/logic-spawner.js"},"logic-portal":{id:"logic-portal",src:"../engine/components/logic-portal.js"},"collision-basic":{id:"collision-basic",src:"../engine/components/collision-basic.js"},"collision-tiles":{id:"collision-tiles",src:"../engine/components/collision-tiles.js"},"logic-paddle":{id:"logic-paddle",src:"../game/components/logic-paddle.js"}},entities:{"action-layer":{id:"action-layer",components:[{type:"handler-controller"},{type:"handler-ai"},{type:"handler-logic"},{type:"handler-collision"},{type:"camera",width:320},{type:"handler-render-createjs",acceptInput:{touch:true,click:true,camera:true}},{type:"entity-container",childEvents:["mousemove","link-entity","scene-live"]},{type:"tiled-loader",images:["tiles"],entityPositionX:"left",entityPositionY:"center"}]},"desktop-interface-layer":{id:"desktop-interface-layer",components:[{type:"entity-container",entities:[{type:"score-keeper"}],childEvents:["link-entity"]}]},"multitouch-interface-layer":{id:"multitouch-interface-layer",filter:{includes:["mobile","multitouch"]},components:[{type:"handler-logic"},{type:"handler-render-dom"},{type:"entity-container",entities:[{type:"button-fullscreen"},{type:"score-keeper"}],childEvents:["link-entity"]}]},"touch-interface-layer":{id:"touch-interface-layer",filter:{includes:["mobile","touch"],excludes:["multitouch"]},components:[{type:"handler-logic"},{type:"handler-render-dom"},{type:"entity-container",entities:[{type:"button-fullscreen"},{type:"button-jump-left"},{type:"button-jump-right"},{type:"button-jump",properties:{className:"game-button jump-center-button"}},{type:"button-left"},{type:"button-right"},{type:"gui"},{type:"fps-counter"}],childEvents:["time-elapsed"]}]},"tile-layer":{id:"tile-layer",components:[{type:"render-tiles",spriteSheet:"import",imageMap:"import"},{type:"collision-tiles",collisionMap:"import"}]},"render-layer":{id:"render-layer",components:[{type:"render-tiles",spriteSheet:"import",imageMap:"import"}]},"collision-layer":{id:"collision-layer",components:[{type:"collision-tiles",collisionMap:"import"}]},"button-fullscreen":{id:"button-fullscreen",components:[{type:"dom-element",parent:"root",className:"button-fullscreen",onmouseup:"toggle-fullscreen",ontouchend:"toggle-fullscreen"},{type:"fullscreen"}]},"ball-killer":{id:"ball-killer",components:[{type:"collision-basic",collisionType:"davey-jones-locker",immobile:true}],properties:{}},"button-jump-left":{id:"button-jump-left",components:[{type:"dom-element",element:"div",className:"game-button jump-left-button",onmousedown:"start-jump",ontouchstart:"start-jump",onmouseup:"stop-jump",ontouchend:"stop-jump",ontouchcancel:"stop-jump"},{type:"broadcast-events",events:{"start-jump":["button-jump:down","button-left:down"],"stop-jump":["button-jump:up","button-left:up"]}}]},"button-jump-right":{id:"button-jump-right",components:[{type:"dom-element",element:"div",className:"game-button jump-right-button",onmousedown:"start-jump",ontouchstart:"start-jump",onmouseup:"stop-jump",ontouchend:"stop-jump",ontouchcancel:"stop-jump"},{type:"broadcast-events",events:{"start-jump":["button-jump:down","button-right:down"],"stop-jump":["button-jump:up","button-right:up"]}}]},"end-game":{id:"end-game",components:[{type:"dom-element",innerHTML:"Game Over",className:"menu-button",onmouseup:"new-scene",ontouchend:"new-scene"},{type:"change-scene",scene:"menu"}]},"button-play-game":{id:"button-play-game",components:[{type:"dom-element",innerHTML:"tap to start<br /><br /><br />during the game: use L/R arrow keys to skip levels",className:"menu-button",onmouseup:"new-scene",ontouchend:"new-scene"},{type:"change-scene",scene:"scene-level-0",transition:"fade-to-black"}]},"score-keeper":{id:"score-keeper",components:[{type:"dom-element",id:"score-keeper"},{type:"dom-element",parent:"score-keeper",className:"lives",innerHTML:"lives: 3",aliases:{"change-lives":"update-content"}},{type:"dom-element",parent:"score-keeper",className:"score",innerHTML:"score: 0",aliases:{"change-score":"update-content"}},{type:"dom-element",parent:"score-keeper",className:"level",innerHTML:"level: 1",aliases:{"change-level":"update-content"}},{type:"dom-element",className:"countdown",updateClassName:true},{type:"logic-state-machine",inputs:{"countdown-3":{"on-3":true,"on-0":false},"countdown-2":{"on-2":true,"on-3":false},"countdown-1":{"on-1":true,"on-2":false},"countdown-0":{"on-0":true,"on-1":false}}},{type:"entity-linker",linkId:"paddle"}]},"brick-blue":{id:"brick-blue",components:[{type:"collision-basic",collisionType:"brick",immobile:true,solidCollisions:{ball:"dying"},aliases:{dying:"collide-off"}},{type:"random-events",events:{dying:["launch-minus","launch-plus","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing"]}},{type:"logic-spawner",spawneeClass:"pill-plus",speed:0.08,offsetX:16,aliases:{"launch-plus":"spawn"}},{type:"logic-spawner",spawneeClass:"pill-minus",speed:0.08,offsetX:16,aliases:{"launch-minus":"spawn"}},{type:"render-animation",spriteSheet:{images:["tiles"],frames:{width:32,height:16,regY:8,regX:0},animations:{"fading-out":{frames:[1,1,2,2,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5]},stationary:{frames:[0]},"default":{frames:[4,3,2,1,0],next:"stationary"}}}},{type:"logic-state-machine",inputs:{load:{bottom:true},dying:{"fading-out":true}}},{type:"audio",audioMap:{dying:"death"}},{type:"render-destroy-me",animationId:"fading-out"}],properties:{width:32,height:16}},"progress-bar":{id:"progress-bar",components:[{type:"dom-element",element:"div",className:"progress-bar",innerHTML:"Loading..."},{type:"entity-container",entities:[{id:"container",components:[{type:"change-scene",scene:"menu",message:"complete"},{type:"asset-loader",useXHR:false}]}]}]},"brick-orange":{id:"brick-orange",components:[{type:"collision-basic",collisionType:"brick",immobile:true,solidCollisions:{ball:"dying"},aliases:{dying:"collide-off"}},{type:"random-events",events:{dying:["launch-minus","launch-plus","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing"]}},{type:"logic-spawner",spawneeClass:"pill-plus",speed:0.08,offsetX:16,aliases:{"launch-plus":"spawn"}},{type:"logic-spawner",spawneeClass:"pill-minus",speed:0.08,offsetX:16,aliases:{"launch-minus":"spawn"}},{type:"render-animation",spriteSheet:{images:["tiles"],frames:{width:32,height:16,regY:8,regX:0},animations:{"fading-out":{frames:[7,7,8,8,9,9,10,10,5,5,5,5,5,5,5,5,5,5,5,5,5]},stationary:{frames:[6]},"default":{frames:[10,9,8,7,6],next:"stationary"}}}},{type:"logic-state-machine",inputs:{load:{bottom:true},dying:{"fading-out":true}}},{type:"audio",audioMap:{dying:"death"}},{type:"render-destroy-me",animationId:"fading-out"}],properties:{width:32,height:16}},"title-screen":{id:"title-screen",components:[{type:"dom-element",className:"title-screen"},{type:"dom-element",className:"logo"}]},"brick-red":{id:"brick-red",components:[{type:"collision-basic",collisionType:"brick",immobile:true,solidCollisions:{ball:"dying"},aliases:{dying:"collide-off"}},{type:"random-events",events:{dying:["launch-minus","launch-plus","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing"]}},{type:"logic-spawner",spawneeClass:"pill-plus",speed:0.08,offsetX:16,aliases:{"launch-plus":"spawn"}},{type:"logic-spawner",spawneeClass:"pill-minus",speed:0.08,offsetX:16,aliases:{"launch-minus":"spawn"}},{type:"render-animation",spriteSheet:{images:["tiles"],frames:{width:32,height:16,regY:8,regX:0},animations:{"fading-out":{frames:[13,13,14,14,15,15,16,16,5,5,5,5,5,5,5,5,5,5,5,5,5]},stationary:{frames:[12]},"default":{frames:[16,15,14,13,12],next:"stationary"}}}},{type:"logic-state-machine",inputs:{load:{bottom:true},dying:{"fading-out":true}}},{type:"audio",audioMap:{dying:"death"}},{type:"render-destroy-me",animationId:"fading-out"}],properties:{width:32,height:16}},"brick-green":{id:"brick-green",components:[{type:"collision-basic",collisionType:"brick",immobile:true,solidCollisions:{ball:"dying"},aliases:{dying:"collide-off"}},{type:"random-events",events:{dying:["launch-minus","launch-plus","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing","do-nothing"]}},{type:"logic-spawner",spawneeClass:"pill-plus",speed:0.08,offsetX:16,aliases:{"launch-plus":"spawn"}},{type:"logic-spawner",spawneeClass:"pill-minus",speed:0.08,offsetX:16,aliases:{"launch-minus":"spawn"}},{type:"render-animation",spriteSheet:{images:["tiles"],frames:{width:32,height:16,regY:8,regX:0},animations:{"fading-out":{frames:[19,19,20,20,21,21,22,22,5,5,5,5,5,5,5,5,5,5,5,5,5]},stationary:{frames:[18]},"default":{frames:[22,21,20,19,18],next:"stationary"}}}},{type:"logic-state-machine",inputs:{load:{bottom:true},dying:{"fading-out":true}}},{type:"audio",audioMap:{dying:"death"}},{type:"render-destroy-me",animationId:"fading-out"}],properties:{width:32,height:16}},ball:{id:"ball",components:[{type:"collision-basic",collisionType:"ball",bullet:true,solidCollisions:{paddle:"",brick:["hit-static","score!"],tiles:"hit-static"},softCollisions:{"davey-jones-locker":"destroy-me"},shapeType:"circle"},{type:"logic-rebounder",elasticity:1},{type:"entity-linker",linkId:"paddle",events:{"score!":"tally","destroy-me":"lose-ball"}},{type:"logic-destroy-me"},{type:"render-animation",spriteSheet:{images:["tiles"],frames:{width:16,height:16,regY:8,regX:8},animations:{"default":{frames:[51,51,51,51,52,52,52,52,53,53,53,53,54,54,54,54,55,55,55,55]}}}}],properties:{radius:7}},"ball-spawner":{id:"ball-spawner",components:[{type:"logic-spawner",spawneeClass:"ball",speed:0.16},{type:"entity-linker",linkId:"paddle"}],properties:{state:{bottom:true,right:true}}},paddle:{id:"paddle",components:[{type:"component-switcher",componentMap:{minify:{remove:["collision-basic","render-image"],add:[{type:"collision-basic",collisionType:"paddle",shapes:[{type:"rectangle",offsetX:16,width:32,height:16}],softCollisions:{"power-up":"new-ball"},solidCollisions:{ball:"ball-collision"}},{type:"render-image",image:"tiles",source:{width:32,height:16,y:80,x:0},regX:0,regY:8}]},maxify:{remove:["collision-basic","render-image"],add:[{type:"collision-basic",collisionType:"paddle",shapes:[{type:"rectangle",offsetX:24,width:48,height:16}],softCollisions:{"power-up":"new-ball","power-down":"minify"},solidCollisions:{ball:"ball-collision"}},{type:"render-image",image:"tiles",source:{width:48,height:16,y:64,x:0},regX:0,regY:8}]}}},{type:"entity-controller",controlMap:{"key:left-arrow":"prev-level","key:right-arrow":"next-level"}},{type:"render-image",image:"tiles",source:{width:48,height:16,y:64,x:0},regX:0,regY:8},{type:"logic-paddle"},{type:"logic-delay-message",events:{minify:{event:"maxify",delay:"10000"},"scene-live":{event:"time-2",delay:"1000"},"time-2":{event:"time-1",delay:"1000"},"time-1":{event:"time-0",delay:"1000"}}},{type:"audio",audioMap:{minify:"down",maxify:"recover","new-ball":"up","scene-live":"blip","time-2":"blip","time-1":"blip"}},{type:"entity-linker",linkId:"paddle",events:{"update-lives":"change-lives","update-score":"change-score","update-level":"change-level","new-ball":"spawn","scene-live":"countdown-3","time-2":"countdown-2","time-1":"countdown-1","time-0":["spawn","countdown-0"]}},{type:"change-scene"}],properties:{width:48,height:16,state:{top:true}}},"pill-minus":{id:"pill-minus",components:[{type:"collision-basic",collisionType:"power-down",softCollisions:{paddle:"destroy-me","davey-jones-locker":"destroy-me"}},{type:"render-image",image:"tiles",source:{width:16,height:16,y:96,x:112},regX:8,regY:8},{type:"logic-destroy-me"}],properties:{width:16,height:16,z:1}},"pill-plus":{id:"pill-plus",components:[{type:"collision-basic",collisionType:"power-up",softCollisions:{paddle:"destroy-me","davey-jones-locker":"destroy-me"}},{type:"render-image",image:"tiles",source:{width:16,height:16,y:96,x:96},regX:8,regY:8},{type:"logic-destroy-me"}],properties:{width:16,height:16,z:1}}},scenes:{load:{layers:[{id:"load-layer",components:[{type:"handler-logic"},{type:"handler-render-dom"},{type:"entity-container",entities:[{type:"title-screen"},{type:"progress-bar"}],childEvents:["link-entity"]}]}],id:"load"},menu:{layers:[{id:"menu-layer",components:[{type:"handler-logic"},{type:"handler-render-dom"},{type:"handler-controller"},{type:"entity-container",entities:[{type:"title-screen"},{type:"button-play-game"}]}]},{id:"enable-ios-audio-layer",filter:{includes:["iOS"]},components:[{type:"enable-ios-audio",audioId:"combined"}]}],id:"menu"},"scene-level-0":{layers:[{type:"action-layer",properties:{level:"level0"}},{type:"multitouch-interface-layer"},{type:"touch-interface-layer"},{type:"desktop-interface-layer"}],id:"scene-level-0"},"scene-level-1":{layers:[{type:"action-layer",properties:{level:"level1"}},{type:"multitouch-interface-layer"},{type:"touch-interface-layer"},{type:"desktop-interface-layer"}],id:"scene-level-1"},"scene-level-2":{layers:[{type:"action-layer",properties:{level:"level2"}},{type:"multitouch-interface-layer"},{type:"touch-interface-layer"},{type:"desktop-interface-layer"}],id:"scene-level-2"},"scene-level-3":{layers:[{type:"action-layer",properties:{level:"level3"}},{type:"multitouch-interface-layer"},{type:"touch-interface-layer"},{type:"desktop-interface-layer"}],id:"scene-level-3"},end:{layers:[{id:"menu-layer",components:[{type:"handler-logic"},{type:"handler-render-dom"},{type:"handler-controller"},{type:"entity-container",entities:[{type:"title-screen"},{type:"end-game"}]}]}],id:"end"}},levels:{level0:{height:26,layers:[{data:[60,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,48,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96],height:26,name:"background",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{data:[80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80],height:26,name:"collision",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{color:"#ff00ff",height:26,name:"Objects",objects:[{height:16,name:"paddle",properties:{},type:"",visible:true,width:48,x:80,y:368},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:96},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:96},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:80},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:96},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:80},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:96},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:80},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:96},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:96},{height:32,name:"ball-killer",properties:{},type:"",visible:true,width:384,x:-32,y:432},{gid:52,height:0,name:"",properties:{},type:"",visible:true,width:0,x:64,y:272},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:320,y:304},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:-32,y:304}],opacity:1,type:"objectgroup",visible:true,width:20,x:0,y:0}],orientation:"orthogonal",properties:{name:"lets begin"},tileheight:16,tilesets:[{firstgid:1,image:"../game/images/tiles.png",imageheight:144,imagewidth:192,margin:0,name:"tiles",properties:{},spacing:0,tileheight:16,tileproperties:{"0":{entity:"brick-blue"},"12":{entity:"brick-orange"},"24":{entity:"brick-red"},"36":{entity:"brick-green"},"51":{entity:"ball-spawner"},"79":{entity:"paddle-blocker"}},tilewidth:16}],tilewidth:16,version:1,width:20,id:"level0"},level1:{height:26,layers:[{data:[60,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,48,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96],height:26,name:"background",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{data:[80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80],height:26,name:"collision",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{color:"#ff00ff",height:26,name:"Objects",objects:[{height:16,name:"paddle",properties:{},type:"",visible:true,width:48,x:80,y:368},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:80},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:80},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:80},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:80},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:80},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:144},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:160},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:160},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:160},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:160},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:144},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:160},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:112},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:128},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:144},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:112},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:128},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:144},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:112},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:112},{gid:52,height:0,name:"",properties:{},type:"",visible:true,width:0,x:64,y:272},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:-32,y:304},{height:32,name:"ball-killer",properties:{},type:"",visible:true,width:384,x:-32,y:432},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:320,y:304}],opacity:1,type:"objectgroup",visible:true,width:20,x:0,y:0}],orientation:"orthogonal",properties:{name:"lets begin"},tileheight:16,tilesets:[{firstgid:1,image:"../game/images/tiles.png",imageheight:144,imagewidth:192,margin:0,name:"tiles",properties:{},spacing:0,tileheight:16,tileproperties:{"0":{entity:"brick-blue"},"12":{entity:"brick-orange"},"24":{entity:"brick-red"},"36":{entity:"brick-green"},"51":{entity:"ball-spawner"},"79":{entity:"paddle-blocker"}},tilewidth:16}],tilewidth:16,version:1,width:20,id:"level1"},level2:{height:26,layers:[{data:[60,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,48,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96],height:26,name:"background",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{data:[80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80],height:26,name:"collision",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{color:"#ff00ff",height:26,name:"Objects",objects:[{height:16,name:"paddle",properties:{},type:"",visible:true,width:48,x:80,y:368},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:80},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:80},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:80},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:144},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:144},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:96},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:112},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:128},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:112},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:112},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:160},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:160},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:160},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:160},{gid:52,height:0,name:"",properties:{},type:"",visible:true,width:0,x:64,y:272},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:-32,y:304},{height:32,name:"ball-killer",properties:{},type:"",visible:true,width:384,x:-32,y:432},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:320,y:304}],opacity:1,type:"objectgroup",visible:true,width:20,x:0,y:0}],orientation:"orthogonal",properties:{name:"lets begin"},tileheight:16,tilesets:[{firstgid:1,image:"../game/images/tiles.png",imageheight:144,imagewidth:192,margin:0,name:"tiles",properties:{},spacing:0,tileheight:16,tileproperties:{"0":{entity:"brick-blue"},"12":{entity:"brick-orange"},"24":{entity:"brick-red"},"36":{entity:"brick-green"},"51":{entity:"ball-spawner"},"79":{entity:"paddle-blocker"}},tilewidth:16}],tilewidth:16,version:1,width:20,id:"level2"},level3:{height:26,layers:[{data:[60,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,48,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,72,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,72,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,108,96,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,96],height:26,name:"background",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{data:[80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80],height:26,name:"collision",opacity:1,type:"tilelayer",visible:true,width:20,x:0,y:0},{color:"#ff00ff",height:26,name:"Objects",objects:[{height:16,name:"paddle",properties:{},type:"",visible:true,width:48,x:80,y:368},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:80},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:112},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:160},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:144,y:192},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:80},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:80},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:80},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:80},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:112},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:176},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:176},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:112},{gid:13,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:112},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:96},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:160},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:192},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:192},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:128},{gid:1,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:160},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:80},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:128},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:192},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:192},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:160},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:112},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:128},{gid:37,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:160},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:80},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:48,y:144},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:80,y:192},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:208,y:192},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:240,y:144},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:112},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:112,y:144},{gid:25,height:0,name:"",properties:{},type:"",visible:true,width:0,x:176,y:144},{gid:52,height:0,name:"",properties:{},type:"",visible:true,width:0,x:64,y:272},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:-32,y:304},{height:32,name:"ball-killer",properties:{},type:"",visible:true,width:384,x:-32,y:432},{height:128,name:"ball-killer",properties:{},type:"",visible:true,width:32,x:320,y:304}],opacity:1,type:"objectgroup",visible:true,width:20,x:0,y:0}],orientation:"orthogonal",properties:{name:"lets begin"},tileheight:16,tilesets:[{firstgid:1,image:"../game/images/tiles.png",imageheight:144,imagewidth:192,margin:0,name:"tiles",properties:{},spacing:0,tileheight:16,tileproperties:{"0":{entity:"brick-blue"},"12":{entity:"brick-orange"},"24":{entity:"brick-red"},"36":{entity:"brick-green"},"51":{entity:"ball-spawner"},"79":{entity:"paddle-blocker"}},tilewidth:16}],tilewidth:16,version:1,width:20,id:"level3"}},debug:false};(function(){var f=navigator.userAgent.toLowerCase(),n=document.createElement("audio"),q={canvas:false,touch:!!("ontouchstart" in window),iPod:(f.search("ipod")>-1),iPhone:(f.search("iphone")>-1),iPad:(f.search("ipad")>-1),safari:(f.search("safari")>-1),ie:(f.search("msie")>-1),firefox:(f.search("firefox")>-1),android:(f.search("android")>-1),chrome:(f.search("chrome")>-1),silk:(f.search("silk")>-1),iOS:false,mobile:false,desktop:false,multitouch:false,ogg:true,m4a:true,mp3:true},p=a.settings.aspects,b={},m=0,l=0,h=0,d=false,g="";q.iOS=q.iPod||q.iPhone||q.iPad;q.mobile=q.iOS||q.android||q.silk;q.desktop=!q.mobile;if(q.touch){if(q.android){if(parseInt(f.slice(f.indexOf("android")+8))>2){q.multitouch=true}}else{q.multitouch=true}}if((n.canPlayType)&&!(!!n.canPlayType&&""!=n.canPlayType('audio/ogg; codecs="vorbis"'))){q.ogg=false;if(q.ie||!(!!n.canPlayType&&""!=n.canPlayType("audio/mp4"))){q.m4a=false}}var c=document.createElement("canvas");try{q.canvas=!!(c.getContext("2d"))}catch(o){q.canvas=!!(c.getContext)}delete c;a.settings.aspects=b;a.settings.aspects={};for(m in p){d=false;g="";for(l in p[m]){g+=" "+l;for(h in p[m][l]){if(f.search(p[m][l][h])>-1){a.settings.aspects[l]=true;d=true;break}}if(d){break}}if(!d){console.warn("This browser doesn't support any of the following: "+g)}}a.settings.supports=q})();(function(c){if(c&&!c.console){var b=c.console={};b.log=b.warn=b.error=function(){}}})(window);window.addEventListener("load",function(){a.game=new a.classes.game(a.settings,function(b){});createjs.Ticker.useRAF=true;createjs.Ticker.setFPS(a.settings.global.fps);createjs.Ticker.addListener(a.game)},false);a.classes={};a.classes.game=(function(){var d=function(e,f){return function(g){f(e,g)}};var b=function(k,g){var e=document.createElement("div"),l=null;this.currentScene=undefined;this.loaded=null;this.tickContent={deltaT:0,count:0};this.settings=k;if(document.getElementById(k.global.rootElement||"root")){l=document.getElementById(k.global.rootElement||"root")}else{l=document.createElement("div");l.id=k.global.rootElement||"root";document.getElementsByTagName("body")[0].appendChild(l)}for(var h in k.supports){if(k.supports[h]){l.className+=" supports-"+h}}e.id="inner-"+l.id;l.appendChild(e);this.rootElement=e;this.containerElement=l;this.loadScene(k.global.initialScene);var f=this,m=null;if(k.debug){m=function(i,n){f.currentScene.trigger(i,n)}}else{m=function(i,n){f.currentScene.trigger(i,n);n.preventDefault()}}this.bindings=[];this.addEventListener(window,"keydown",m);this.addEventListener(window,"keyup",m);if(k.global.aspectRatio){m=function(q,r){var o=e;var p=k.global.aspectRatio;var s=l.offsetWidth;var n=l.offsetHeight;if(k.global.maxWidth&&(k.global.maxWidth<s)){s=k.global.maxWidth}var i=s/n;if(i>p){o.style.height=n+"px";s=n*p;o.style.width=s+"px"}else{o.style.width=s+"px";n=s/p;o.style.height=n+"px"}if(k.global.resizeFont){l.style.fontSize=Math.round(s/100)+"px"}o.style.marginTop="-"+Math.round(n/2)+"px";o.style.marginLeft="-"+Math.round(s/2)+"px";o.style.top="50%";o.style.left="50%";f.currentScene.trigger(q,r)};m("resize")}else{if(k.global.resizeFont){m=function(i,n){l.style.fontSize=parseInt(f.rootElement.offsetWidth/100)+"px";f.currentScene.trigger(i,n)};m("resize")}}this.addEventListener(window,"orientationchange",m);this.addEventListener(window,"resize",m);if(g){g(this)}};var c=b.prototype;c.tick=function(e){this.tickContent.deltaT=e;this.tickContent.count+=1;if(this.loadedScene){this.loadedScene.trigger("tick",this.tickContent)}if(this.currentScene){this.currentScene.trigger("tick",this.tickContent)}};c.loadScene=function(e,k,i,h){var f=this;this.inTransition=true;this.leavingScene=this.currentScene;if(h){this.loadNextScene(e);return}switch(k){case"fade-to-black":var g=document.createElement("div");this.rootElement.appendChild(g);g.style.width="100%";g.style.height="100%";g.style.position="absolute";g.style.zIndex="12";g.style.opacity="0";g.style.background="#000";new createjs.Tween(g.style).to({opacity:0},500).to({opacity:1},500).call(function(l){if(!this.loaded){f.loadNextScene(e,i)}f.completeSceneTransition(i)}).wait(500).to({opacity:0},500).call(function(l){f.rootElement.removeChild(g);g=undefined});break;case"instant":default:if(!this.loaded){f.loadNextScene(e,i)}this.completeSceneTransition(i)}};c.loadNextScene=function(e,g){var f=null;if(typeof e==="string"){f=this.settings.scenes[e]}else{f=e}this.loaded=e;this.loadedScene=new a.classes.scene(f,this.rootElement);console.log("Scene loaded: "+e);this.loadedScene.trigger("scene-loaded",g)};c.completeSceneTransition=function(f){var e=this.loaded;this.currentScene=this.loadedScene;this.loadedScene=null;this.loaded=false;this.inTransition=false;if(this.leavingScene){this.leavingScene.destroy();this.leavingScene=false}console.log("Scene live: "+e);this.currentScene.trigger("scene-live",f)};c.addEventListener=function(e,f,g){this.bindings[f]={element:e,callback:d(f,g)};e.addEventListener(f,this.bindings[f].callback,true)};c.destroy=function(){for(var e in this.bindings){element.removeEventListener(this.bindings[e].element,this.bindings[e].callback,true)}this.bindings.length=0};return b})();(function(b){b.components={};b.createComponentClass=function(e){var c=function(h,i){return function(l,k){h[i](l,k)}},d=function(h,m){var n=null,l="",k="",i=null;this.owner=h;this.listeners=[];this.publicMethods={};this.type=e.id;if(e.events){for(n in e.events){i=c(this,n);this.addListener(n,i);if(m.aliases){for(var l in m.aliases){if(m.aliases[l]===n){this.addListener(l,i)}}}}}if(e.publicMethods){for(n in e.publicMethods){k=n;if(m.aliases){for(var l in m.aliases){if(m.aliases[l]===n){k=l}}}this.addMethod(k,e.publicMethods[n])}}if(this.constructor){this.constructor(m)}},g=null,f=d.prototype;f.constructor=e.constructor;if(e.events){for(g in e.events){f[g]=e.events[g]}}if(e.methods){for(g in e.methods){if(g==="destroy"){f["___"+g]=e.methods[g]}else{f[g]=e.methods[g]}}}if(e.publicMethods){for(g in e.publicMethods){f[g]=e.publicMethods[g]}}f.toString=function(){return"[component "+this.type+"]"};f.destroy=function(){for(g in this.publicMethods){this.removeMethod(g)}this.removeListeners(this.listeners);if(this.___destroy){this.___destroy()}};f.setProperty=function(i,h){this[i]=h};f.addListeners=function(i){for(var h in i){this.addListener(i[h])}};f.removeListeners=function(i){if(!i){i=this.listeners}for(var h in i){this.removeListener(h,i[h])}};f.addListener=function(h,k){var i=k||c(this,h);this.owner.bind(h,i);this.listeners[h]=i};f.addMethod=function(i,k){var h=this;if(this.owner[i]){console.warn(owner.type+': Entity already has a method called "'+i+'". Method not added.')}else{this.owner[i]=function(){return k.apply(h,arguments)};this.publicMethods[i]=k}};f.removeListener=function(h,i){this.owner.unbind(h,i)};f.removeMethod=function(h){if(!this.owner[h]){console.warn(owner.type+': Entity does not have a method called "'+h+'".')}else{delete this.owner[h]}delete this.publicMethods[h]};b.components[e.id]=d}})(a);a.classes.entity=(function(){var b=function(g,e){var n=this,k=undefined,i=undefined,f=g||{},d=f.components||[],m=f.properties||{},l=e||{},h=l.properties||{};n.components=[];n.messages=[];n.loopCheck=[];n.unbindLater=[];n.type=f.id;this.setProperty(m);this.setProperty(h);this.bind("set-property",function(o){n.setProperty(o)});if(!n.state){n.state={}}n.lastState={};for(k in d){i=d[k];if(a.components[i.type]){n.addComponent(new a.components[i.type](n,i))}else{console.warn("Component '"+i.type+"' is not defined.",i)}}n.trigger("load")};var c=b.prototype;c.toString=function(){return"[entity "+this.type+"]"};c.addComponent=function(d){this.components.push(d);return d};c.removeComponent=function(e){for(var d in this.components){if(this.components[d]===e){this.components.splice(d,1);e.destroy();return e}}return false};c.bind=function(e,d){if(!this.messages[e]){this.messages[e]=[]}this.messages[e].push(d)};c.unbind=function(f,e){var g=false,d=0;if(this.loopCheck.length){for(d=0;d<this.loopCheck.length;d++){if(this.loopCheck[d]===f){g=true;break}}}if(g){this.unbindLater.push({event:f,func:e})}else{this.safelyUnbind(f,e)}};c.safelyUnbind=function(f,e){if(!this.messages[f]){this.messages[f]=[]}for(var d in this.messages[f]){if(this.messages[f][d]===e){this.messages[f].splice(d,1);break}}};c.trigger=function(f,h,d){var e=0,g=0;if(typeof f==="string"){return this.triggerEvent(f,h,d)}else{if(f.length){for(;e<f.length;e++){g+=this.trigger(f[e],h,d)}return g}else{if(f.event){return this.triggerEvent(f.event,f.message||h,d)}else{console.warn('Event incorrectly formatted: must be string, array, or object containing an "event" property.');return 0}}}};c.triggerEvent=function(g,h,d){var f=0,e=0;if(this.debug||d||(h&&h.debug)){if(this.messages[g]&&this.messages[g].length){console.log('Entity "'+this.type+'": Event "'+g+'" has '+this.messages[g].length+" subscriber"+((this.messages[g].length>1)?"s":"")+".",h)}else{console.warn('Entity "'+this.type+'": Event "'+g+'" has no subscribers.',h)}}for(f=0;f<this.loopCheck.length;f++){if(this.loopCheck[f]===g){throw"Endless loop detected for '"+g+"'."}}f=0;this.loopCheck.push(g);if(this.messages[g]){for(f=0;f<this.messages[g].length;f++){this.messages[g][f](h,d)}}this.loopCheck.length=this.loopCheck.length-1;if(!this.loopCheck.length&&this.unbindLater.length){for(e=0;e<this.unbindLater.length;e++){this.safelyUnbind(this.unbindLater[e].event,this.unbindLater[e].func)}this.unbindLater.length=0}return f};c.setProperty=function(e){var d="";for(d in e){this[d]=e[d]}};c.getMessageIds=function(){var d=[];for(var e in this.messages){d.push(e)}return d};c.destroy=function(){for(var d in this.components){this.components[d].destroy()}this.components.length=0};return b})();a.classes.scene=(function(){var c=function(f,d){var k=f.layers,l=true,o=false,n=false,g=null;this.storedMessages=[];this.rootElement=d;this.layers=[];for(var m in k){o=k[m];n={rootElement:this.rootElement,parent:this};if(o.properties){for(h in o.properties){n[h]=o.properties[h]}}if(o.type){o=a.settings.entities[o.type]}l=true;if(o.filter){if(o.filter.includes){l=false;for(var e in o.filter.includes){if(a.settings.supports[o.filter.includes[e]]){l=true}}}if(o.filter.excludes){for(var e in o.filter.excludes){if(a.settings.supports[o.filter.excludes[e]]){l=false}}}}if(l){this.layers.push(new a.classes.entity(o,{properties:n}))}}g=this.storedMessages;this.storedMessages=false;for(var h=0;h<g.length;h++){this.trigger(g[h].message,g[h].value)}g.length=0;this.time=new Date().getTime();this.timeElapsed={name:"",time:0}};var b=c.prototype;b.trigger=function(e,f){var g=0;if(this.storedMessages){this.storedMessages.push({message:e,value:f})}else{if(e==="tick"){g=new Date().getTime();this.timeElapsed.name="Non-Engine";this.timeElapsed.time=g-this.time;this.trigger("time-elapsed",this.timeElapsed);this.time=g}for(var d in this.layers){this.layers[d].trigger(e,f)}if(e==="tick"){g=new Date().getTime();this.timeElapsed.name="Engine Total";this.timeElapsed.time=g-this.time;this.trigger("time-elapsed",this.timeElapsed);this.time=g}}};b.destroy=function(){for(var d in this.layers){this.layers[d].destroy()}this.layers.length=0};return c})();a.classes.collisionShape=(function(){var b=function(e,f,h){var k=f.regX,i=f.regY;this.owner=e;this.collisionType=h;this.width=f.width||f.radius||0;this.height=f.height||f.radius||0;this.radius=f.radius||0;if(typeof k!=="number"){k=this.width/2}if(typeof i!=="number"){i=this.height/2}this.offsetX=f.offsetX||((this.width/2)-k);this.offsetY=f.offsetY||((this.height/2)-i);if(e){this.x=e.x+this.offsetX;this.y=e.y+this.offsetY}else{this.x=f.x+this.offsetX;this.y=f.y+this.offsetY}this.type=f.type||"rectangle";this.subType="";this.points=f.points;this.aABB=undefined;var g=0;var d=0;switch(this.type){case"circle":g=d=this.radius*2;break;case"rectangle":g=this.width;d=this.height;break;case"triangle":if(this.points[0][1]==this.points[1][1]&&this.points[0][0]==this.points[2][0]){if(this.points[0][0]<this.points[1][0]){this.subType="tl";g=this.points[1][0]-this.points[0][0];d=this.points[2][1]-this.points[0][1]}else{this.subType="br";g=this.points[0][0]-this.points[1][0];d=this.points[0][1]-this.points[2][1]}}else{if(this.points[0][1]==this.points[2][1]&&this.points[0][0]==this.points[1][0]){if(this.points[0][1]<this.points[1][1]){this.subType="tr";g=this.points[0][0]-this.points[2][0];d=this.points[1][1]-this.points[0][1]}else{this.subType="bl";g=this.points[2][0]-this.points[0][0];d=this.points[0][1]-this.points[1][1]}}}}this.aABB=new a.classes.aABB(this.x,this.y,g,d)};var c=b.prototype;c.update=function(e,d){this.x=e+this.offsetX;this.y=d+this.offsetY;this.aABB.move(this.x,this.y)};c.moveX=function(d){this.x=d;this.aABB.moveX(this.x)};c.moveY=function(d){this.y=d;this.aABB.moveY(this.y)};c.moveXBy=function(d){this.x+=d;this.aABB.moveX(this.x)};c.moveYBy=function(d){this.y+=d;this.aABB.moveY(this.y)};c.getXY=function(){return[this.x,this.y]};c.getX=function(){return this.x};c.getY=function(){return this.y};c.getAABB=function(){return this.aABB};c.getXOffset=function(){return this.offsetX};c.getYOffset=function(){return this.offsetY};c.setXWithEntityX=function(d){this.x=d+this.offsetX;this.aABB.moveX(this.x)};c.setYWithEntityY=function(d){this.y=d+this.offsetY;this.aABB.moveY(this.y)};c.destroy=function(){this.aABB=undefined;this.points=undefined};return b})();a.classes.collisionData=(function(){var c=function(f,k,d,h,l,i,g,e){this.occurred=f||false;this.direction=k||null;this.position=d||null;this.deltaMovement=h||null;this.aABB=l||null;this.thisShape=i||null;this.thatShape=g||null;this.vector=e||null};var b=c.prototype;b.copy=function(d){this.occurred=d.occurred;this.direction=d.direction;this.position=d.position;this.deltaMovement=d.deltaMovement;this.aABB=d.aABB;this.thisShape=d.thisShape;this.thatShape=d.thatShape;this.vector=d.vector};b.clear=function(){this.occurred=false;this.direction=null;this.position=null;this.deltaMovement=null;this.aABB=null;this.thisShape=null;this.thatShape=null;this.vector=null};return c})();a.classes.collisionDataContainer=(function(){var b=function(){this.xData=[new a.classes.collisionData(),new a.classes.collisionData()];this.yData=[new a.classes.collisionData(),new a.classes.collisionData()];this.xCount=0;this.yCount=0;this.xDeltaMovement=Infinity;this.yDeltaMovement=Infinity};var c=b.prototype;c.getXEntry=function(d){return this.xData[d]};c.getYEntry=function(d){return this.yData[d]};c.tryToAddX=function(d){if(d.deltaMovement<this.xDeltaMovement){this.xDeltaMovement=d.deltaMovement;this.xData[0].copy(d);this.xCount=1;return true}else{if(d.deltaMovement==this.xDeltaMovement){this.ensureRoomX();this.xData[this.xCount].copy(d);this.xCount++;return true}}return false};c.tryToAddY=function(d){if(d.deltaMovement<this.yDeltaMovement){this.yDeltaMovement=d.deltaMovement;this.yData[0].copy(d);this.yCount=1;return true}else{if(d.deltaMovement==this.yDeltaMovement){this.ensureRoomY();this.yData[this.yCount].copy(d);this.yCount++;return true}}return false};c.ensureRoomX=function(){var e=this.xData.length*2;if(this.xData.length<=this.xCount){for(var d=this.xData.length;d<e;d++){this.xData[d]=new a.classes.collisionData()}}};c.ensureRoomY=function(){var e=this.yData.length*2;if(this.yData.length<=this.yCount){for(var d=this.yData.length;d<e;d++){this.yData[d]=new a.classes.collisionData()}}};c.reset=function(){this.xCount=0;this.yCount=0;this.xDeltaMovement=Infinity;this.yDeltaMovement=Infinity};return b})();a.classes.aABB=(function(){var c=function(e,g,f,d){this.empty=true;this.setAll(e,g,f,d)};var b=c.prototype;b.setAll=function(e,g,f,d){this.empty=false;this.x=e;this.y=g;this.width=f||0;this.height=d||0;this.halfWidth=this.width/2;this.halfHeight=this.height/2;if(typeof e==="undefined"){this.empty=true}else{this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x}if(typeof g==="undefined"){this.empty=true}else{this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y}return this};b.set=function(d){this.empty=d.empty;this.x=d.x;this.y=d.y;this.width=d.width;this.height=d.height;this.halfWidth=d.halfWidth;this.halfHeight=d.halfHeight;this.left=d.left;this.right=d.right;this.top=d.top;this.bottom=d.bottom;return this};b.reset=function(){this.empty=true;return this};b.include=function(d){if(d){if(this.empty){this.set(d)}else{if(this.left>d.left){this.left=d.left}if(this.right<d.right){this.right=d.right}if(this.top>d.top){this.top=d.top}if(this.bottom<d.bottom){this.bottom=d.bottom}this.width=this.right-this.left;this.height=this.bottom-this.top;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.x=this.left+this.halfWidth;this.y=this.top+this.halfHeight}}};b.move=function(d,e){this.moveX(d);this.moveY(e);return this};b.moveX=function(d){this.x=d;this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x;return this};b.moveY=function(d){this.y=d;this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y;return this};b.moveXBy=function(d){this.x+=d;this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x;return this};b.moveYBy=function(d){this.y+=d;this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y;return this};b.getCopy=function(){return new c(this.x,this.y,this.width,this.height)};b.matches=function(e,g,f,d){return !((this.x!==e)||(this.y!==g)||(this.width!==f)||(this.height!==d))};b.contains=function(d){return !((d.top<this.top)||(d.bottom>this.bottom)||(d.left<this.left)||(d.right>this.right))};b.intersects=function(d){return !((d.bottom<this.top)||(d.top>this.bottom)||(d.right<this.left)||(d.left>this.right))};return c})();a.classes.vector2D=(function(){var b=function(d,e){this.x=d||0;this.y=e||0};var c=b.prototype;c.set=function(d,e){this.x=d;this.y=e;return this};c.copyValues=function(d){this.x=d.x;this.y=d.y;return this};c.setX=function(d){this.x=d;return this};c.setY=function(d){this.y=d;return this};c.getX=function(){return this.x};c.getY=function(){return this.y};c.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))};c.direction=function(){var d=this.magnitude();var e=0;if(d!=0){e=Math.acos(this.x/d);if(this.y<0){e=(Math.PI*2)-e}}return e};c.getUnit=function(){var d=this.magnitude();if(d==0){return new a.classes.vector2D(0,0)}else{return new a.classes.vector2D(this.x/d,this.y/d)}};c.getInverse=function(){return new a.classes.vector2D(-this.x,-this.y)};c.normalize=function(){var d=this.magnitude();if(d!=0){this.x/=d;this.y/=d}return this};c.rotate=function(e){var d=this.x;var f=this.y;this.x=d*Math.cos(e)-f*Math.sin(e);this.y=d*Math.sin(e)+f*Math.cos(e);return this};c.add=function(d,e){this.x+=d;this.y+=e;return this};c.addVector=function(d){this.x+=d.x;this.y+=d.y;return this};c.subtractVector=function(d){this.x-=d.x;this.y-=d.y;return this};c.scale=function(d){this.x*=d;this.y*=d;return this};c.dot=function(d){return this.x*d.x+this.y*d.y};c.shortestAngleTo=function(d){return Math.acos(this.dot(d)/(this.magnitude()*d.magnitude()))};c.scalarProjection=function(e){var f=0;var d=null;if(typeof e=="number"){f=e}else{d=e;f=this.shortestAngleTo(d)}return this.magnitude()*Math.cos(f)};c.copy=function(){return new b(this.x,this.y)};return b})();a.components={};(function(){return a.createComponentClass({id:"asset-loader",constructor:function(b){this.useXHR=true;if(b.useXHR===false){this.useXHR=false}this.assets=b.assets||a.settings.assets;this.progressBar=b.progressBar||false;this.message={complete:false,total:0,progress:0,fraction:0}},events:{load:function(){var l=this,b=function(n,p){var m=0,o=false;for(m in p){if(p[m].id===n.id){o=true;break}}if(!o){p.push(n)}},h=new createjs.LoadQueue(this.useXHR),g=[],k=a.settings.global.nativeAssetResolution||0,d=a.settings.scale=k?Math.min(1,Math.max(window.screen.width,window.screen.height)*(window.devicePixelRatio||1)/k):1,c=function(o,m,u){var i=u||1,p=m||1,q=Math.ceil((o.width/p)*d)*p,s=Math.ceil((o.height/i)*d)*i,n=document.createElement("canvas"),t=n.getContext("2d");n.width=q;n.height=s;n.scaleX=q/o.width;n.scaleY=s/o.height;t.drawImage(o,0,0,o.width,o.height,0,0,q,s);return n};h.addEventListener("fileload",function(n){var m=n.item,o=m.data,i=m.tag;if(n.item.type=="image"){if(k&&(d!==1)){if(o){i=c(i,o.columns,o.rows)}else{i=c(i)}}}a.assets[n.item.id]=i;l.message.progress+=1;l.message.fraction=l.message.progress/l.message.total;if(l.message.progress===l.message.total){l.message.complete=true}l.owner.trigger("fileload",l.message)});h.addEventListener("complete",function(i){l.owner.trigger("complete")});for(var f in this.assets){if(typeof this.assets[f].src==="string"){b(this.assets[f],g)}else{for(var e in this.assets[f].src){if(a.settings.aspects[e]&&this.assets[f].src[e]){if(typeof this.assets[f].src[e]==="string"){this.assets[f].src=this.assets[f].src[e];b(this.assets[f],g)}else{this.assets[f].data=this.assets[f].src[e].data||this.assets[f].data;this.assets[f].assetId=this.assets[f].src[e].assetId;this.assets[f].src=this.assets[f].src[e].src;b({id:this.assets[f].assetId||this.assets[f].id,src:this.assets[f].src},g)}break}}if(typeof this.assets[f].src!=="string"){if(this.assets[f].src["default"]){if(typeof this.assets[f].src["default"]==="string"){this.assets[f].src=this.assets[f].src["default"];b(this.assets[f],g)}else{this.assets[f].data=this.assets[f].src["default"].data||this.assets[f].data;this.assets[f].assetId=this.assets[f].src["default"].assetId;this.assets[f].src=this.assets[f].src["default"].src;b({id:this.assets[f].assetId||this.assets[f].id,src:this.assets[f].src},g)}}else{console.warn("Asset has no valid source for this browser.",this.assets[f])}}}}createjs.HTMLAudioPlugin.isSupported=function(){createjs.HTMLAudioPlugin.generateCapabilities();var i=createjs.HTMLAudioPlugin.tag;if(i==null||createjs.HTMLAudioPlugin.capabilities==null){return false}return true};createjs.Sound.registerPlugins([createjs.HTMLAudioPlugin]);l.message.total=g.length;h.installPlugin(createjs.Sound);h.loadManifest(g);a.assets=[]},fileload:function(c){var b=null;if(this.progressBar){b=document.getElementById(this.progressBar);if(b){b=b.style;b.width=(c.fraction*100)+"%";b.backgroundSize=((1/c.fraction)*100)+"%"}}}}})})();a.components["enable-ios-audio"]=(function(){var e=false,c=function(f,h){var g=this;this.owner=f;if(!e){this.touchOverlay=document.createElement("div");this.touchOverlay.style.width="100%";this.touchOverlay.style.height="100%";this.touchOverlay.style.position="absolute";this.touchOverlay.style.zIndex="20";this.owner.rootElement.appendChild(this.touchOverlay);b(this.touchOverlay,h.audioId,function(){g.removeComponent()})}else{this.removeComponent()}},b=function(g,f,i){var k=false,h=false;e=true;h=function(o){var n=createjs.Sound.play(f),m=function(){n.removeEventListener("succeeded",m);n.pause()},l=function(){n.removeEventListener("ready",l);if(k){k()}};if(n.playState!=="playFailed"){n.stop()}else{n.addEventListener("succeeded",m);n.addEventListener("ready",l);try{n.play()}catch(o){k=function(){console.log("i");k=false;n.play()}}}g.removeEventListener("touchstart",h,false);if(i){i()}};g.addEventListener("touchstart",h,false)},d=c.prototype;d.removeComponent=function(){this.owner.removeComponent(this)};d.destroy=function(){if(this.touchOverlay){this.owner.rootElement.removeChild(this.touchOverlay)}this.touchOverlay=undefined};return c})();(function(){var b={entity:null,type:null,x:0,y:0,hitType:null,myType:null},e={x:0,y:0,relative:false},g=function(h){h.x=0;h.y=0;h.relative=false},d=new a.classes.collisionDataContainer(),f=function(i,h){if(i.left>=h.right){return false}if(i.right<=h.left){return false}if(i.top>=h.bottom){return false}if(i.bottom<=h.top){return false}return true},c=function(l,k){var m=0;var p=0;var h=undefined;var o=undefined;var r=0;var q=0;var n=undefined;var i=0;if(l.type=="rectangle"&&k.type=="rectangle"){return true}else{if(l.type=="circle"&&k.type=="circle"){m=Math.pow((l.x-k.x),2)+Math.pow((l.y-k.y),2);p=Math.pow((l.radius+k.radius),2);if(m<=p){return true}}else{if(l.type=="circle"&&k.type=="rectangle"||l.type=="rectangle"&&k.type=="circle"){if(l.type=="circle"){h=l;o=k}else{h=k;o=l}n=o.getAABB();r=Math.abs(h.x-o.x);q=Math.abs(h.y-o.y);if(r>=(n.halfWidth+h.radius)){return false}if(q>=(n.halfHeight+h.radius)){return false}if(r<(n.halfWidth)){return true}if(q<(n.halfHeight)){return true}i=Math.pow((r-n.halfWidth),2)+Math.pow((q-n.halfHeight),2);if(i<Math.pow(h.radius,2)){return true}}}}return false};return a.createComponentClass({id:"handler-collision",constructor:function(h){this.entitiesByType={};this.entitiesByTypeLive={};this.solidEntities=[];this.solidEntitiesLive=[];this.softEntities=[];this.softEntitiesLive=[];this.allEntities=[];this.allEntitiesLive=[];this.groupsLive=[];this.nonColliders=[];this.terrain=undefined;this.aabb=new a.classes.aABB(this.owner.x,this.owner.y);this.prevAABB=new a.classes.aABB(this.owner.x,this.owner.y);this.owner.previousX=this.owner.previousX||this.owner.x;this.owner.previousY=this.owner.previousY||this.owner.y;this.updateLiveList=true;this.cameraLogicAABB=new a.classes.aABB(0,0);this.cameraCollisionAABB=new a.classes.aABB(0,0);this.timeElapsed={name:"Col",time:0}},events:{"child-entity-added":function(h){this["add-collision-entity"](h)},"add-collision-entity":function(l){var n=0,m=l.collisionTypes,h=false,k=false;if((l.type=="tile-layer")||(l.type=="collision-layer")){this.terrain=l;this.updateLiveList=true}else{if(m){for(;n<m.length;n++){if(!this.entitiesByType[m[n]]){this.entitiesByType[m[n]]=[];this.entitiesByTypeLive[m[n]]=[]}this.entitiesByType[m[n]][this.entitiesByType[m[n]].length]=l;if(l.solidCollisions[m[n]].length&&!l.immobile){h=true}if(l.softCollisions[m[n]].length){k=true}}if(h&&!l.immobile){this.solidEntities[this.solidEntities.length]=l}if(k){this.softEntities[this.softEntities.length]=l}this.allEntities[this.allEntities.length]=l;this.updateLiveList=true}}},"child-entity-removed":function(h){this["remove-collision-entity"](h)},"remove-collision-entity":function(m){var h=0,p=0,n=0,o=m.collisionTypes,k=false,l=false;if(o){for(;p<o.length;p++){for(h in this.entitiesByType[o[p]]){if(this.entitiesByType[o[p]][h]===m){this.entitiesByType[o[p]].splice(h,1);break}}if(m.solidCollisions[o[p]].length){k=true}if(m.softCollisions[o[p]].length){l=true}}if(k){for(h in this.solidEntities){if(this.solidEntities[h]===m){this.solidEntities.splice(h,1);break}}}if(l){for(h in this.softEntities){if(this.softEntities[h]===m){this.softEntities.splice(h,1);break}}}for(n=0;n<this.allEntities.length;n++){if(this.allEntities[n]===m){this.allEntities.splice(n,1);break}}this.updateLiveList=true}},"check-collision-group":function(i){var h=new Date().getTime();if(i.camera){this.checkCamera(i.camera)}this.timeElapsed.name="Col-Cam";this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);h+=this.timeElapsed.time;this.prepareCollisions(i);this.timeElapsed.name="Col-Prep";this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);h+=this.timeElapsed.time;this.checkGroupCollisions();this.timeElapsed.name="Col-Group";this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);h+=this.timeElapsed.time;this.checkSolidCollisions();this.timeElapsed.name="Col-Solid";this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);h+=this.timeElapsed.time;this.resolveNonCollisions(i);this.timeElapsed.name="Col-None";this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);h+=this.timeElapsed.time;this.checkSoftCollisions(i);this.timeElapsed.name="Col-Soft";this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);h+=this.timeElapsed.time}},methods:{checkCamera:(function(){var h=function(k,i){return k.collisionGroup.getAllEntities()-i.collisionGroup.getAllEntities()};return function(F,A){var D=0,C=0,m=0,G=null,k=null,J=null,o=null,B=F.width,v=F.height,s=F.left+B/2,q=F.top+v/2,I=F.bufferLeft,p=F.bufferRight,w=F.bufferTop,r=F.bufferBottom,l=undefined,u=undefined,H=f,n=this.cameraLogicAABB,E=this.cameraCollisionAABB,t=null;B+=I+p;v+=w+r;if(this.updateLiveList||!n.matches(s,q,B,v)){n.setAll(s,q,B,v);if(this.updateLiveList||!E.contains(n)){this.updateLiveList=false;k=this.allEntitiesLive;k.length=0;o=this.solidEntitiesLive;o.length=0;J=this.softEntitiesLive;J.length=0;groups=this.groupsLive;groups.length=0;m=this.allEntities.length;for(D=0;D<m;D++){u=this.allEntities[D];if(u.alwaysOn||u.checkCollision||H(u.getAABB(),n)){u.checkCollision=false;k[k.length]=u;t=u.collisionTypes;if(u!==this.owner){if(!u.immobile){for(C=0;C<t.length;C++){if(u.solidCollisions[t[C]].length){o[o.length]=u;break}}}}for(C=0;C<t.length;C++){if(u.softCollisions[t[C]].length){J[J.length]=u;break}}if(u.collisionGroup){groups.push(u)}}}groups.sort(h);E.setAll(s,q,B+I+p,v+w+r);for(D in this.entitiesByType){l=this.entitiesByType[D];G=this.entitiesByTypeLive[D];G.length=0;m=l.length;for(C=0;C<m;C++){u=l[C];if(u.alwaysOn||H(u.getAABB(),E)){G[G.length]=u}}}}}}})(),prepareCollisions:function(k){var i=null;this.nonColliders.length=0;for(var h=this.allEntitiesLive.length-1;h>-1;h--){i=this.allEntitiesLive[h];i.triggerEvent("prepare-for-collision",k);if(!i.collides){this.nonColliders.push(i)}}},resolveNonCollisions:function(l){var i=null,k=e;k.relative=false;for(var h=this.nonColliders.length-1;h>-1;h--){i=this.nonColliders[h];k.x=i.x;k.y=i.y;i.trigger("relocate-entity",k)}},checkGroupCollisions:(function(){var h=function(l,o,m,n,i,q,p,k){b.entity=o;b.myType=m;b.type=n;b.x=i;b.y=q;b.direction=k;b.hitType=p;l.triggerEvent("hit-by-"+n,b);if(o){b.entity=l;b.type=m;b.myType=n;b.x=-i;b.y=-q;b.direction=k.getInverse();b.hitType=p;o.triggerEvent("hit-by-"+m,b)}};return function(){var m=this.groupsLive;for(var k=m.length-1;k>-1;k--){if(m[k].collisionGroup.getSize()>1){d.reset();g(e);e=this.checkSolidEntityCollision(m[k],m[k].collisionGroup,d,e);for(var l=0;l<d.xCount;l++){messageData=d.getXEntry(l);h(messageData.thisShape.owner,messageData.thatShape.owner,messageData.thisShape.collisionType,messageData.thatShape.collisionType,messageData.direction,0,"solid",messageData.vector)}for(l=0;l<d.yCount;l++){messageData=d.getYEntry(l);h(messageData.thisShape.owner,messageData.thatShape.owner,messageData.thisShape.collisionType,messageData.thatShape.collisionType,0,messageData.direction,"solid",messageData.vector)}}}}})(),checkSolidCollisions:(function(){var h=function(l,o,m,n,i,q,p,k){b.entity=o;b.myType=m;b.type=n;b.x=i;b.y=q;b.direction=k;b.hitType=p;l.triggerEvent("hit-by-"+n,b);if(o){b.entity=l;b.type=m;b.myType=n;b.x=-i;b.y=-q;b.direction=k.getInverse();b.hitType=p;o.triggerEvent("hit-by-"+m,b)}};return function(){var m=null,n=this.solidEntitiesLive;for(var k=n.length-1;k>-1;k--){d.reset();g(e);e=this.checkSolidEntityCollision(n[k],n[k],d,e);for(var l=0;l<d.xCount;l++){m=d.getXEntry(l);h(m.thisShape.owner,m.thatShape.owner,m.thisShape.collisionType,m.thatShape.collisionType,m.direction,0,"solid",m.vector)}for(l=0;l<d.yCount;l++){m=d.getYEntry(l);h(m.thisShape.owner,m.thatShape.owner,m.thisShape.collisionType,m.thatShape.collisionType,0,m.direction,"solid",m.vector)}}}})(),checkSolidEntityCollision:function(u,v,r,x){var w=0,n=0,o=x,l=u.x-u.previousX,h=u.y-u.previousY,t=null,q=0,p=0,m=Infinity,A=Infinity,k=v.getCollisionTypes(),y=false;if(v.getSolidEntities){y=v.getSolidEntities()}o.x=u.x;o.y=u.y;if(l||h){if(u.bullet){for(var s in k){t=v.getAABB(k[s]);m=Math.min(m,t.width);A=Math.min(A,t.height)}w=Math.ceil(Math.max(Math.abs(l)/m,Math.abs(h)/A));w=Math.min(w,100);q=l/w;p=h/w}else{w=1;q=l;p=h}for(n=0;n<w;n++){v.prepareCollision(u.previousX+q,u.previousY+p);o.x=u.x;o.y=u.y;o=this.processCollisionStep(u,v,y,r,o,q,p,k);if((o.x===u.previousX)&&(o.y===u.previousY)){v.relocateEntity(o.x,o.y,r);break}else{v.relocateEntity(o.x,o.y,r)}}}return o},processCollisionStep:(function(){var h=new a.classes.aABB(),i=function(l,k,o,q,p){var n=o.getAABB(q);if(o===l){return false}else{if(o.jumpThrough&&(k.bottom>n.top)){return false}else{if(l.jumpThrough&&(n.bottom>k.top)){return false}else{if(p){for(var m=0;m<p.length;m++){if(o===p[m]){return false}}}}}}return true};return function(F,n,E,p,D,H,G,K){var l=false;var k=[];var u=null;var J=null;var x=null;var o=null;var A="";var s=null;var C=this.getWorldEntities();var I=null;var m=this.getWorldTerrain(),v=n.getSolidCollisions();if(!n.jumpThrough||(G>=0)){for(var B=0;B<K.length;B++){k[B]=[];x=K[B];u=n.getPreviousAABB(x);J=n.getAABB(x);h.reset();h.include(J);h.include(u);for(var t=0;t<v[x].length;t++){A=v[x][t];if(C[A]){I=C[A];for(var r=0;r<I.length;r++){o=I[r];if(i(F,u,o,A,E)&&(f(h,o.getAABB(A)))){s=o.getShapes(A);for(var w=0;w<s.length;w++){k[B].push(s[w])}l=true}}}else{if(m&&(A==="tiles")){s=m.getTileShapes(h,u);for(var w=0;w<s.length;w++){k[B].push(s[w]);l=true}}}}}if(l){D=this.resolveCollisionPosition(F,n,D,k,p,K,H,G)}}return D}})(),resolveCollisionPosition:(function(){var h=new a.classes.collisionData();return function(p,q,m,r,o,k,l,i){if(l!=0){for(var n=0;n<k.length;n++){h.clear();h=this.findMinAxisMovement(p,q,k[n],"x",r[n],h);if(h.occurred){o.tryToAddX(h)}}}if(o.xCount>0){h.copy(o.getXEntry(0));m.x=p.previousX+h.deltaMovement*h.direction}else{m.x=p.x}q.movePreviousX(m.x);if(i!=0){for(var n=0;n<k.length;n++){h.clear();h=this.findMinAxisMovement(p,q,k[n],"y",r[n],h);if(h.occurred){o.tryToAddY(h)}}}if(o.yCount>0){h.copy(o.getYEntry(0));m.y=p.previousY+h.deltaMovement*h.direction}else{m.y=p.y}return m}})(),findMinAxisMovement:(function(){var h=new a.classes.collisionData();return function(q,r,m,l,s,p){var k=r.getShapes(m);var o=r.getPrevShapes(m);for(var n=0;n<k.length;n++){h.clear();h=this.findMinShapeMovementCollision(o[n],k[n],l,s,h);if(h.occurred&&!p.occurred){p.copy(h)}else{if(h.occurred&&p.occurred&&(h.deltaMovement<p.deltaMovement)){p.copy(h)}}}return p}})(),findMinShapeMovementCollision:(function(){var i=function(q,p,k,m,o,n,l){q.occurred=true;q.direction=p;q.position=k;q.deltaMovement=Math.abs(k-m);q.aABB=n.getAABB();q.thisShape=o;q.thatShape=n;q.vector=l.copy()},h=(function(){var k=new a.classes.vector2D(),n={position:0,contactVector:k},q=function(s,r){return Math.sqrt(Math.pow(r,2)-Math.pow(s,2))},m=function(t,r,s){var u=t-r;return u-(u/Math.abs(u))*s},o=function(r,s,t){if(r==="x"){return t.halfWidth+s.halfWidth}else{if(r==="y"){return t.halfHeight+s.halfHeight}}},p=function(s,v,t,r,u){var w=0;if(s==="x"){if(v.y>=t.aABB.top&&v.y<=t.aABB.bottom){return t.aABB.halfWidth+v.radius}else{k.y=m(v.y,t.y,t.aABB.halfHeight);w=t.aABB.halfWidth+q(k.y,v.radius);if(r===v){k.x=-m(v.x-u*w,t.x,t.aABB.halfWidth)/2;k.y=-k.y}else{k.x=m(v.x,t.x-u*w,t.aABB.halfWidth)/2}k.normalize();return w}}else{if(s==="y"){if(v.x>=t.aABB.left&&v.x<=t.aABB.right){return t.aABB.halfHeight+v.radius}else{k.x=m(v.x,t.x,t.aABB.halfWidth);w=t.aABB.halfHeight+q(k.x,v.radius);if(r===v){k.x=-k.x;k.y=-m(v.y-u*w,t.y,t.aABB.halfWidth)/2}else{k.y=m(v.y,t.y-u*w,t.aABB.halfWidth)/2}k.normalize();return w}}}},l=function(r,t,s){if(r==="x"){return q(t.y-s.y,t.radius+s.radius)}else{if(r==="y"){return q(t.x-s.x,t.radius+s.radius)}}};return function(r,u,t,s){if(t.type=="rectangle"){if(s.type=="rectangle"){n.position=s[r]-u*o(r,t.getAABB(),s.getAABB());k.x=0;k.y=0;k[r]=u;return n}else{if(s.type=="circle"){k.x=0;k.y=0;k[r]=u;n.position=s[r]-u*p(r,s,t,t,u);return n}}}else{if(t.type=="circle"){if(s.type=="rectangle"){k.x=0;k.y=0;k[r]=u;n.position=s[r]-u*p(r,t,s,t,u);return n}else{if(s.type=="circle"){n.position=s[r]-u*l(r,t,s);k.x=s.x-t.x;k.y=s.y-t.y;k[r]=s[r]-n.position;k.normalize();return n}}}}}})();return function(n,q,m,r,k){var v=n[m];var t=q[m];var l=n;var s=(v<t)?1:-1;var p=t;var u=null;var w=t;if(v!=t){if(m==="x"){l.moveX(t)}else{if(m==="y"){l.moveY(t)}}for(var o=0;o<r.length;o++){p=t;if(f(l.getAABB(),r[o].getAABB())){if(c(l,r[o])){u=h(m,s,l,r[o]);p=u.position;if(s>0){if(p<w){if(p<v){p=v}w=p;i(k,s,w,v,q,r[o],u.contactVector)}}else{if(p>w){if(p>v){p=v}w=p;i(k,s,w,v,q,r[o],u.contactVector)}}}}}}return k}})(),checkSoftCollisions:function(q){var h=undefined,C=undefined,p=b,B=0,w=0,u=0,o=0,n=0,l=0,r=f,v=null,D=null,t=null,s=null,m=null,E=false,A=this.getWorldEntities();p.x=0;p.y=0;for(o=0;o<this.softEntitiesLive.length;o++){C=this.softEntitiesLive[o];for(B=0;B<C.collisionTypes.length;B++){v=C.softCollisions[C.collisionTypes[B]];for(n=0;n<v.length;n++){t=v[n];D=A[t];if(D){for(l=0;l<D.length;l++){E=false;h=D[l];if((h!==C)&&(r(C.getAABB(C.collisionTypes[B]),h.getAABB(t)))){s=C.getShapes(C.collisionTypes[B]);m=h.getShapes(t);for(w=0;w<s.length;w++){for(u=0;u<m.length;u++){if(c(s[w],m[u])){p.entity=h;p.type=t;p.myType=C.collisionTypes[B];p.shape=m[u];p.hitType="soft";C.trigger("hit-by-"+t,p);p.debug=false;E=true}if(E){break}}if(E){break}}}}}}}}},destroy:function(){this.solidEntities.length=0;this.softEntities.length=0;for(var h in this.entitiesByType){this.entitiesByType[h].length=0}}},publicMethods:{getWorldEntities:function(){return this.entitiesByTypeLive},getWorldTerrain:function(){return this.terrain}}})})();a.components["handler-controller"]=(function(){var b=function(h,g){return function(k){if(k.released){h+=":up"}else{if(k.pressed){h+=":down"}}for(var i=0;i<g.entities.length;i++){g.entities[i].trigger(h,k)}}};var f=function(h,g){return function(k){for(var i=0;i<g.entities.length;i++){g.entities[i].trigger(h,k)}}};var e={kc0:"unknown",kc8:"backspace",kc9:"tab",kc12:"numpad-5-shift",kc13:"enter",kc16:"shift",kc17:"ctrl",kc18:"alt",kc19:"pause",kc20:"caps-lock",kc27:"esc",kc32:"space",kc33:"page-up",kc34:"page-down",kc35:"end",kc36:"home",kc37:"left-arrow",kc38:"up-arrow",kc39:"right-arrow",kc40:"down-arrow",kc42:"numpad-multiply",kc43:"numpad-add",kc44:"print-screen",kc45:"insert",kc46:"delete",kc47:"numpad-division",kc48:"0",kc49:"1",kc50:"2",kc51:"3",kc52:"4",kc53:"5",kc54:"6",kc55:"7",kc56:"8",kc57:"9",kc59:"semicolon",kc61:"equals",kc65:"a",kc66:"b",kc67:"c",kc68:"d",kc69:"e",kc70:"f",kc71:"g",kc72:"h",kc73:"i",kc74:"j",kc75:"k",kc76:"l",kc77:"m",kc78:"n",kc79:"o",kc80:"p",kc81:"q",kc82:"r",kc83:"s",kc84:"t",kc85:"u",kc86:"v",kc87:"w",kc88:"x",kc89:"y",kc90:"z",kc91:"left-windows-start",kc92:"right-windows-start",kc93:"windows-menu",kc96:"back-quote",kc106:"numpad-multiply",kc107:"numpad-add",kc109:"numpad-minus",kc110:"numpad-period",kc111:"numpad-division",kc112:"f1",kc113:"f2",kc114:"f3",kc115:"f4",kc116:"f5",kc117:"f6",kc118:"f7",kc119:"f8",kc120:"f9",kc121:"f10",kc122:"f11",kc123:"f12",kc144:"num-lock",kc145:"scroll-lock",kc186:"semicolon",kc187:"equals",kc188:"comma",kc189:"hyphen",kc190:"period",kc191:"forward-slash",kc192:"back-quote",kc219:"open-bracket",kc220:"back-slash",kc221:"close-bracket",kc222:"quote"};var c=function(g,h){this.owner=g;this.entities=[];this.listeners=[];this.addListeners(["tick","child-entity-added","child-entity-updated","check-inputs","keydown","keyup"]);this.timeElapsed={name:"Controller",time:0}};var d=c.prototype;d.keydown=function(h){for(var g=0;g<this.entities.length;g++){this.entities[g].trigger("key:"+(e["kc"+h.keyCode]||("key-code-"+h.keyCode))+":down",h)}};d.keyup=function(h){for(var g=0;g<this.entities.length;g++){this.entities[g].trigger("key:"+(e["kc"+h.keyCode]||("key-code-"+h.keyCode))+":up",h)}};d.tick=d["check-inputs"]=function(i){var h=new Date().getTime();for(var g=this.entities.length-1;g>-1;g--){if(!this.entities[g].trigger("handle-controller",i)){this.entities.splice(g,1)}}this.timeElapsed.time=new Date().getTime()-h;a.game.currentScene.trigger("time-elapsed",this.timeElapsed)};d["child-entity-added"]=d["child-entity-updated"]=function(h){var k=h.getMessageIds(),m=false;for(var g=0;g<k.length;g++){if(k[g]=="handle-controller"){for(var i=0;i<this.entities.length;i++){if(this.entities[i]==h){m=true;break}}if(!m){if(h.controlMap){for(var l in h.controlMap){if((l.indexOf("key:")<0)&&(l.indexOf("mouse:")<0)){if(!this[l]){this.addListeners([l,l+":up",l+":down"]);this[l]=b(l,this);this[l+":up"]=f(l+":up",this);this[l+":down"]=f(l+":down",this)}}}}this.entities.push(h);h.trigger("controller-load")}break}}};d.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0;this.owner=undefined};d.addListeners=function(h){for(var g in h){this.addListener(h[g])}};d.removeListeners=function(h){for(var g in h){this.removeListener(g,h[g])}};d.addListener=function(h,k){var g=this,i=k||function(m,l){g[h](m,l)};this.owner.bind(h,i);this.listeners[h]=i};d.removeListener=function(g,h){this.owner.unbind(g,h)};return c})();(function(){var e=function(h,p,m,g,i,k){var o=0;var n=0;var l=h.slice();if(k=="horizontal"){for(n=i-1;n>=0;n--){for(o=n*g,z=0;o<(n+1)*g;o++,z++){l.splice(((n+1)*p)+z,0,m[o])}}return l}else{if(k=="vertical"){return h.concat(m)}}},d=function(m,o,k,g){var h=0;var l=m.slice();var n=null;for(;h<o.length;h++){n={};for(j in o[h]){n[j]=o[h][j]}if(g=="horizontal"){n.x+=k}else{if(g=="vertical"){n.y+=k}}l.push(n)}return l},f=function(m,l,g){var k=0;var h=0;if(!m.tilewidth&&!m.tileheight){m.tilewidth=l.tilewidth;m.tileheight=l.tileheight}else{if(m.tilewidth!=l.tilewidth||m.tileheight!=l.tileheight){console.warn("Tiled-Loader: Your map has segments with different tile sizes. All tile sizes must match. Segment: "+l)}}if(g=="horizontal"){if(m.height==0){m.height=l.height}else{if(m.height!=l.height){console.warn("Tiled-Loader: You are trying to merge segments with different heights. All segments need to have the same height. Level: "+m+" Segment: "+l)}}}else{if(g=="vertical"){if(m.width==0){m.width=l.width}else{if(m.width!=l.width){console.warn("Tiled-Loader: You are trying to merge segments with different widths. All segments need to have the same width. Level: "+m+" Segment: "+l)}}}}for(;k<l.layers.length;k++){if(!m.layers[k]){m.layers[k]={};for(h in l.layers[k]){m.layers[k][h]=l.layers[k][h]}}else{if(m.layers[k].type==l.layers[k].type){if(m.layers[k].data&&l.layers[k].data){if(g=="horizontal"){m.layers[k].data=e(m.layers[k].data,m.width,l.layers[k].data,l.width,m.height,g);m.layers[k].width+=l.width}else{if(g=="vertical"){m.layers[k].data=e(m.layers[k].data,m.height,l.layers[k].data,l.height,m.width,g);m.layers[k].height+=l.height}}}else{if(m.layers[k].objects&&l.layers[k].objects){if(g=="horizontal"){m.layers[k].objects=d(m.layers[k].objects,l.layers[k].objects,m.width*m.tilewidth,g)}else{if(g=="vertical"){m.layers[k].objects=d(m.layers[k].objects,l.layers[k].objects,m.height*m.tileheight,g)}}}}}else{console.warn("Tiled-Loader: The layers in your level segments do not match. Level: "+m+" Segment: "+l)}}}if(g=="horizontal"){m.width+=l.width}else{if(g=="vertical"){m.height+=l.height}}for(k in l){if(!m[k]){m[k]=l[k]}}},c=function(l){var h=0;var g=0;var k=a.settings.levels;var n={height:0,width:0,layers:[]};var o={height:0,width:0,layers:[]};var m=l[h].length;for(;h<l.length;h++){if(m!=l[h].length){console.warn("Tiled-Loader: Your map is not square. Maps must have an equal number of segments in every row.")}n={height:0,width:0,layers:[]};for(g=0;g<l[h].length;g++){f(n,k[l[h][g]],"horizontal")}f(o,n,"vertical")}return o},b=function(i){var h=!!(536870912&i),g=!!(1073741824&i),k=!!(2147483648&i);if(h&&k){return -3}else{if(h){return -5}else{if(g){return -4}else{return -2}}}};return a.createComponentClass({id:"tiled-loader",constructor:function(g){this.entities=[];this.layerZ=0;this.followEntity=false;this.manuallyLoad=g.manuallyLoad||false;this.dataFromScene=this.owner.level||g.level||null;this.unitsPerPixel=this.owner.unitsPerPixel||g.unitsPerPixel||1;this.images=this.owner.images||g.images||false;this.imagesScale=this.owner.imagesScale||g.imagesScale||this.unitsPerPixel;this.layerZStep=this.owner.zStep||g.zStep||1000;this.separateTiles=this.owner.separateTiles||g.separateTiles||false;this.entityPositionX=this.owner.entityPositionX||g.entityPositionX||"center";this.entityPositionY=this.owner.entityPositionY||g.entityPositionY||"bottom"},events:{"scene-loaded":function(g){if(!this.manuallyLoad){this["load-level"]({level:this.dataFromScene,persistentData:g})}},"load-level":function(k){var m=k.level;var l=k.persistentData;var g=0,i=0,h=false;if(l){g=l.skill||+(window.localStorage.getItem("skill")||0)}if(typeof m==="string"){m=a.settings.levels[m]}else{m=c(m)}for(;i<m.layers.length;i++){h=this.setupLayer(m.layers[i],m,h);if(this.separateTiles){h=false}}this.owner.trigger("world-loaded",{width:m.width*m.tilewidth*this.unitsPerPixel,height:m.height*m.tileheight*this.unitsPerPixel,camera:this.followEntity});this.owner.removeComponent(this)}},methods:{setupLayer:function(E,h,n){var A=this,r=A.images||[],C=h.tilesets,g=h.tilewidth,o=h.tileheight,k=0,u=0,D=(C[C.length-1].imagewidth/g)*(C[C.length-1].imageheight/o)+C[C.length-1].firstgid,q=0,p=0,t=0,s=undefined,B="",w=undefined,l=undefined,i=true,v=false,m=function(S){var F=E.width,Q=E.height,I=undefined,G=undefined,P=undefined,J=undefined,O=false,H=null,R=null,K=0;I=JSON.parse(JSON.stringify(a.settings.entities[S]));G={};P=[];J=[];if(S==="collision-layer"){R=[];for(var N=0;N<C.length;N++){H=C[N];if(H.tileproperties){for(var M in H.tileproperties){if(H.tileproperties[M].jumpThrough){R.push(H.firstgid+ +M-1)}}}}}I.properties=I.properties||{};I.properties.width=g*F*A.unitsPerPixel;I.properties.height=o*Q*A.unitsPerPixel;I.properties.columns=F;I.properties.rows=Q;I.properties.tileWidth=g*A.unitsPerPixel;I.properties.tileHeight=o*A.unitsPerPixel;I.properties.scaleX=A.imagesScale;I.properties.scaleY=A.imagesScale;I.properties.layerZ=A.layerZ;I.properties.z=A.layerZ;for(N=0;N<D;N++){G["tile"+N]=N}for(N=0;N<F;N++){P[N]=[];J[N]=[];for(M=0;M<Q;M++){K=+E.data[N+M*F]-1;J[N][M]="tile"+K;if(R){for(var L=0;L<R.length;L++){if(R[L]===(268435455&K)){K=b(K)}break}}P[N][M]=K}}for(N=0;N<I.components.length;N++){if(I.components[N].type==="render-tiles"){O=I.components[N]}if(I.components[N].spriteSheet=="import"){I.components[N].spriteSheet={images:r,frames:{width:g*A.unitsPerPixel/A.imagesScale,height:o*A.unitsPerPixel/A.imagesScale},animations:G}}if(I.components[N].collisionMap=="import"){I.components[N].collisionMap=P}if(I.components[N].imageMap=="import"){I.components[N].imageMap=J}}A.layerZ+=A.layerZStep;if((S==="render-layer")&&n){n.trigger("add-tiles",O);return n}else{return A.owner.addEntity(new a.classes.entity(I,{properties:{}}))}};if(r.length==0){for(q=0;q<C.length;q++){if(a.assets[C[q].name]){r.push(a.assets[C[q].name])}else{r.push(C[q].image)}}}else{r=r.slice();for(q=0;q<r.length;q++){if(a.assets[r[q]]){r[q]=a.assets[r[q]]}}}if(E.type=="tilelayer"){s="render-layer";if(E.properties&&E.properties.entity){s=E.properties.entity}else{switch(E.name){case"collision":s="collision-layer";break;case"action":s="tile-layer";for(q=0;q<h.layers.length;q++){if(h.layers[q].name==="collision"||(h.layers[q].properties&&h.layers[q].properties.entity==="collision-layer")){i=false}}if(!i){s="render-layer"}break}}if(s==="tile-layer"){m("collision-layer");return m("render-layer",n)}else{if(s==="collision-layer"){m(s,n)}else{return m(s,n)}}}else{if(E.type=="objectgroup"){for(t=0;t<E.objects.length;t++){s=E.objects[t];for(q=0;q<C.length;q++){if(C[q].firstgid>s.gid){break}else{w=C[q]}}B="";if(s.type!==""){B=s.type}else{if(s.name!==""){B=s.name}else{if(w.tileproperties[s.gid-w.firstgid]){if(w.tileproperties[s.gid-w.firstgid].entity){B=w.tileproperties[s.gid-w.firstgid].entity}else{if(w.tileproperties[s.gid-w.firstgid].type){B=w.tileproperties[s.gid-w.firstgid].type}}}}}if(B!==""){l={};if(w.tileproperties&&w.tileproperties[s.gid-w.firstgid]){for(q in w.tileproperties[s.gid-w.firstgid]){v=parseFloat(w.tileproperties[s.gid-w.firstgid][q]);if(v==0||(!!v)){l[q]=v}else{if(w.tileproperties[s.gid-w.firstgid][q]=="true"){l[q]=true}else{if(w.tileproperties[s.gid-w.firstgid][q]=="false"){l[q]=false}else{l[q]=w.tileproperties[s.gid-w.firstgid][q]}}}}}for(q in s.properties){v=parseFloat(s.properties[q]);if(v==0||(!!v)){l[q]=v}else{if(s.properties[q]=="true"){l[q]=true}else{if(s.properties[q]=="false"){l[q]=false}else{l[q]=s.properties[q]}}}}k=l.width=(s.width||g)*this.unitsPerPixel;u=l.height=(s.height||o)*this.unitsPerPixel;if(B&&a.settings.entities[B]&&a.settings.entities[B].properties){l.width=a.settings.entities[B].properties.width||l.width;l.height=a.settings.entities[B].properties.height||l.height}l.x=s.x*this.unitsPerPixel;if(this.entityPositionX==="left"){l.regX=0}else{if(this.entityPositionX==="center"){l.regX=l.width/2;l.x+=k/2}else{if(this.entityPositionX==="right"){l.regX=l.width;l.x+=k}}}l.y=s.y*this.unitsPerPixel;if(typeof s.gid==="undefined"){l.y+=l.height}if(this.entityPositionY==="bottom"){l.regY=l.height}else{if(this.entityPositionY==="center"){l.regY=l.height/2;l.y-=u/2}else{if(this.entityPositionY==="top"){l.regY=0;l.y-=u}}}l.scaleX=this.imagesScale;l.scaleY=this.imagesScale;l.layerZ=this.layerZ;if(l.z){l.z+=this.layerZ}else{if(B&&a.settings.entities[B]&&a.settings.entities[B].properties&&a.settings.entities[B].properties.z){l.z=this.layerZ+a.settings.entities[B].properties.z}else{l.z=this.layerZ}}l.parent=this.owner;s=this.owner.addEntity(new a.classes.entity(a.settings.entities[B],{properties:l}));if(s){if(s.camera){this.followEntity={entity:s,mode:s.camera}}}}}this.layerZ+=this.layerZStep;return false}}},destroy:function(){this.entities.length=0}}})})();(function(){return a.createComponentClass({id:"handler-render-createjs",constructor:function(c){var b=this;this.entities=[];this.canvas=this.owner.canvas=document.createElement("canvas");this.owner.canvasParent=null;if(this.owner.element){this.owner.canvasParent=this.owner.element;this.owner.element.appendChild(this.canvas)}else{this.owner.canvasParent=this.owner.rootElement;this.owner.rootElement.appendChild(this.canvas);this.owner.element=this.canvas}this.stage=new createjs.Stage(this.canvas);if(c.autoClear!==true){this.stage.autoClear=false}if(c.acceptInput){if(c.acceptInput.click||c.acceptInput.touch){this.setupInput(c.acceptInput.touch,c.acceptInput.camera)}}this.camera={left:0,top:0,width:0,height:0,bufferLeft:c.bufferLeft||c.bufferWidth||c.buffer||-1,bufferRight:c.bufferRight||c.bufferWidth||c.buffer||-1,bufferTop:c.bufferTop||c.bufferHeight||c.buffer||-1,bufferBottom:c.bufferBottom||c.bufferHeight||c.buffer||-1};this.timeElapsed={name:"Render",time:0};this.renderMessage={deltaT:0,stage:this.stage}},events:{"child-entity-added":function(d){var c=this,e=d.getMessageIds();for(var b=0;b<e.length;b++){if((e[b]=="handle-render")||(e[b]=="handle-render-load")){this.entities.push(d);d.trigger("handle-render-load",{stage:c.stage,parentElement:c.owner.rootElement});break}}},"pause-render":function(b){if(b&&b.time){this.paused=b.time}else{this.paused=-1}},"unpause-render":function(){this.paused=0},tick:(function(){var b=function(d,c){return d.z-c.z};return function(f){var g=undefined,e=new Date().getTime(),d=this.renderMessage;d.deltaT=f.deltaT;if(this.paused>0){this.paused-=f.deltaT;if(this.paused<0){this.paused=0}}for(var c=this.entities.length-1;c>-1;c--){if(!this.entities[c].trigger("handle-render",d)){this.entities.splice(c,1)}}if(this.stage){for(var c=this.stage.children.length-1;c>-1;c--){g=this.stage.children[c];if(g.hidden){if(g.visible){g.visible=false}}else{if(g.name!=="entity-managed"){if((g.x>=this.camera.x-this.camera.bufferLeft)&&(g.x<=this.camera.x+this.camera.width+this.camera.bufferRight)&&(g.y>=this.camera.y-this.camera.bufferTop)&&(g.y<=this.camera.y+this.camera.height+this.camera.bufferBottom)){if(!g.visible){g.visible=true}}else{if(g.visible){g.visible=false}}}}if(g.visible){if(g.paused&&!this.paused){g.paused=false}else{if(this.paused){g.paused=true}}}if(!g.scaleX||!g.scaleY||(this.children&&!this.children.length)){console.log("uh oh",g)}}if(this.stage.reorder){this.stage.reorder=false;this.stage.sortChildren(b)}this.timeElapsed.name="Render-Prep";this.timeElapsed.time=new Date().getTime()-e;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);e+=this.timeElapsed.time;this.stage.update();this.timeElapsed.name="Render";this.timeElapsed.time=new Date().getTime()-e;a.game.currentScene.trigger("time-elapsed",this.timeElapsed)}}})(),"camera-update":function(c){var b=(window.devicePixelRatio||1);this.camera.x=c.viewportLeft;this.camera.y=c.viewportTop;this.camera.width=c.viewportWidth;this.camera.height=c.viewportHeight;if(this.camera.bufferLeft==-1){this.camera.bufferLeft=this.camera.width/12}if(this.camera.bufferRight==-1){this.camera.bufferRight=this.camera.width/12}if(this.camera.bufferTop==-1){this.camera.bufferTop=this.camera.width/12}if(this.camera.bufferBottom==-1){this.camera.bufferBottom=this.camera.width/12}this.canvas.width=this.canvas.offsetWidth*b;this.canvas.height=this.canvas.offsetHeight*b;this.stage.setTransform(-c.viewportLeft*c.scaleX*b,-c.viewportTop*c.scaleY*b,c.scaleX*b,c.scaleY*b);if(this.moveMouse){this.moveMouse(c)}}},methods:{setupInput:function(k,i){var l=this,b=null,h=0,g=0,e=function(m){b=m;h=m.stageX/l.stage.scaleX+l.camera.x;g=m.stageY/l.stage.scaleY+l.camera.y},c=function(m){e(m);l.owner.trigger("mousedown",{event:m.nativeEvent,x:h,y:g,entity:l.owner});if(i){l.moveMouse=function(){e(b);l.owner.trigger("mousemove",{event:m.nativeEvent,x:h,y:g,entity:l.owner})}}},d=function(m){e(m);l.owner.trigger("mouseup",{event:m.nativeEvent,x:h,y:g,entity:l.owner});if(i){l.moveMouse=null}},f=function(m){e(m);if(m.nativeEvent.which||m.nativeEvent.touches){l.owner.trigger("mousemove",{event:m.nativeEvent,x:h,y:g,entity:l.owner})}};if(k&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.stage.addEventListener("stagemousedown",c);this.stage.addEventListener("stagemouseup",d);this.stage.addEventListener("stagemousemove",f);this.removeStageListeners=function(){this.stage.removeEventListener("stagemousedown",c);this.stage.removeEventListener("stagemouseup",d);this.stage.removeEventListener("stagemousemove",f)}},destroy:function(){if(this.removeStageListeners){this.removeStageListeners()}this.stage=undefined;this.owner.canvasParent.removeChild(this.canvas);this.owner.canvasParent=null;this.owner.element=null;this.canvas=undefined;this.entities.length=0}}})})();a.components["handler-render-dom"]=(function(){var b=function(d,g){this.owner=d;this.entities=[];this.listeners=[];this.addListeners(["tick","child-entity-added","render"]);this.element=this.owner.element=document.createElement("div");this.owner.rootElement.appendChild(this.element);this.owner.element=this.element;for(var f in g){if(f==="style"){for(var e in g[f]){this.element.style[e]=g[f][e]}}else{if(f!=="type"){if(f.indexOf("on")===0){this.element[f]=createFunction(g[f],this.owner)}else{this.element[f]=g[f]}}}}},c=b.prototype;c["child-entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if((g[d]=="handle-render")||(g[d]=="handle-render-load")){this.entities.push(f);f.trigger("handle-render-load",{element:e.element});break}}};c.tick=c.render=function(e){for(var d=this.entities.length-1;d>-1;d--){if(!this.entities[d].trigger("handle-render",e)){this.entities.splice(d,1)}}};c.destroy=function(){this.removeListeners(this.listeners);this.owner.rootElement.removeChild(this.element);this.owner.element=null;this.element=undefined;this.entities.length=0;this.owner=undefined};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(i,h){d[e](i,h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["handler-ai"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.addListeners(["child-entity-added","tick"])};var c=b.prototype;c["child-entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if(g[d]=="handle-ai"){this.entities.push(f);break}}};c.tick=function(e){for(var d=this.entities.length-1;d>-1;d--){if(!this.entities[d].trigger("handle-ai",e)){this.entities.splice(d,1)}}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(i,h){d[e](i,h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();(function(){var b=function(c){var d=null,e=false;for(d in c.state){if(c.state[d]!==c.lastState[d]){c.lastState[d]=c.state[d];e=true}}return e};return a.createComponentClass({id:"handler-logic",constructor:function(c){this.entities=[];this.activeEntities=this.entities;this.paused=0;this.stepLength=c.stepLength||30;this.leftoverTime=0;this.maximumStepsPerTick=10;this.camera={left:0,top:0,width:0,height:0,bufferLeft:c.bufferLeft||c.bufferWidth||c.buffer||-1,bufferRight:c.bufferRight||c.bufferWidth||c.buffer||-1,bufferTop:c.bufferTop||c.bufferHeight||c.buffer||-1,bufferBottom:c.bufferBottom||c.bufferHeight||c.buffer||-1,active:false};this.message={deltaT:this.stepLength,tick:null,camera:this.camera,movers:this.activeEntities};this.timeElapsed={name:"Logic",time:0}},events:{"child-entity-added":function(d){var e=d.getMessageIds();for(var c=0;c<e.length;c++){if(e[c]=="handle-logic"){this.entities.push(d);this.updateNeeded=this.camera.active;break}}},"pause-logic":function(c){if(c&&c.time){this.paused=c.time}else{this.paused=-1}},"unpause-logic":function(){this.paused=0},"camera-update":function(c){this.camera.left=c.viewportLeft;this.camera.top=c.viewportTop;this.camera.width=c.viewportWidth;this.camera.height=c.viewportHeight;if(this.camera.bufferLeft==-1){this.camera.bufferLeft=this.camera.width/10}if(this.camera.bufferRight==-1){this.camera.bufferRight=this.camera.width/10}if(this.camera.bufferTop==-1){this.camera.bufferTop=this.camera.width/10}if(this.camera.bufferBottom==-1){this.camera.bufferBottom=this.camera.width/10}this.camera.active=true;this.updateNeeded=true},tick:function(h){var g=0,l=undefined,f=new Date().getTime();this.leftoverTime+=h.deltaT;g=Math.floor(this.leftoverTime/this.stepLength)||1;this.message.deltaT=Math.min(this.leftoverTime,this.stepLength);this.leftoverTime=Math.max(this.leftoverTime-(g*this.stepLength),0);if(this.paused>0){this.paused-=h.deltaT;if(this.paused<0){this.paused=0}}if(!this.paused){if(!this.message.tick){this.message.tick=h}if(this.activeEntities===this.entities){this.message.movers=this.activeEntities=[]}this.activeEntities.length=0;for(var d=this.entities.length-1;d>-1;d--){l=this.entities[d];if(l.alwaysOn||(typeof l.x==="undefined")||((l.x>=this.camera.left-this.camera.bufferLeft)&&(l.x<=this.camera.left+this.camera.width+this.camera.bufferRight)&&(l.y>=this.camera.top-this.camera.bufferTop)&&(l.y<=this.camera.top+this.camera.height+this.camera.bufferBottom))){this.activeEntities.push(l)}}g=Math.min(g,this.maximumStepsPerTick);for(var e=0;e<g;e++){for(var d=this.activeEntities.length-1;d>-1;d--){l=this.activeEntities[d];if(l.triggerEvent("handle-logic",this.message)){if(b(l)){l.trigger("logical-state",l.state)}l.checkCollision=true}else{for(var c=this.entities.length-1;c>-1;c--){if(this.entities[c]===this.activeEntities[d]){this.entities.splice(c,1);this.updateNeeded=this.camera.active;break}}}}this.timeElapsed.name="Logic";this.timeElapsed.time=new Date().getTime()-f;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);f+=this.timeElapsed.time;this.owner.trigger("check-collision-group",this.message);this.timeElapsed.name="Collision";this.timeElapsed.time=new Date().getTime()-f;a.game.currentScene.trigger("time-elapsed",this.timeElapsed);f+=this.timeElapsed.time}}this.timeElapsed.time=new Date().getTime()-f;a.game.currentScene.trigger("time-elapsed",this.timeElapsed)}}})})();(function(){var b=function(c){c.window.viewportTop=c.element.offsetTop;c.window.viewportLeft=c.element.offsetLeft;c.window.viewportWidth=c.element.offsetWidth||c.worldWidth;c.window.viewportHeight=c.element.offsetHeight||c.worldHeight;if(c.scaleWidth){c.world.viewportWidth=c.window.viewportWidth/Math.ceil(c.window.viewportWidth/c.scaleWidth)}if(!c.stretch||c.scaleWidth){c.world.viewportHeight=c.window.viewportHeight*c.world.viewportWidth/c.window.viewportWidth}c.worldPerWindowUnitWidth=c.world.viewportWidth/c.window.viewportWidth;c.worldPerWindowUnitHeight=c.world.viewportHeight/c.window.viewportHeight;c.windowPerWorldUnitWidth=c.window.viewportWidth/c.world.viewportWidth;c.windowPerWorldUnitHeight=c.window.viewportHeight/c.world.viewportHeight;c.windowResized=true};return a.createComponentClass({id:"camera",constructor:function(c){this.entities=[];this.stretch=c.stretch||false;this.transitionX=c.transitionX||c.transition;this.transitionY=c.transitionY||c.transition;if(isNaN(this.transitionX)){this.transitionX=400}if(isNaN(this.transitionY)){this.transitionY=600}this.threshold=c.threshold||1;this.element=null;this.window={viewportTop:0,viewportLeft:0,viewportWidth:0,viewportHeight:0};this.world={viewportWidth:c.width||0,viewportHeight:c.height||0,viewportLeft:c.left||0,viewportTop:c.top||0};this.message={viewportWidth:0,viewportHeight:0,viewportLeft:0,viewportTop:0,scaleX:0,scaleY:0};this.scaleWidth=c.scaleWidth||0;this.worldIsLoaded=false;this.worldWidth=c.worldWidth||c.width||0;this.worldHeight=c.worldHeight||c.height||0;this.following=undefined;this.state="static";this.bBBorderX=0;this.bBBorderY=0;this.bBInnerWidth=0;this.bBInnerHeight=0;this.setBoundingArea();this.lastLeft=this.world.viewportLeft;this.lastTop=this.world.viewportTop;this.forwardX=0;this.forwardY=0;this.averageOffsetX=0;this.averageOffsetY=0;this.offsetX=0;this.offsetY=0;this.forwardFollower={x:this.lastLeft,y:this.lastTop};this.lastFollow={entity:null,mode:null,offsetX:0,offsetY:0,begin:0};this.direction=true;this.stationary=false;this.newChild=false},events:{load:function(){this.element=this.owner.canvas||this.owner.element||this.owner.rootElement;this.resize()},"child-entity-added":function(d){var e=d.getMessageIds();for(var c=0;c<e.length;c++){if(e[c]=="camera-update"){this.entities.push(d);this.newChild=true;if(this.worldIsLoaded){d.trigger("camera-loaded",{width:this.worldWidth,height:this.worldHeight})}break}}},"child-entity-removed":function(d){var c=0;for(c in this.entities){if(this.entities[c]===d){this.entities.splice(c,1);break}}},"world-loaded":function(d){this.worldIsLoaded=true;this.worldWidth=this.owner.worldWidth=d.width;this.worldHeight=this.owner.worldHeight=d.height;if(d.camera){this.follow(d.camera)}for(var c=this.entities.length-1;c>-1;c--){this.entities[c].trigger("camera-loaded",d)}},tick:function(e){var d=this.newChild;this.newChild=false;switch(this.state){case"following":d=this.followingFunction(this.following,e.deltaT);break;case"static":default:break}if(d||this.windowResized){this.stationary=false;this.message.viewportLeft=this.world.viewportLeft;this.message.viewportTop=this.world.viewportTop;this.message.viewportWidth=this.world.viewportWidth;this.message.viewportHeight=this.world.viewportHeight;this.message.scaleX=this.windowPerWorldUnitWidth;this.message.scaleY=this.windowPerWorldUnitHeight;this.windowResized=false;this.owner.trigger("camera-update",this.message);if(d){for(var c=this.entities.length-1;c>-1;c--){if(!this.entities[c].trigger("camera-update",this.message)){this.entities.splice(c,1)}}}}else{if(!this.stationary){this.owner.trigger("camera-stationary",this.message);this.stationary=true}}if(this.lastFollow.begin){if(this.lastFollow.begin<new Date().getTime()){this.follow(this.lastFollow)}}},resize:function(){b(this)},orientationchange:function(){b(this)},follow:function(c){if(c.time){if(!this.lastFollow.begin){this.lastFollow.entity=this.following;this.lastFollow.mode=this.mode;this.lastFollow.offsetX=this.offsetX;this.lastFollow.offsetY=this.offsetY}this.lastFollow.begin=new Date().getTime()+c.time}else{if(this.lastFollow.begin){this.lastFollow.begin=0}}this.mode=c.mode;switch(c.mode){case"locked":this.state="following";this.following=c.entity;this.followingFunction=this.lockedFollow;this.offsetX=c.offsetX||0;this.offsetY=c.offsetY||0;break;case"forward":this.state="following";this.followFocused=false;this.following=c.entity;this.lastLeft=c.entity.x;this.lastTop=c.entity.y;this.forwardX=c.movementX||(this.transitionX/10);this.forwardY=c.movementY||0;this.averageOffsetX=0;this.averageOffsetY=0;this.offsetX=c.offsetX||0;this.offsetY=c.offsetY||0;this.followingFunction=this.forwardFollow;break;case"bounding":this.state="following";this.following=c.entity;this.offsetX=c.offsetX||0;this.offsetY=c.offsetY||0;this.setBoundingArea(c.top,c.left,c.width,c.height);this.followingFunction=this.boundingFollow;break;case"static":default:this.state="static";this.following=undefined;this.followingFunction=undefined;break}if(c.begin){c.begin=0}}},methods:{move:function(e,c){var d=this.moveLeft(e);d=this.moveTop(c)||d;return d},moveLeft:function(c){if(Math.abs(this.world.viewportLeft-c)>this.threshold){if(this.worldWidth<this.world.viewportWidth){this.world.viewportLeft=(this.worldWidth-this.world.viewportWidth)/2}else{if(this.worldWidth&&(c+this.world.viewportWidth>this.worldWidth)){this.world.viewportLeft=this.worldWidth-this.world.viewportWidth}else{if(this.worldWidth&&(c<0)){this.world.viewportLeft=0}else{this.world.viewportLeft=c}}}return true}return false},moveTop:function(c){if(Math.abs(this.world.viewportTop-c)>this.threshold){if(this.worldHeight<this.world.viewportHeight){this.world.viewportTop=(this.worldHeight-this.world.viewportHeight)/2}else{if(this.worldHeight&&(c+this.world.viewportHeight>this.worldHeight)){this.world.viewportTop=this.worldHeight-this.world.viewportHeight}else{if(this.worldHeight&&(c<0)){this.world.viewportTop=0}else{this.world.viewportTop=c}}}return true}return false},lockedFollow:function(d,c,g){var l=d.x-(this.world.viewportWidth/2),k=d.y-(this.world.viewportHeight/2),i=(this.transitionX?Math.min(c/this.transitionX,1):1),f=1-i,h=(this.transitionY?Math.min(c/this.transitionY,1):1),e=1-h;return this.move(i*l+f*this.world.viewportLeft,h*k+e*this.world.viewportTop)},forwardFollow:function(e,g){var d=this.forwardFollower,h=15/g,f=false,c=e.x+this.offsetX,i=e.y+this.offsetY;if(this.followFocused&&(this.lastLeft===c)&&(this.lastTop===i)){return this.lockedFollow(d,g)}else{this.averageOffsetX*=0.9;this.averageOffsetY*=0.9;this.averageOffsetX+=0.1*(c-this.lastLeft)*h;this.averageOffsetY+=0.1*(i-this.lastTop)*h;if(Math.abs(this.averageOffsetX)>(this.world.viewportWidth/(this.forwardX*2))){this.averageOffsetX=0}if(Math.abs(this.averageOffsetY)>(this.world.viewportHeight/(this.forwardY*2))){this.averageOffsetY=0}d.x=this.averageOffsetX*this.forwardX+c;d.y=this.averageOffsetY*this.forwardY+i;this.lastLeft=c;this.lastTop=i;f=this.lockedFollow(d,g);if(!this.followFocused&&!f){this.followFocused=true}return f}},setBoundingArea:function(f,e,d,c){this.bBBorderY=(typeof f!=="undefined")?f:this.world.viewportHeight*0.25;this.bBBorderX=(typeof e!=="undefined")?e:this.world.viewportWidth*0.4;this.bBInnerWidth=(typeof d!=="undefined")?d:this.world.viewportWidth-(2*this.bBBorderX);this.bBInnerHeight=(typeof c!=="undefined")?c:this.world.viewportHeight-(2*this.bBBorderY)},boundingFollow:function(e,g){var f=null,d=null,c=(this.transitionX?Math.min(g/this.transitionX,1):1),k=1-c,i=(this.transitionY?Math.min(g/this.transitionY,1):1),h=1-i;if(e.x>this.world.viewportLeft+this.bBBorderX+this.bBInnerWidth){f=e.x-(this.bBBorderX+this.bBInnerWidth)}else{if(e.x<this.world.viewportLeft+this.bBBorderX){f=e.x-this.bBBorderX}}if(e.y>this.world.viewportTop+this.bBBorderY+this.bBInnerHeight){d=e.y-(this.bBBorderY+this.bBInnerHeight)}else{if(e.y<this.world.viewportTop+this.bBBorderY){d=e.y-this.bBBorderY}}if(typeof f!=="null"){f=this.moveLeft(c*f+k*this.world.viewportLeft)}if(typeof d!=="null"){d=this.moveTop(i*d+h*this.world.viewportTop)}return f||d},windowToWorld:function(c){var d=[];d[0]=Math.round((c[0]-this.window.viewportLeft)*this.worldPerWindowUnitWidth);d[1]=Math.round((c[1]-this.window.viewportTop)*this.worldPerWindowUnitHeight);return d},worldToWindow:function(d){var c=[];c[0]=Math.round((d[0]*this.windowPerWorldUnitWidth)+this.window.viewportLeft);c[1]=Math.round((d[1]*this.windowPerWorldUnitHeight)+this.window.viewportTop);return c},destroy:function(){this.entities.length=0}}})})();(function(){var b=function(e,h){var d=0,c=0,f=e.length,g=false;for(;d<h.length;d++){g=false;for(c=0;c<f;c++){if(h[d]===e[c]){g=true;break}}if(!g){e.push(h[d])}}return e};return a.createComponentClass({id:"collision-group",constructor:function(d){var c=this;this.solidEntities=[];this.terrain=undefined;this.aabb=new a.classes.aABB(this.owner.x,this.owner.y);this.prevAABB=new a.classes.aABB(this.owner.x,this.owner.y);this.owner.previousX=this.owner.previousX||this.owner.x;this.owner.previousY=this.owner.previousY||this.owner.y;this.collisionGroup=this.owner.collisionGroup={getAllEntities:function(){var g=0,f=null;for(var e=0;e<c.solidEntities.length;e++){f=c.solidEntities[e];if((f!==c.owner)&&f.collisionGroup){g+=f.collisionGroup.getAllEntities()}else{g+=1}}return g},getSize:function(){return c.solidEntities.length},getCollisionTypes:function(){return c.getCollisionTypes()},getSolidCollisions:function(){return c.getSolidCollisions()},getAABB:function(e){return c.getAABB(e)},getPreviousAABB:function(e){return c.getPreviousAABB(e)},getShapes:function(e){return c.getShapes(e)},getPrevShapes:function(e){return c.getPrevShapes(e)},prepareCollision:function(e,f){return c.prepareCollision(e,f)},relocateEntity:function(e,g,f){return c.relocateEntity(e,g,f)},movePreviousX:function(e){return c.movePreviousX(e)},getSolidEntities:function(){return c.solidEntities},jumpThrough:false}},events:{"child-entity-added":function(c){this["add-collision-entity"](c)},"add-collision-entity":function(c){var e=0,d=c.collisionTypes;if(d){for(;e<d.length;e++){if(c.solidCollisions[d[e]].length&&!c.immobile){this.solidEntities[this.solidEntities.length]=c}}this.updateAABB()}},"child-entity-removed":function(c){this["remove-collision-entity"](c)},"remove-collision-entity":function(d){var c=0,f=0,e=d.collisionTypes;if(e){for(;f<e.length;f++){if(d.solidCollisions[e[f]].length){for(c in this.solidEntities){if(this.solidEntities[c]===d){this.solidEntities.splice(c,1);break}}}}this.updateAABB()}},"relocate-entity":function(c){this.owner.previousX=this.owner.x;this.owner.previousY=this.owner.y;this.updateAABB()}},methods:{getCollisionTypes:function(){var d=null,e=[];for(var c=0;c<this.solidEntities.length;c++){d=this.solidEntities[c];if((d!==this.owner)&&d.collisionGroup){d=d.collisionGroup}e=b(e,d.getCollisionTypes())}return e},getSolidCollisions:function(){var d=null,g={},e=null;for(var c=0;c<this.solidEntities.length;c++){d=this.solidEntities[c];if((d!==this.owner)&&d.collisionGroup){d=d.collisionGroup}e=d.getSolidCollisions();for(var f in e){g[f]=b(g[f]||[],e[f])}}return g},getAABB:function(f){var e=null;if(!f){return this.aabb}else{var d=new a.classes.aABB();for(var c=0;c<this.solidEntities.length;c++){e=this.solidEntities[c];if((e!==this.owner)&&e.collisionGroup){e=e.collisionGroup}d.include(e.getAABB(f))}return d}},getPreviousAABB:function(f){var e=null;if(!f){return this.prevAABB}else{var d=new a.classes.aABB();for(var c=0;c<this.solidEntities.length;c++){e=this.solidEntities[c];if((e!==this.owner)&&e.collisionGroup){e=e.collisionGroup}d.include(e.getPreviousAABB(f))}return d}},updateAABB:function(){this.aabb.reset();for(var c=0;c<this.solidEntities.length;c++){this.aabb.include(((this.solidEntities[c]!==this.owner)&&this.solidEntities[c].getCollisionGroupAABB)?this.solidEntities[c].getCollisionGroupAABB():this.solidEntities[c].getAABB())}},getShapes:function(g){var f=null,d=[],e=null;for(var c=0;c<this.solidEntities.length;c++){f=this.solidEntities[c];if((f!==this.owner)&&f.collisionGroup){f=f.collisionGroup}e=f.getShapes(g);if(e){d=d.concat(e)}}return d},getPrevShapes:function(f){var e=null,d=[];for(var c=0;c<this.solidEntities.length;c++){e=this.solidEntities[c];if((e!==this.owner)&&e.collisionGroup){e=e.collisionGroup}newShapes=e.getPrevShapes(f);if(newShapes){d=d.concat(newShapes)}}return d},prepareCollision:function(d,h){var f=null,e=0,c=0;for(var g=0;g<this.solidEntities.length;g++){f=this.solidEntities[g];f.saveDX=f.x-f.previousX;f.saveDY=f.y-f.previousY;e=f.saveOX=this.owner.previousX-f.previousX;c=f.saveOY=this.owner.previousY-f.previousY;if((f!==this.owner)&&f.collisionGroup){f=f.collisionGroup}f.prepareCollision(d-e,h-c)}},movePreviousX:function(c){var d=null,f=0,e=0;for(;e<this.solidEntities.length;e++){d=this.solidEntities[e];f=d.saveOX;if((d!==this.owner)&&d.collisionGroup){d=d.collisionGroup}d.movePreviousX(c-f)}},relocateEntity:function(c,h,g){var e=null,d=null,f=0;this.owner.saveDX-=c-this.owner.previousX;this.owner.saveDY-=h-this.owner.previousY;for(f=0;f<g.xCount;f++){if(g.getXEntry(f).thisShape.owner===this.owner){this.owner.saveDX=0;break}}for(f=0;f<g.yCount;f++){if(g.getYEntry(f).thisShape.owner===this.owner){this.owner.saveDY=0;break}}for(var f=0;f<this.solidEntities.length;f++){e=d=this.solidEntities[f];if((e!==this.owner)&&e.collisionGroup){e=e.collisionGroup}e.relocateEntity(c-d.saveOX,h-d.saveOY,g);d.x+=d.saveDX;d.y+=d.saveDY;if(d!==this.owner){d.x+=this.owner.saveDX;d.y+=this.owner.saveDY}}},destroy:function(){this.solidEntities.length=0}},publicMethods:{getCollisionGroupAABB:function(){return this.getAABB()},getWorldEntities:function(){return this.owner.parent.getWorldEntities()},getWorldTerrain:function(){return this.owner.parent.getWorldTerrain()}}})})();(function(){var e={interrupt:createjs.Sound.INTERRUPT_ANY,delay:0,offset:0,loop:0,volume:1,pan:0,length:0,next:false,events:false},d={stop:true,playthrough:true},c=function(h,g){return h.time-g.time},f=function(o){var n="",h=undefined,g=null;if(typeof o==="string"){n=o;h={}}else{if(o.length){if(typeof o[0]==="string"){n=o[0];h={next:[]}}else{n=o[0].sound;h={};for(var m in o[0]){h[m]=o[0][m]}if(h.next){h.next=h.next.slice()}else{h.next=[]}}for(var k=1;k<o.length;k++){h.next.push(o[k])}}else{n=o.sound;h=o}}if(a.settings.assets[n].data){for(var l in a.settings.assets[n].data){h[l]=h[l]||a.settings.assets[n].data[l]}}if(a.settings.assets[n].assetId){n=a.settings.assets[n].assetId}return function(A){var C=this,u=undefined,x=false,B=false,q=e.offset,p=0;A=A||h;if(A&&A.stop){if(g){if(A.playthrough){g.remainingLoops=0}else{g.stop();C.removeClip(g)}}}else{if(A){var t=A.interrupt||h.interrupt||e.interrupt,s=A.delay||h.delay||e.delay,w=A.loop||h.loop||e.loop,v=(typeof A.volume!=="undefined")?A.volume:((typeof h.volume!=="undefined")?h.volume:e.volume),y=A.pan||h.pan||e.pan,p=A.length||h.length||e.length;q=A.offset||h.offset||e.offset;x=A.next||h.next||e.next;B=A.events||h.events||e.events;u=g=createjs.Sound.play(n,t,s,q,w,v,y)}else{u=g=createjs.Sound.play(n,e.interrupt,e.delay,e.offset,e.loop,e.volume,e.pan)}if(B){u.sequenceEvents=[];for(var r=0;r<B.length;r++){u.sequenceEvents.push({event:B[r].event,time:+B[r].time+q,message:B[r].message})}u.sequenceEvents.sort(c)}u.addEventListener("complete",function(){C.onComplete(u,x)});if(u.playState==="playFailed"){if(this.owner.debug){console.warn('Unable to play "'+n+'".',u)}}else{if(p){this.timedAudioClips.push({length:p,progress:0,audio:u,next:x})}this.activeAudioClips.push(u)}}}},b=function(h,i){var g=h.replace(/ /g,"").split(",");if(h==="default"){return function(k){return h}}else{return function(l){for(var k=0;k<g.length;k++){if(!l[g[k]]){return false}}return h}}};return a.createComponentClass({id:"audio",constructor:function(h){this.timedAudioClips=[];this.activeAudioClips=[];this.state={};this.stateChange=false;this.currentState=false;this.forcePlaythrough=this.owner.forcePlaythrough||h.forcePlaythrough;if(typeof this.forcePlaythrough!=="boolean"){this.forcePlaythrough=true}if(h.audioMap){this.checkStates=[];for(var g in h.audioMap){this.addListener(g);this[g]=f(h.audioMap[g]);this.checkStates.push(b(g,h.audioMap[g]))}}},events:{"handle-render":function(k){var h=0,g=undefined;newArray=undefined;for(h=0;h<this.activeAudioClips.length;h++){this.checkTimeEvents(this.activeAudioClips[h])}if(this.timedAudioClips.length){newArray=this.timedAudioClips;this.timedAudioClips=[];for(h in newArray){g=newArray[h];g.progress+=k.deltaT;if(g.progress>=g.length){g.audio.stop();this.onComplete(g.audio,g.next)}else{this.timedAudioClips.push(g)}}}h=0;if(this.stateChange){if(this.checkStates){if(this.currentState){d.playthrough=this.forcePlaythrough;this[this.currentState](d)}this.currentState=false;for(;h<this.checkStates.length;h++){g=this.checkStates[h](this.state);if(g){this.currentState=g;this[this.currentState]();break}}}this.stateChange=false}},"logical-state":function(h){for(var g in h){if(this.state[g]!==h[g]){this.stateChange=true;this.state[g]=h[g]}}},"audio-mute-toggle":function(){createjs.Sound.setMute(!createjs.Sound.getMute())},"audio-stop":function(){for(var g in this.activeAudioClips){this.activeAudioClips[g].stop()}this.activeAudioClips.length=0;this.timedAudioClips.length=0},"audio-mute":function(){createjs.Sound.setMute(true)},"audio-unmute":function(){createjs.Sound.setMute(false)}},methods:{checkTimeEvents:function(g,i){var h=0;if(g.sequenceEvents){h=g.getPosition();while(g.sequenceEvents.length&&(i||(g.sequenceEvents[0].time<=h))){this.owner.trigger(g.sequenceEvents[0].event,g.sequenceEvents[0].message);g.sequenceEvents.splice(0,1)}}},onComplete:function(h,i){this.removeClip(h);this.checkTimeEvents(h,true);this.owner.triggerEvent("clip-complete");if(i&&i.length){if(typeof i==="string"){(f(i)).call(this)}else{var g=i.slice();g.splice(0,1);if(g.length>0){(f(i[0])).call(this,{next:g})}else{(f(i[0])).call(this)}}}else{this.owner.triggerEvent("sequence-complete")}},removeClip:function(g){for(var h in this.activeAudioClips){if(this.activeAudioClips[h]===g){this.activeAudioClips.splice(h,1);break}}},destroy:function(){this["audio-stop"]()}}})})();a.components["broadcast-events"]=(function(){var d=function(g){if(typeof g==="string"){return function(i,h){a.game.currentScene.trigger(g,i,h)}}else{return function(i,h){for(var k in g){a.game.currentScene.trigger(g[k],i,h)}}}};var c=function(g){if(typeof g==="string"){return function(i,h){if(this.owner.parent){this.owner.parent.trigger(g,i,h)}}}else{return function(i,h){for(var k in g){this.owner.parent.trigger(g[k],i,h)}}}};var b=function(g){if(typeof g==="string"){return function(i,h){this.owner.trigger(g,i,h)}}else{return function(i,h){for(var k in g){this.owner.trigger(g[k],i,h)}}}};var e=function(g,h){this.owner=g;this.listeners=[];if(h.events){for(var i in h.events){this[i]=d(h.events[i]);this.addListener(i)}}if(h.parentEvents){for(var i in h.parentEvents){this[i]=c(h.parentEvents[i]);this.addListener(i)}}if(h.renameEvents){for(var i in h.renameEvents){this[i]=b(h.renameEvents[i]);this.addListener(i)}}};var f=e.prototype;f.destroy=function(){this.removeListeners(this.listeners)};f.addListeners=function(h){for(var g in h){this.addListener(h[g])}};f.removeListeners=function(h){for(var g in h){this.removeListener(g,h[g])}};f.addListener=function(h,k){var g=this,i=k||function(m,l){g[h](m,l)};this.owner.bind(h,i);this.listeners[h]=i};f.removeListener=function(g,h){this.owner.unbind(g,h)};return e})();(function(){return a.createComponentClass({id:"change-scene",constructor:function(b){this.scene=this.owner.scene||b.scene;this.transition=this.owner.transition||b.transition||"instant";this.persistentData=b.persistentData||{};if(b.message){this.addListener(b.message);this[b.message]=this["new-scene"]}this.preload=b.preload||false},events:{"scene-live":function(){if(this.preload){a.game.loadScene(this.scene,this.transition,this.persistentData,true)}},"new-scene":function(b){var e=b||this,c=e.scene||this.scene,d=e.transition||this.transition;data=e.persistentData||this.persistentData;a.game.loadScene(c,d,data)},"set-scene":function(b){this.scene=b},"set-persistent-scene-data":function(c){for(var b in c){this.persistentData[b]=c[b]}}}})})();(function(){var b=function(d,c){if(typeof d==="string"){return function(f){c.trigger(d,f);f.preventDefault()}}else{if(d.length){return function(g){for(var f=0;f<d.length;f++){c.trigger(d[f],g)}g.preventDefault()}}else{return function(f){c.trigger(d.event,d.message);f.preventDefault()}}}};return a.createComponentClass({id:"dom-element",constructor:function(f){var c=f.element||"div";this.updateClassName=f.updateClassName||false;this.className="";this.states={};this.stateChange=false;this.potentialParent=f.parent;this.handleRenderLoadMessage=null;this.element=document.createElement(c);if(!this.owner.element){this.owner.element=this.element}this.element.ondragstart=function(){return false};for(var e in f){if(e==="style"){for(var d in f[e]){this.element.style[d]=f[e][d]}}else{if(((e!=="type")||(c==="input"))&&(e!=="element")&&(e!=="parent")&&(e!=="updateClassName")&&(e!=="attributes")&&(e!=="messageMap")){if(e.indexOf("on")===0){this.element[e]=b(f[e],this.owner)}else{this.element[e]=f[e];if(e=="className"){this.className=f[e]}}}}}if(this.owner.className){this.className=this.element.className=this.owner.className}if(this.owner.innerHTML){this.element.innerHTML=this.owner.innerHTML}},events:{"handle-render-load":(function(){var c=function(d,g){var e=0,f=d.getElementsByTagName("*");for(;e<f.length;e++){if(f[e].getAttribute("id")===g){return f[e]}}return document.getElementById(g)};return function(g){if(g.element){if(!this.parentElement){if(this.potentialParent){this.parentElement=c(g.element,this.potentialParent);this.parentElement.appendChild(this.element)}else{this.parentElement=g.element;this.parentElement.appendChild(this.element)}}if(this.owner.entities){var f=this.handleRenderLoadMessage={};for(var e in g){f[e]=g[e]}f.element=this.element;for(var d in this.owner.entities){this.owner.entities[d].trigger("handle-render-load",f)}}}}})(),"child-entity-added":function(c){if(this.handleRenderLoadMessage){c.trigger("handle-render-load",this.handleRenderLoadMessage)}},"set-parent":function(c){if(this.parentElement){this.parentElement.removeChild(this.element)}this.parentElement=c;this.parentElement.appendChild(this.element)},"handle-render":function(e){var c=0,d=this.className;if(this.stateChange&&this.updateClassName){for(c in this.states){if(this.states[c]){d+=" "+c}}this.element.className=d;this.stateChange=false}},"set-attribute":function(d){var c=null;if(d.attribute){this.element.setAttribute(d.attribute,d.value)}else{for(c in d){this.element.setAttribute(c,d[c])}}},"set-style":function(d){var c=null;if(d.attribute){this.element.style[d.attribute]=d.value}else{for(c in d){this.element.style[c]=d[c]}}},"update-content":function(d){var c=d;if(c&&(typeof c.text==="string")){c=c.text}if((typeof c==="string")&&(c!==this.element.innerHTML)){this.element.innerHTML=c}},"logical-state":function(d){for(var c in d){if(this.states[c]!==d[c]){this.stateChange=true;this.states[c]=d[c]}}}},methods:{destroy:function(){if(this.parentElement){this.parentElement.removeChild(this.element);this.parentElement=undefined}if(this.owner.element===this.element){this.owner.element=undefined}this.element=undefined}}})})();(function(){var b=function(c){if(typeof c==="string"){return function(f,e){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger(c,f,e)}}}else{return function(g,f){for(var h in c){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger(c[h],g,f)}}}}};return a.createComponentClass({id:"entity-container",constructor:function(d){var c=this;this.entities=[];this.definedEntities=d.entities;this.owner.entities=c.entities;if(d.childEvents){for(var e in d.childEvents){this[d.childEvents[e]]=b(d.childEvents[e]);this.addListener(d.childEvents[e])}}},events:{load:function(){var f=0,d=0,c=0,g=this.definedEntities,e=null;this.definedEntities=false;if(g){for(f=0;f<g.length;f++){e={properties:{parent:this.owner}};for(d in g[f]){if(d==="properties"){for(c in g[f].properties){e.properties[c]=g[f].properties[c]}}else{e[d]=g[f][d]}}this.addEntity(new a.classes.entity(g[f].id?g[f]:a.settings.entities[g[f].type],e))}}},"add-entity":function(d){d.parent=this.owner;d.trigger("adopted");for(var c=0;c<this.entities.length;c++){d.trigger("peer-entity-added",this.entities[c])}for(var c=0;c<this.entities.length;c++){this.entities[c].trigger("peer-entity-added",d)}this.entities.push(d);this.owner.trigger("child-entity-added",d);return d},"remove-entity":function(d){for(var c=0;c<this.entities.length;c++){if(this.entities[c]===d){for(var e=0;e<this.entities.length;e++){if(c!==e){this.entities[e].trigger("peer-entity-removed",d)}}d.parent=null;this.entities.splice(c,1);this.owner.trigger("child-entity-removed",d);d.destroy();return d}}return false}},methods:{destroy:function(){for(var c in this.entities){this.entities[c].destroy()}this.entities.length=0}},publicMethods:{addEntity:function(c){return this["add-entity"](c)},removeEntity:function(c){return this["remove-entity"](c)}}})})();(function(){var c=function(n,m){var l=m.x-n.x,o=m.y-n.y;return Math.sqrt(l*l+o*o)},f=function(o,m,r){var l=m.x-o.x,q=m.y-o.y,n=0,p=Math.PI*2;if(!r){return n}n=Math.acos(l/r);if(q<0){n=p-n}return n},i=[null,null,null,null,["east","south","west","north"],null,null,null,["east","southeast","south","southwest","west","northwest","north","northeast"],null,null,null,null,null,null,null,["east","east-southeast","southeast","south-southeast","south","south-southwest","southwest","west-southwest","west","west-northwest","northwest","north-northwest","north","north-northeast","northeast","east-northeast"]],e=["left-button","middle-button","right-button"],d=function(m,l){this.event=m;this.trigger=l;this.filters=false;this.current=false;this.last=false;this.state=false;this.stateSummary={pressed:false,released:false,triggered:false,over:false}},g=function(l){if(l.length){return function(n){for(var m=0;m<l.length;m++){l[m].state=false}}}else{return function(m){l.state=false}}},h=function(l){if(l.length){return function(n){for(var m=0;m<l.length;m++){l[m].current=true;l[m].state=true;if(n&&(typeof(n.over)!=="undefined")){l[m].over=n.over}}}}else{return function(m){l.current=true;l.state=true;if(m&&(typeof(m.over)!=="undefined")){l.over=m.over}}}},k=function(n,o,m,l){var p=n[o];if(!p){p=n[o]=new d(o,m)}if(l){p.setFilter(l)}return p},b=d.prototype;b.update=function(){var l=0;if(this.current||this.last){this.stateSummary.pressed=this.current;this.stateSummary.released=!this.current&&this.last;this.stateSummary.triggered=this.current&&!this.last;this.stateSummary.over=this.over;if(this.filters){for(;l<this.filters.length;l++){if(this.stateSummary[this.filters[l]]){this.trigger(this.event,this.stateSummary)}}}else{this.trigger(this.event,this.stateSummary)}}this.last=this.current;this.current=this.state};b.setFilter=function(l){if(!this.filters){this.filters=[l]}else{this.filters.push(l)}return this};b.isPressed=function(){return this.current};b.isTriggered=function(){return this.current&&!this.last};b.isReleased=function(){return !this.current&&this.last};return a.createComponentClass({id:"entity-controller",constructor:function(r){var q=0,o=0,m=0,p="",s=undefined,l=this,n=function(t,u){if(!l.paused){l.owner.trigger(t,u)}};this.paused=r.paused||false;if(r&&r.controlMap){this.owner.controlMap=r.controlMap;this.actions={};for(p in r.controlMap){if(typeof r.controlMap[p]==="string"){s=k(this.actions,r.controlMap[p],n)}else{s=[];if(r.controlMap[p].length){for(q=0;q<r.controlMap[p].length;q++){s[q]=k(this.actions,r.controlMap[p][q],n)}}else{m=0;for(o in r.controlMap[p]){if(typeof r.controlMap[p][o]==="string"){s[m]=k(this.actions,r.controlMap[p][o],n,o);m+=1}else{for(q=0;q<r.controlMap[p][o].length;q++){s[m]=k(this.actions,r.controlMap[p][o][q],n,o);m+=1}}}}}this[p+":up"]=g(s);this[p+":down"]=h(s);this.addListener(p+":up");this.addListener(p+":down")}}if(r.joystick){this.joystick={};this.joystick.directions=r.joystick.directions||4;this.joystick.handleEdge=r.joystick.handleEdge||false;this.joystick.innerRadius=r.joystick.innerRadius||0;this.joystick.outerRadius=r.joystick.outerRadius||Infinity}},events:{"handle-controller":function(){var l="";if(this.actions){for(l in this.actions){this.actions[l].update()}}},mousedown:function(l){this.owner.trigger("mouse:"+e[l.event.button||0]+":down",l.event);if(this.joystick){this.owner.trigger("joystick:down",l.event);this.handleJoy(l)}},mouseup:function(l){this.owner.trigger("mouse:"+e[l.event.button||0]+":up",l.event);if(this.joystick){this.owner.trigger("joystick:up",l.event);this.handleJoy(l)}},mousemove:function(l){if(this.actions["mouse:left-button"]&&(this.actions["mouse:left-button"].over!==l.over)){this.actions["mouse:left-button"].over=l.over}if(this.actions["mouse:middle-button"]&&(this.actions["mouse:middle-button"].over!==l.over)){this.actions["mouse:middle-button"].over=l.over}if(this.actions["mouse:right-button"]&&(this.actions["mouse:right-button"].over!==l.over)){this.actions["mouse:right-button"].over=l.over}if(this.joystick){this.handleJoy(l)}},"pause-controls":function(){this.paused=true},"unpause-controls":function(){this.paused=false}},methods:{handleJoy:function(n){var m=Math.PI/(this.joystick.directions/2),q=c(this.owner,n),l=0,p="",o="";if((q>this.joystick.outerRadius)||(q<this.joystick.innerRadius)){return}else{if(!this.paused){l=f(this.owner,n,q);p=i[this.joystick.directions][Math.floor(((l+m/2)%(Math.PI*2))/m)];if(this.joystick.handleEdge){m=Math.PI/this.joystick.directions;o=i[this.joystick.directions*2][Math.floor(((l+m/2)%(Math.PI*2))/m)];if(o!==p){this.owner.trigger(o.replace(p,"").replace("-",""),n)}}this.owner.trigger(p,n);this.owner.trigger("joystick-orientation",l)}}}}})})();(function(){var c=false,d=null,b=function(){c=false;d.className=d.className.replace(/ full-screen/g,"");a.game.bindings.resize.callback()},e=function(){if(c){if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.exitFullscreen){document.exitFullscreen()}}}b()}else{c=true;d.className+=" full-screen";if(d.webkitRequestFullscreen){if(!a.settings.supports.safari||a.settings.supports.chrome){d.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}else{if(d.mozRequestFullScreen){d.mozRequestFullScreen()}else{if(d.requestFullscreen){d.requestFullscreen()}}}a.game.bindings.resize.callback()}};document.addEventListener("fullscreenchange",function(f){if(!document.fullscreenElement){b()}});document.addEventListener("webkitfullscreenchange",function(f){if(!document.webkitFullscreenElement){b()}});document.addEventListener("mozfullscreenchange",function(f){if(!document.mozFullScreenElement){b()}});return a.createComponentClass({id:"fullscreen",constructor:function(f){if(!d){d=a.game.containerElement}},events:{"toggle-fullscreen":e}})})();(function(){var b=function(c){return function(e,d){this.owner.trigger(c[Math.floor(Math.random()*c.length)],e,d)}};return a.createComponentClass({id:"random-events",constructor:function(c){if(c.events){for(var d in c.events){this[d]=b(c.events[d]);this.addListener(d)}}}})})();(function(){var c={aabb:"255,128,255",render:"128,128,128",collision:"255,0,255",group:"0,255,0"},b=function(e,h,g,d,l,i,k){var f=null;switch(e){case"rectangle":f=new createjs.Shape((new createjs.Graphics()).beginFill("rgba("+c[h]+",0.1)").setStrokeStyle(3).beginStroke("rgb("+c[h]+")").rect(0,0,g,d));l+=g/2;i+=d/2;break;case"circle":l+=g/2;i+=g/2;f=new createjs.Shape((new createjs.Graphics()).beginFill("rgba("+c[h]+",0.1)").setStrokeStyle(3).beginStroke("rgb("+c[h]+")").drawCircle(g/2,g/2,g));break}f.regX=l;f.regY=i;f.z=k;return f};return a.createComponentClass({id:"render-debug",constructor:function(d){if(d.acceptInput){this.hover=d.acceptInput.hover||false;this.click=d.acceptInput.click||false}else{this.hover=false;this.click=false}this.regX=d.regX||0;this.regY=d.regY||0;this.stage=undefined;this.shapes=[]},events:{"handle-render-load":function(f){var o=this,m=(this.owner.z||0)+10000,k=0,g=0,e=this.owner.width=this.owner.width||300,n=this.owner.height=this.owner.height||100,l=false,d=null,h=null;this.stage=f.stage;if(this.owner.getAABB){for(g=0;g<this.owner.collisionTypes.length;g++){h=this.owner.getAABB(this.owner.collisionTypes[g]);e=this.initialWidth=h.width;n=this.initialHeight=h.height;d=this.owner.getShapes(this.owner.collisionTypes[g]);this.shapes.push(b("rectangle","aabb",e,n,this.owner.x-h.x,this.owner.y-h.y,m--));this.stage.addChild(this.shapes[this.shapes.length-1]);for(k=0;k<d.length;k++){this.shapes.push(b(d[k].type,"collision",d[k].radius||d[k].width,d[k].height,-d[k].offsetX,-d[k].offsetY,m--));this.stage.addChild(this.shapes[this.shapes.length-1])}}}else{this.shapes.push(b("rectangle","render",e,n,e/2,n/2,m--));this.stage.addChild(this.shapes[0])}if(this.click&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.shapes[0].onPress=function(i){if(this.click){o.owner.trigger("mousedown",{event:i.nativeEvent,over:l,x:i.stageX,y:i.stageY,entity:o.owner});i.onMouseUp=function(p){o.owner.trigger("mouseup",{event:p.nativeEvent,over:l,x:p.stageX,y:p.stageY,entity:o.owner})};i.onMouseMove=function(p){o.owner.trigger("mousemove",{event:p.nativeEvent,over:l,x:p.stageX,y:p.stageY,entity:o.owner})}}if(i.nativeEvent.button==2){console.log("This Entity:",o.owner)}};if(this.click){this.shapes[0].onMouseOut=function(){l=false};this.shapes[0].onMouseOver=function(){l=true}}if(this.hover){this.stage.enableMouseOver();this.shapes[0].onMouseOut=function(i){l=false;o.owner.trigger("mouseout",{event:i.nativeEvent,over:l,x:i.stageX,y:i.stageY,entity:o.owner})};this.shapes[0].onMouseOver=function(i){l=true;o.owner.trigger("mouseover",{event:i.nativeEvent,over:l,x:i.stageX,y:i.stageY,entity:o.owner})}}if(!a.settings.debug){this.owner.removeComponent(this)}},"handle-render":function(){var e=0;for(e=0;e<this.shapes.length;e++){this.shapes[e].x=this.owner.x;this.shapes[e].y=this.owner.y}if(this.owner.getCollisionGroupAABB){var d=this.owner.getCollisionGroupAABB();if(!this.groupShape){this.groupShape=new createjs.Shape((new createjs.Graphics()).beginFill("rgba(255,255,0,0.2)").rect(0,0,1,1));this.groupShape.regX=0.5;this.groupShape.regY=0.5;this.groupShape.z=(this.owner.z||0)+10000;this.stage.addChild(this.groupShape);console.log(d)}this.groupShape.scaleX=d.width;this.groupShape.scaleY=d.height;this.groupShape.x=d.x;this.groupShape.y=d.y}}},methods:{destroy:function(){var d=0;for(d=0;d<this.shapes.length;d++){this.stage.removeChild(this.shapes[d])}this.shapes.length=0;this.stage=undefined}}})})();(function(){var d=function(g){var e=[document.createElement("canvas"),document.createElement("canvas")],f=0;if(!g.___cache){g.___cache=g.cache;g.cache=function(i,m,k,h,l){f=1-f;this.cacheCanvas=e[f];this.___cache(i,m,k,h,l)}}return g},c={x:1,y:1,t:-1,r:0},b=function(h){var g=+(h.substring(4)),i=c,f=!!(536870912&g),e=!!(1073741824&g),k=!!(2147483648&g);i.t=268435455&g;i.x=1;i.y=1;i.r=0;if(f||e||k){if(f&&e&&k){i.x=-1;i.r=90}else{if(f&&k){i.r=90}else{if(e&&k){i.r=180}else{if(f&&e){i.r=270}else{if(f){i.y=-1;i.r=90}else{if(e){i.y=-1}else{if(k){i.x=-1}}}}}}}}return i};return a.createComponentClass({id:"render-tiles",constructor:function(l){var f=0,e=l.spriteSheet.images.slice(),i=null,k=1,h=1;if(e[0]&&(typeof e[0]==="string")){e=e.slice();for(f=0;f<e.length;f++){if(a.assets[e[f]]){e[f]=a.assets[e[f]]}}}i={images:e,frames:l.spriteSheet.frames,animations:l.spriteSheet.animations};k=i.images[0].scaleX||1;h=i.images[0].scaleY||1;if((k!==1)||(h!==1)){i.frames={width:i.frames.width*k,height:i.frames.height*h,regX:i.frames.regX*k,regY:i.frames.regY*h}}this.controllerEvents=undefined;this.spriteSheet=new createjs.SpriteSheet(i);this.imageMap=l.imageMap||[];this.tiles={};this.tilesToRender=undefined;this.scaleX=((l.scaleX||1)*(this.owner.scaleX||1))/k;this.scaleY=((l.scaleY||1)*(this.owner.scaleY||1))/h;this.tileWidth=l.tileWidth||(this.owner.tileWidth/this.scaleX)||10;this.tileHeight=l.tileHeight||(this.owner.tileHeight/this.scaleY)||10;this.worldWidth=this.tilesWidth=this.tileWidth;this.worldHeight=this.tilesHeight=this.tileHeight;var g=(l.buffer||(this.tileWidth*3/4))*this.scaleX;this.camera={x:-g-1,y:-g-1,buffer:g};this.cache={minX:-1,minY:-1,maxX:-1,maxY:-1};this.doubleBuffer=[null,null];this.currentBuffer=0},events:{"handle-render-load":function(k){var e=0,l=0,h=this.stage=k.stage,g="",f=this.imageMap,i=[];this.tilesToRender=d(new createjs.Container());this.tilesToRender.name="entity-managed";for(e=0;e<f.length;e++){i[e]=[];for(l=0;l<f[e].length;l++){i[e][l]=g=f[e][l];if(!this.tiles[g]){this.tiles[g]=this.createTile(g)}}}this.imageMap=i;this.tilesWidth=e*this.tileWidth;this.tilesHeight=l*this.tileHeight;this.tilesToRender.scaleX=this.scaleX;this.tilesToRender.scaleY=this.scaleY;this.tilesToRender.z=this.owner.z;h.addChild(this.tilesToRender)},"add-tiles":function(h){var e=0,k=0,i=h.imageMap,f="",g=0;if(i){for(e=0;e<this.imageMap.length;e++){for(k=0;k<this.imageMap[e].length;k++){g=i[e][k];f=this.imageMap[e][k];if(this.tiles[f]){delete this.tiles[f]}f=this.imageMap[e][k]+=" "+g;if(!this.tiles[f]){this.tiles[f]=this.createTile(f)}}}}},"camera-loaded":function(e){this.worldWidth=e.width;this.worldHeight=e.height},"camera-update":function(p){var h=0,g=0,o=this.camera.buffer,i=this.cache,e=null,f=null,m=0,k=0,t=0,r=0,u=0,s=0,v=this.convertCamera(p.viewportLeft,this.worldWidth,this.tilesWidth,p.viewportWidth),n=this.convertCamera(p.viewportTop,this.worldHeight,this.tilesHeight,p.viewportHeight),q=Math.floor(v/this.tileWidth)*this.tileWidth,l=Math.floor(n/this.tileHeight)*this.tileHeight,w=null;this.tilesToRender.x=p.viewportLeft-v;this.tilesToRender.y=p.viewportTop-n;if(((Math.abs(this.camera.x-q)>o)||(Math.abs(this.camera.y-l)>o))&&(this.imageMap.length>0)){this.camera.x=q;this.camera.y=l;t=Math.min(Math.ceil((q+p.viewportWidth+o)/(this.tileWidth*this.scaleX)),this.imageMap.length)-1;u=Math.max(Math.floor((q-o)/(this.tileWidth*this.scaleX)),0);r=Math.min(Math.ceil((l+p.viewportHeight+o)/(this.tileHeight*this.scaleY)),this.imageMap[0].length)-1;s=Math.max(Math.floor((l-o)/(this.tileHeight*this.scaleY)),0);if((r>i.maxY)||(s<i.minY)||(t>i.maxX)||(u<i.minX)){if(this.tilesToRender.cacheCanvas){f=this.tilesToRender.cacheCanvas;this.tilesToRender.uncache()}this.tilesToRender.removeChildAt(0);this.tilesToRender.cache(u*this.tileWidth,s*this.tileHeight,(t-u+1)*this.tileWidth,(r-s+1)*this.tileHeight,1);for(h=u;h<=t;h++){for(g=s;g<=r;g++){if((g>i.maxY)||(g<i.minY)||(h>i.maxX)||(h<i.minX)){w=this.tiles[this.imageMap[h][g]];this.tilesToRender.removeChildAt(0);this.tilesToRender.addChild(w);w.x=(h+0.5)*this.tileWidth;w.y=(g+0.5)*this.tileHeight;this.tilesToRender.updateCache("source-over")}}}if(f){e=this.tilesToRender.cacheCanvas.getContext("2d");m=(i.maxX-i.minX+1)*this.tileWidth;k=(i.maxY-i.minY+1)*this.tileHeight;e.drawImage(f,0,0,m,k,(i.minX-u)*this.tileWidth,(i.minY-s)*this.tileHeight,m,k);i.minX=u;i.minY=s;i.maxX=t;i.maxY=r}}}}},methods:{convertCamera:function(h,f,g,e){if((f/this.scaleX)==g){return h}else{return h*(g-e)/((f/this.scaleX)-e)}},createTile:function(k){var g=1,l=k.split(" "),e=null,h=new createjs.BitmapAnimation(this.spriteSheet),f=b(l[0]);h.x=0;h.y=0;h.regX=this.tileWidth/2;h.regY=this.tileHeight/2;h.scaleX=f.x;h.scaleY=f.y;h.rotation=f.r;h.gotoAndStop("tile"+f.t);for(;g<l.length;g++){if(l[g]!=="tile-1"){if(!e){e=new createjs.Container();e.addChild(h);e.cache(-this.tileWidth/2,-this.tileHeight/2,this.tileWidth,this.tileHeight,1)}f=b(l[g]);h.scaleX=f.x;h.scaleY=f.y;h.rotation=f.r;h.gotoAndStop("tile"+f.t);e.updateCache("source-over")}}if(e){return e}else{h.cache(0,0,this.tileWidth,this.tileHeight,1);return h}},destroy:function(){this.tilesToRender.removeAllChildren();this.stage.removeChild(this.tilesToRender);this.imageMap.length=0;this.tiles=undefined;this.camera=undefined;this.stage=undefined;this.tilesToRender=undefined}}})})();(function(){var c=function(d){return function(e){if(this.animationFinished||(this.lastState>=-1)){this.currentAnimation=d;this.lastState=-1;this.animationFinished=false;this.anim.gotoAndPlay(d)}else{this.waitingAnimation=d;this.waitingState=-1}}},b=function(e,f){var d=e.replace(/ /g,"").split(",");if(e==="default"){return function(g){return f}}else{return function(h){for(var g=0;g<d.length;g++){if(!h[d[g]]){return false}}return f}}};return a.createComponentClass({id:"render-animation",constructor:function(e){var p={images:e.spriteSheet.images.slice(),frames:e.spriteSheet.frames,animations:e.spriteSheet.animations},r=this,n=0,f="",m="",d=e.animationMap,l=0,k=0;this.rotate=e.rotate||false;this.mirror=e.mirror||false;this.flip=e.flip||false;if(e.acceptInput){this.hover=e.acceptInput.hover||false;this.click=e.acceptInput.click||false;this.touch=e.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.followThroughs={};if(!d){d={};for(n in p.animations){d[n]=n}}this.checkStates=[];for(var g in d){this.addListener(g);f=d[g];if(f[f.length-1]==="!"){f=f.substring(0,f.length-1);this.followThroughs[f]=true}else{this.followThroughs[f]=false}this[g]=c(f);this.checkStates.push(b(g,f))}m=f;this.stage=undefined;for(n=0;n<p.images.length;n++){p.images[n]=a.assets[p.images[n]]}var q=p.images[0].scaleX||1,o=p.images[0].scaleY||1;if((q!==1)||(o!==1)){if(p.frames.length){var h=[];l=[];k=[];for(var g=0;g<p.frames.length;g++){h.push([p.frames[g][0]*q,p.frames[g][1]*o,p.frames[g][2]*q,p.frames[g][3]*o,p.frames[g][4],p.frames[g][5]*q,p.frames[g][6]*o]);l.push(p.frames[g][5]);k.push(p.frames[g][6])}p.frames=h}else{l=p.frames.regX;k=p.frames.regY;p.frames={width:p.frames.width*q,height:p.frames.height*o,regX:p.frames.regX*q,regY:p.frames.regY*o}}}else{if(p.frames.length){l=[];k=[];for(var g=0;g<p.frames.length;g++){l.push(p.frames[g][5]);k.push(p.frames[g][6])}}else{l=p.frames.regX;k=p.frames.regY}}p=new createjs.SpriteSheet(p);this.anim=new createjs.BitmapAnimation(p);if(e.pins){this.container=new createjs.Container();this.container.addChild(this.anim);this.anim.z=0;this.addPins(e.pins,l,k)}else{this.container=this.anim}this.pinTo=e.pinTo||false;if(this.pinTo){this.owner.trigger("pin-me",this.pinTo)}this.anim.onAnimationEnd=function(s,i){r.owner.trigger("animation-ended",i);if(r.waitingAnimation){r.currentAnimation=r.waitingAnimation;r.waitingAnimation=false;r.lastState=r.waitingState;r.animationFinished=false;r.anim.gotoAndPlay(r.currentAnimation)}else{r.animationFinished=true}};this.anim.hidden=e.hidden||false;this.currentAnimation=d["default"]||m;this.forcePlaythrough=this.owner.forcePlaythrough||e.forcePlaythrough||false;this.worldScaleX=e.scaleX;this.worldScaleY=e.scaleY;this.imageScaleX=q;this.imageScaleY=o;this.lastOwnerScaleX=this.owner.scaleX;this.lastOwnerScaleY=this.owner.scaleY;this.container.scaleX=(this.worldScaleX||1)*(this.owner.scaleX||1);this.container.scaleY=(this.worldScaleY||1)*(this.owner.scaleY||1);this.anim.scaleX/=this.imageScaleX;this.anim.scaleY/=this.imageScaleY;this.scaleX=this.container.scaleX;this.scaleY=this.container.scaleY;this.skewX=this.owner.skewX||e.skewX;this.skewY=this.owner.skewY||e.skewY;this.offsetZ=e.offsetZ||0;this.state=this.owner.state;this.stateChange=false;this.lastState=-1;this.waitingAnimation=false;this.waitingState=0;this.playWaiting=false;this.animationFinished=false;if(this.currentAnimation){this.anim.gotoAndPlay(this.currentAnimation)}this["logical-state"](this.state)},events:{"handle-render-load":function(d){if(!this.pinTo){this.stage=d.stage;if(!this.stage){return}this.stage.addChild(this.container);this.addInputs()}else{return}},"handle-render":(function(){var d=function(f,e){return f.z-e.z};return function(h){var e=false,f=0,g=null;if(!this.stage){if(!this.pinTo){this["handle-render-load"](h);if(!this.stage){console.warn('No CreateJS Stage, removing render component from "'+this.owner.type+'".');this.owner.removeComponent(this);return}}else{return}}if(this.pinnedTo){if(this.pinnedTo.frames&&this.pinnedTo.frames[this.pinnedTo.animation.currentFrame]){this.container.x=this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].x;this.container.y=this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].y;if(this.container.z!==this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].z){this.stage.reorder=true;this.container.z=this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].z}this.container.visible=true}else{if(this.pinnedTo.defaultPin){this.container.x=this.pinnedTo.defaultPin.x;this.container.y=this.pinnedTo.defaultPin.y;if(this.container.z!==this.pinnedTo.defaultPin.z){this.stage.reorder=true;this.container.z=this.pinnedTo.defaultPin.z}this.container.visible=true}else{this.container.visible=false}}}else{this.container.x=this.owner.x;this.container.y=this.owner.y;if(this.container.z!==(this.owner.z+this.offsetZ)){this.stage.reorder=true;this.container.z=(this.owner.z+this.offsetZ)}if(this.owner.opacity||(this.owner.opacity===0)){this.container.alpha=this.owner.opacity}}if(this.container.reorder){this.container.reorder=false;this.container.sortChildren(d)}if(this.skewX){this.container.skewX=this.skewX}if(this.skewY){this.container.skewY=this.skewY}if(this.owner.scaleX!=this.lastOwnerScaleX||this.owner.scaleY!=this.lastOwnerScaleY){this.container.scaleX=(this.worldScaleX||1)*(this.owner.scaleX||1);this.container.scaleY=(this.worldScaleY||1)*(this.owner.scaleY||1);this.anim.scaleX/=this.imageScaleX;this.anim.scaleY/=this.imageScaleY;this.scaleX=this.container.scaleX;this.scaleY=this.container.scaleY;this.lastOwnerScaleX=this.owner.scaleX;this.lastOwnerScaleY=this.owner.scaleY}if(this.rotate||this.mirror||this.flip){g=((this.owner.orientation*180)/Math.PI+360)%360;if(this.rotate){this.container.rotation=g}if(this.mirror){if((g>90)&&(g<270)){this.container.scaleX=-this.scaleX}else{this.container.scaleX=this.scaleX}}if(this.flip){if(g>180){this.container.scaleY=this.scaleY}else{this.container.scaleY=-this.scaleY}}}if(this.stateChange){if(this.checkStates){for(;f<this.checkStates.length;f++){e=this.checkStates[f](this.state);if(e){if(this.currentAnimation!==e){if(!this.followThroughs[this.currentAnimation]&&(!this.forcePlaythrough||(this.animationFinished||(this.lastState>=+f)))){this.currentAnimation=e;this.lastState=+f;this.animationFinished=false;this.anim.gotoAndPlay(e)}else{this.waitingAnimation=e;this.waitingState=+f}}else{if(this.waitingAnimation&&!this.followThroughs[this.currentAnimation]){this.waitingAnimation=false}}break}}}this.stateChange=false}}})(),"logical-state":function(d){this.stateChange=true;if(d.hidden!==undefined){this.container.hidden=d.hidden}},"hide-animation":function(){this.container.hidden=true},"show-animation":function(){this.container.hidden=false},"pin-me":function(d){if(this.pins&&this.pins[d]){this.owner.trigger("attach-pin",this.pins[d])}},"attach-pin":function(d){if(d.pinId===this.pinTo){this.stage=d.container;this.stage.addChild(this.container);this.addInputs();this.pinnedTo=d}},"remove-pin":function(d){if(d.pinId===this.pinTo){this.stage.removeChild(this.container);this.stage=null;this.pinnedTo=null}}},methods:{addInputs:function(){var d=this,e=false;if(this.click||this.touch){if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.anim.addEventListener("mousedown",function(f){d.owner.trigger("mousedown",{event:f.nativeEvent,over:e,x:f.stageX,y:f.stageY,entity:d.owner});f.addEventListener("mouseup",function(g){d.owner.trigger("mouseup",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})});f.addEventListener("mousemove",function(g){d.owner.trigger("mousemove",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})})});this.anim.addEventListener("mouseout",function(){e=false});this.anim.addEventListener("mouseover",function(){e=true})}if(this.hover){this.stage.enableMouseOver();this.anim.addEventListener("mouseout",function(f){e=false;d.owner.trigger("mouseout",{event:f.nativeEvent,over:e,x:f.stageX,y:f.stageY,entity:d.owner})});this.anim.addEventListener("mouseover",function(f){e=true;d.owner.trigger("mouseover",{event:f.nativeEvent,over:e,x:f.stageX,y:f.stageY,entity:d.owner})})}},addPins:function(f,l,e){var h=0,g=0,d=null,m=0,k=0,n=!((typeof l==="number")&&(typeof e==="number"));if(!n){m=l;k=e}this.pinsToRemove=this.pinsToRemove||[];this.pins={};for(;h<f.length;h++){this.pinsToRemove.push(f[h].pinId);if(n){m=l[h];k=e[h]}this.pins[f[h].pinId]=d={pinId:f[h].pinId,animation:this.anim,container:this.container};if((typeof f[h].x==="number")&&(typeof f[h].y==="number")){d.defaultPin={x:(f[h].x-m),y:(f[h].y-k),z:f[h].z||1e-8}}if(f[h].frames){d.frames=[];for(g=0;g<f[h].frames.length;g++){if(f[h].frames[g]){if((typeof f[h].frames[g].x==="number")&&(typeof f[h].frames[g].y==="number")){d.frames.push({x:(f[h].frames[g].x-m),y:(f[h].frames[g].y-k),z:f[h].frames[g].z||(d.defaultPin?d.defaultPin.z:1e-8)})}else{if(d.defaultPin){if(typeof f[h].frames[g].x==="number"){d.frames.push({x:(f[h].frames[g].x-m),y:d.defaultPin.y,z:f[h].frames[g].z||d.defaultPin.z})}else{if(typeof f[h].frames[g].y==="number"){d.frames.push({x:d.defaultPin.x,y:(f[h].frames[g].y-k),z:f[h].frames[g].z||d.defaultPin.z})}else{d.frames.push(null)}}}else{d.frames.push(null)}}}else{d.frames.push(null)}}}this.owner.trigger("attach-pin",d)}},removePins:function(){var d=0;if(this.pins&&this.pinsToRemove){for(;d<this.pinsToRemove.length;d++){this.owner.trigger("remove-pin",this.pins[this.pinsToRemove[d]].pinId);delete this.pins[this.pinsToRemove[d]]}this.pinsToRemove.length=0}},destroy:function(){if(this.stage){this.stage.removeChild(this.container);this.stage=undefined}this.removePins();this.followThroughs=null;this.anim=undefined;this.container=undefined}}})})();(function(){return a.createComponentClass({id:"render-image",constructor:function(d){var f=d.image,e=d.source;this.rotate=d.rotate||false;this.mirror=d.mirror||false;this.flip=d.flip||false;if(d.acceptInput){this.hover=d.acceptInput.hover||false;this.click=d.acceptInput.click||false;this.touch=d.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.stage=undefined;this.image=new createjs.Bitmap(a.assets[f]);var c=a.assets[f].scaleX||1,b=a.assets[f].scaleY||1;if(d.pins){this.container=new createjs.Container();this.container.addChild(this.image);this.image.z=0;this.addPins(d.pins,d.regX||0,d.regY||0)}else{this.container=this.image}this.pinTo=d.pinTo||false;if(this.pinTo){this.owner.trigger("pin-me",this.pinTo)}if(e){e.x=e.x||0;e.y=e.y||0;this.image.sourceRect=new createjs.Rectangle(e.x*c,e.y*b,e.width*c,e.height*b)}this.image.hidden=d.hidden||false;this.image.regX=(d.regX||0)*c;this.image.regY=(d.regY||0)*b;this.worldScaleX=d.scaleX;this.worldScaleY=d.scaleY;this.imageScaleX=c;this.imageScaleY=b;this.lastOwnerScaleX=this.owner.scaleX;this.lastOwnerScaleY=this.owner.scaleY;this.container.scaleX=(this.worldScaleX||1)*(this.owner.scaleX||1);this.container.scaleY=(this.worldScaleY||1)*(this.owner.scaleY||1);this.image.scaleX/=this.imageScaleX;this.image.scaleY/=this.imageScaleY;this.scaleX=this.container.scaleX;this.scaleY=this.container.scaleY;this.skewX=this.owner.skewX||d.skewX;this.skewY=this.owner.skewY||d.skewY;this.offsetZ=d.offsetZ||0},events:{"handle-render-load":function(b){if(!this.pinTo){this.stage=b.stage;if(!this.stage){return}this.stage.addChild(this.container);this.addInputs()}else{return}},"handle-render":(function(){var b=function(d,c){return d.z-c.z};return function(d){var c=null;if(!this.stage){if(!this.pinTo){this["handle-render-load"](d);if(!this.stage){console.warn('No CreateJS Stage, removing render component from "'+this.owner.type+'".');this.owner.removeComponent(this);return}}else{return}}if(this.pinnedTo){if(this.pinnedTo.frames&&this.pinnedTo.frames[this.pinnedTo.animation.currentFrame]){this.container.x=this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].x;this.container.y=this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].y;if(this.container.z!==this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].z){this.stage.reorder=true;this.container.z=this.pinnedTo.frames[this.pinnedTo.animation.currentFrame].z}this.container.visible=true}else{if(this.pinnedTo.defaultPin){this.container.x=this.pinnedTo.defaultPin.x;this.container.y=this.pinnedTo.defaultPin.y;if(this.container.z!==this.pinnedTo.defaultPin.z){this.stage.reorder=true;this.container.z=this.pinnedTo.defaultPin.z}this.container.visible=true}else{this.container.visible=false}}}else{this.container.x=this.owner.x;this.container.y=this.owner.y;if(this.container.z!==(this.owner.z+this.offsetZ)){this.stage.reorder=true;this.container.z=(this.owner.z+this.offsetZ)}if(this.owner.opacity||(this.owner.opacity===0)){this.container.alpha=this.owner.opacity}}if(this.container.reorder){this.container.reorder=false;this.container.sortChildren(b)}if(this.skewX){this.container.skewX=this.skewX}if(this.skewY){this.container.skewY=this.skewY}if(this.owner.scaleX!=this.lastOwnerScaleX||this.owner.scaleY!=this.lastOwnerScaleY){this.container.scaleX=(this.worldScaleX||1)*(this.owner.scaleX||1);this.container.scaleY=(this.worldScaleY||1)*(this.owner.scaleY||1);this.image.scaleX/=this.imageScaleX;this.image.scaleY/=this.imageScaleY;this.scaleX=this.container.scaleX;this.scaleY=this.container.scaleY;this.lastOwnerScaleX=this.owner.scaleX;this.lastOwnerScaleY=this.owner.scaleY}if(this.rotate||this.mirror||this.flip){c=((this.owner.orientation*180)/Math.PI+360)%360;if(this.rotate){this.container.rotation=c}if(this.mirror){if((c>90)&&(c<270)){this.container.scaleX=-this.scaleX}else{this.container.scaleX=this.scaleX}}if(this.flip){if(c>180){this.container.scaleY=this.scaleY}else{this.container.scaleY=-this.scaleY}}}}})(),"logical-state":function(b){if(b.hidden!==undefined){this.container.hidden=b.hidden}},"hide-image":function(){this.container.hidden=true},"show-image":function(){this.container.hidden=false},"pin-me":function(b){if(this.pins&&this.pins[b]){this.owner.trigger("attach-pin",this.pins[b])}},"attach-pin":function(b){if(b.pinId===this.pinTo){this.stage=b.container;this.stage.addChild(this.container);this.addInputs();this.pinnedTo=b}},"remove-pin":function(b){if(b.pinId===this.pinTo){this.stage.removeChild(this.container);this.stage=null;this.pinnedTo=null}}},methods:{addInputs:function(){var b=this,c=false;if(this.click||this.touch){if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.image.addEventListener("mousedown",function(d){b.owner.trigger("mousedown",{event:d.nativeEvent,over:c,x:d.stageX,y:d.stageY,entity:b.owner});d.addEventListener("mouseup",function(e){b.owner.trigger("mouseup",{event:e.nativeEvent,over:c,x:e.stageX,y:e.stageY,entity:b.owner})});d.addEventListener("mousemove",function(e){b.owner.trigger("mousemove",{event:e.nativeEvent,over:c,x:e.stageX,y:e.stageY,entity:b.owner})})});this.image.addEventListener("mouseout",function(){c=false});this.image.addEventListener("mouseover",function(){c=true})}if(this.hover){this.stage.enableMouseOver();this.image.addEventListener("mouseout",function(d){c=false;b.owner.trigger("mouseout",{event:d.nativeEvent,over:c,x:d.stageX,y:d.stageY,entity:b.owner})});this.image.addEventListener("mouseover",function(d){c=true;b.owner.trigger("mouseover",{event:d.nativeEvent,over:c,x:d.stageX,y:d.stageY,entity:b.owner})})}},addPins:function(e,f,d){var c=0,b=null;this.pinsToRemove=this.pinsToRemove||[];this.pins={};for(;c<e.length;c++){this.pinsToRemove.push(e[c].pinId);this.pins[e[c].pinId]=b={pinId:e[c].pinId,container:this.container,defaultPin:{x:e[c].x-f,y:e[c].y-d,z:e[c].z||1e-8}};this.owner.trigger("attach-pin",b)}},removePins:function(){var b=0;if(this.pins&&this.pinsToRemove){for(;b<this.pinsToRemove.length;b++){this.owner.trigger("remove-pin",this.pins[this.pinsToRemove[b]].pinId);delete this.pins[this.pinsToRemove[b]]}this.pinsToRemove.length=0}},destroy:function(){if(this.stage){this.stage.removeChild(this.container);this.stage=undefined}this.removePins();this.image=undefined;this.container=undefined}}})})();a.components["logic-button"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.state=this.owner.state;this.state.released=true;this.state.pressed=false;this.stateChange="";if(e.state==="pressed"){this.pressed()}if(e.toggle){this.toggle=true;this.addListener("mouseup")}else{this.addListeners(["mousedown","mouseup"])}this.addListeners(["handle-logic","pressed","released"])};var c=b.prototype;c.mousedown=c.pressed=function(){this.stateChange="pressed"};c.mouseup=function(){if(this.toggle){if(this.state.pressed){this.released()}else{this.pressed()}}else{this.released()}};c.released=function(){this.stateChange="released"};c["handle-logic"]=function(d){if(this.state.released&&(this.stateChange==="pressed")){this.stateChange="";this.state.pressed=true;this.state.released=false}if(this.state.pressed&&(this.stateChange==="released")){this.stateChange="";this.state.pressed=false;this.state.released=true}};c.destroy=function(){this.removeListeners(this.listeners);this.state=undefined;this.owner=undefined};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(i,h){d[e](i,h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();(function(){var c=function(d){if(d.singleInstance){return function(){var e=0,f=true;for(;e<this.queue.length;e++){if(this.queue[e]===d){f=false}}if(f){this.queue.push(d);this.queueTimes.push(d.delay)}}}else{return function(){this.queue.push(d);this.queueTimes.push(d.delay)}}},b=function(d){return function(){var e=this.queue.length-1;for(;e>-1;e--){if(this.queue[e]===d){this.queueTimes.splice(e,1);this.queue.splice(e,1)}}}};return a.createComponentClass({id:"logic-delay-message",constructor:function(d){this.queueTimes=[];this.queue=[];if(d.events){for(var e in d.events){this[e]=c(d.events[e]);this.addListener(e);if(d.events[e].cancelEvent){this[d.events[e].cancelEvent]=b(d.events[e]);this.addListener(d.events[e].cancelEvent)}}}},events:{"handle-logic":function(e){var d=this.queue.length-1;for(;d>-1;d--){this.queueTimes[d]-=e.deltaT;if(this.queueTimes[d]<=0){this.owner.trigger(this.queue[d].event,this.queue[d].message);this.queueTimes.splice(d,1);this.queue.splice(d,1)}}}},methods:{destroy:function(){this.queueTimes.length=0;this.queue.length=0}}})})();(function(){return a.createComponentClass({id:"logic-destroy-me",constructor:function(b){this.destroyed=false;this.delay=b.delay||0},events:{"handle-logic":function(b){var c=b.deltaT;if(this.destroyed){this.delay-=c;if(this.delay<=0){this.owner.parent.removeEntity(this.owner)}}},"destroy-me":function(){this.destroyed=true}}})})();(function(){var c=function(d){return function(e){if(e){this[d]=(e.pressed!==false)}else{this[d]=true}}},b=function(e,g){var d=Math.sqrt(e*e+g*g),f=0;if(d!=0){f=Math.acos(e/d);if(g<0){f=(Math.PI*2)-f}}return f};return a.createComponentClass({id:"logic-directional-movement",constructor:function(e){var d=this;this.speed=e.speed||0.3;this.boost=false;this.paused=false;if(e.pause||e.boost){if(typeof e.pause==="string"){this.pausers=[e.pause]}else{this.pausers=e.pause}this.addListener("logical-state");this["logical-state"]=function(h){var g=false;if(e.pause){for(var f=0;f<d.pausers.length;f++){g=g||h[d.pausers[f]]}this.paused=g}if(e.boost){if(d.boost){if(h[e.boost]===false){d.boost=false}}else{if(h[e.boost]===true){d.boost=true}}}}}this.state=this.owner.state;this.state.moving=false;this.state.left=false;this.state.right=false;this.state.up=false;this.state.down=false;this.owner.orientation=0;this.moving=false;this.left=false;this.right=false;this.up=false;this.down=false;this.upLeft=false;this.upRight=false;this.downLeft=false;this.downRight=false;this.facing="right"},events:{"handle-logic":function(i){var f=0,d=0,l=this.up||this.upLeft||this.downLeft,m=this.upLeft||(this.up&&this.left),h=this.left||this.upLeft||this.downLeft,n=this.downLeft||(this.down&&this.left),p=this.down||this.downLeft||this.downRight,g=this.downRight||(this.down&&this.right),o=this.right||this.upRight||this.downRight,k=this.upRight||(this.up&&this.right),e=0;if(l&&p){this.moving=false}else{if(h&&o){this.moving=false}else{if(m){f=-this.speed/1.414;d=-this.speed/1.414;this.moving=true;this.facing="up-left"}else{if(k){d=-this.speed/1.414;f=this.speed/1.414;this.moving=true;this.facing="up-right"}else{if(n){d=this.speed/1.414;f=-this.speed/1.414;this.moving=true;this.facing="down-left"}else{if(g){d=this.speed/1.414;f=this.speed/1.414;this.moving=true;this.facing="down-right"}else{if(h){f=-this.speed;this.moving=true;this.facing="left"}else{if(o){f=this.speed;this.moving=true;this.facing="right"}else{if(l){d=-this.speed;this.moving=true;this.facing="up"}else{if(p){d=this.speed;this.moving=true;this.facing="down"}else{this.moving=false;switch(this.facing){case"up":l=true;break;case"down":p=true;break;case"left":h=true;break;case"right":o=true;break;case"up-left":l=true;h=true;break;case"up-right":l=true;o=true;break;case"down-left":p=true;h=true;break;case"down-right":o=true;o=true;break}}}}}}}}}}}if(this.moving){if(!this.paused){if(this.boost){f*=1.5;d*=1.5}this.owner.x+=(f*i.deltaT);this.owner.y+=(d*i.deltaT)}e=b(f,d);if(this.owner.orientation!==e){this.owner.orientation=e}}if(this.state.moving!==this.moving){this.state.moving=this.moving}if(this.state.up!==l){this.state.up=l}if(this.state.right!==o){this.state.right=o}if(this.state.down!==p){this.state.down=p}if(this.state.left!==h){this.state.left=h}},"go-down":c("down"),"go-south":c("down"),"go-down-left":c("downLeft"),"go-southwest":c("downLeft"),"go-left":c("left"),"go-west":c("left"),"go-up-left":c("upLeft"),"go-northwest":c("upLeft"),"go-up":c("up"),"go-north":c("up"),"go-up-right":c("upRight"),"go-northeast":c("upRight"),"go-right":c("right"),"go-east":c("right"),"go-down-right":c("downRight"),"go-southeast":c("downRight"),stop:function(d){if(!d||(d.pressed!==false)){this.left=false;this.right=false;this.up=false;this.down=false;this.upLeft=false;this.upRight=false;this.downLeft=false;this.downRight=false}},accelerate:function(d){this.speed=d}}})})();(function(){return a.createComponentClass({id:"logic-gravity",constructor:function(b){this.vY=b.gravity||b.yGravity;if(typeof this.vY!=="number"){this.vY=0.01}this.vX=b.xGravity||0;this.maxVelocity=b.maxVelocity||0;this.newMaxX=this.maxVelocityX=b.maxVelocityX||this.maxVelocity;this.newMaxY=this.maxVelocityY=b.maxVelocityY||this.maxVelocity;this.accelerationX=0;this.accelerationY=0;this.durationX=0;this.durationY=0;if(typeof this.owner.dx!=="number"){this.owner.dx=0}if(typeof this.owner.dy!=="number"){this.owner.dy=0}this.state=this.owner.state;this.hovering=this.state.hovering=this.state.hovering||false;this.falling=this.state.falling=this.state.falling||false;this.grounded=this.state.grounded=this.state.grounded||!this.falling},events:{"handle-logic":function(c){var b=c.deltaT;if(!this.hovering){if(this.newMaxX!==this.maxVelocityX){if(this.durationX-b>0){this.maxVelocityX+=(this.newMaxX-this.maxVelocityX)*(b/this.durationX);this.durationX-=b}else{if(this.accelerationX){if(this.newMaxX>this.maxVelocityX){if(this.owner.dx>this.maxVelocityX){this.maxVelocityX=this.owner.dx}this.maxVelocityX=Math.min(this.maxVelocityX+(this.accelerationX*c.deltaT),this.newMaxX)}else{if(this.owner.dx<this.maxVelocityX){this.maxVelocityX=this.owner.dx}this.maxVelocityX=Math.max(this.maxVelocityX-(this.accelerationX*c.deltaT),this.newMaxX)}}else{this.maxVelocityX=this.newMaxX;this.durationX=0}}}if(this.newMaxY!==this.maxVelocityY){if(this.durationY-b>0){this.maxVelocityY+=(this.newMaxY-this.maxVelocityY)*(b/this.durationY);this.durationY-=b}else{if(this.accelerationY){if(this.newMaxY>this.maxVelocityY){if(this.owner.dy>this.maxVelocityY){this.maxVelocityY=this.owner.dy}this.maxVelocityY=Math.min(this.maxVelocityY+(this.accelerationY*c.deltaT),this.newMaxY)}else{if(this.owner.dy<this.maxVelocityY){this.maxVelocityY=this.owner.dy}this.maxVelocityY=Math.max(this.maxVelocityY-(this.accelerationY*c.deltaT),this.newMaxY)}}else{this.maxVelocityY=this.newMaxY;this.durationY=0}}}this.owner.dx+=this.vX*b;this.owner.dy+=this.vY*b;if(this.vX&&this.maxVelocityX&&(this.owner.dx>this.maxVelocityX)){this.owner.dx=this.maxVelocityX}if(this.vY&&this.maxVelocityY&&(this.owner.dy>this.maxVelocityY)){this.owner.dy=this.maxVelocityY}}if(this.state.hovering!==this.hovering){this.state.hovering=this.hovering}if(this.state.falling!==this.falling){this.state.falling=this.falling}if(this.state.grounded!==this.grounded){this.state.grounded=this.grounded}this.grounded=false;this.falling=true},"hit-solid":function(b){if(!this.hovering){if(((b.y>0)&&(this.vY>0))||((b.y<0)&&(this.vY<0))){this.owner.dy=0;this.falling=false;this.grounded=true}else{if(((b.x<0)&&(this.vX<0))||((b.x>0)&&(this.vX>0))){this.owner.dx=0;this.falling=false;this.grounded=true}}}return true},glide:function(e){var b=e.maxVelocity||this.maxVelocity,d=e.duration||0,c=e.acceleration||0;this.durationX=e.durationX||d;this.durationY=e.durationY||d;this.accelerationX=e.accelerationX||c;this.accelerationY=e.accelerationY||c;this.newMaxX=e.maxVelocityX||b||this.maxVelocityX;this.newMaxY=e.maxVelocityY||b||this.maxVelocityY;if(!this.durationX&&!this.accelerationX){this.maxVelocityX=this.newMaxX}if(!this.durationY&&!this.accelerationY){this.maxVelocityY=this.newMaxY}},gravitate:function(b){this.vY=b.gravity||b.yGravity||0;this.vX=b.xGravity||0},hover:function(b){this.owner.dx=0;this.owner.dy=0;this.hovering=!b||(b.pressed!==false)},fall:function(b){this.hovering=!!b&&(b.pressed===false)}},methods:{destroy:function(){this.owner.dx=0;this.owner.dy=0}}})})();(function(){return a.createComponentClass({id:"logic-rebounder",constructor:function(b){this.owner.dx=this.owner.dx||0;this.owner.dy=this.owner.dy||0;this.owner.mass=this.owner.mass||b.mass||1;this.elasticity=b.elasticity||0.8;this.v=new a.classes.vector2D(0,0);this.incidentVector=new a.classes.vector2D(0,0);this.staticCollisionOccurred=false;this.nonStaticCollisionOccurred=false;this.hitThisTick=[];this.otherVelocityData=null;this.otherV=new a.classes.vector2D(0,0);this.otherVelocityData=[]},events:{"handle-logic":function(b){this.hitThisTick=[];this.otherVelocityData=[]},"hit-static":function(c){var b=0;this.v.set(this.owner.dx,this.owner.dy);this.incidentVector.set(c.direction.x,c.direction.y);b=this.v.scalarProjection(this.incidentVector);if(!isNaN(b)){this.incidentVector.scale(b*(1+this.elasticity));this.v.subtractVector(this.incidentVector)}this.owner.dx=this.v.x;this.owner.dy=this.v.y},"hit-non-static":function(k){var g=k.entity;var d=false;var h=0;var e=0;var c=0;var b=0;var f=0;for(var i=0;i<this.hitThisTick.length;i++){if(g===this.hitThisTick[i]){return}}this.hitThisTick.push(g);for(var i=0;i<this.otherVelocityData.length;i++){if(g===this.otherVelocityData[i].entity){this.otherV.set(this.otherVelocityData[i].vX,this.otherVelocityData[i].vY);d=true;break}}if(!d){this.otherV.set(g.dx,g.dy);g.triggerEvent("share-velocity",this.owner)}this.v.set(this.owner.dx,this.owner.dy);this.incidentVector.set(k.direction.x,k.direction.y);c=this.v.scalarProjection(this.incidentVector);c=(isNaN(c))?0:c;b=this.otherV.scalarProjection(this.incidentVector);b=(isNaN(b))?0:b;f=(c*(this.owner.mass-g.mass)+2*g.mass*b)/(this.owner.mass+g.mass);this.incidentVector.scale(f-c);this.owner.dx+=this.incidentVector.x;this.owner.dy+=this.incidentVector.y},"share-velocity":function(b){this.otherVelocityData.push({entity:b,vX:b.dx,vY:b.dy})}},methods:{destroy:function(){this.v=null;this.otherV=null;this.incidentVector=null;this.hitThisTick=null}},publicMethods:{}})})();(function(){var e=function(f,g){return function(k){var h=null;for(h in f){g[h]=f[h]}}},b=function(g,f){return function(h){f[g]=true}},c=function(m,f,o,g,h,p,l){var k=0,n=false,q=g.message||(g.message===0)||(g.message===false);if(h){if(typeof g==="string"){p.trigger(g);n=true}else{if(g.length){for(k=0;k<g.length;k++){c(m,f,o,g[k],h,p,l)}n=true}else{if(g.event&&(q||g.delay)){if(g.delay){l.push(g)}else{p.trigger(g.event,g.message)}n=true}else{if(g["true"]){c(m,f,o,g["true"],h,p,l)}}}}}if(!n){for(k in g){if(k!=="true"){d(k,f,o,g[k],h,p,l)}}}},d=function(l,f,n,g,h,o,i){var k=h,m=false;if(l.charAt(0)==="!"){m=(f[l.substring(1)]===false);if((l!=="outputs")&&(n[l.substring(1)]!==f[l.substring(1)])){k=true}}else{m=(f[l]===true);if((l!=="outputs")&&(n[l]!==f[l])){k=true}}if(m||(l==="outputs")){c(l,f,n,g,k,o,i)}};return a.createComponentClass({id:"logic-state-machine",constructor:function(g){var f=null;this.state=this.owner.state;if(g.inputs){for(f in g.inputs){this.addListener(f);this[f]=e(g.inputs[f],this.state)}}this.sustainedState={};if(g["sustained-inputs"]){for(f in g["sustained-inputs"]){this.addListener(f);this[f]=b(g["sustained-inputs"][f],this.sustainedState);this.sustainedState[g["sustained-inputs"][f]]=false}}this.snapshot={};this.last={};this.tempQueue=[];this.queueTimes=[];this.queue=[];this.outputs=g.outputs||null},events:{"handle-logic":function(g){var f=null;for(f in this.sustainedState){if(this.owner.state[f]!==this.sustainedState[f]){this.owner.state[f]=this.sustainedState[f]}this.sustainedState[f]=false}for(f=this.queue.length-1;f>-1;f--){this.queueTimes[f]-=g.deltaT;if(this.queueTimes[f]<=0){this.owner.trigger(this.queue[f].event,this.queue[f].message);this.queueTimes.splice(f,1);this.queue.splice(f,1)}}},"update-state":function(g){var f=null;for(f in g){this.state[f]=g[f]}},"logical-state":function(g){var f=null;if(this.outputs){for(f in g){if(g[f]!==this.snapshot[f]){this.snapshot[f]=g[f]}}this.tempQueue.length=0;d("outputs",this.snapshot,this.last,this.outputs,false,this.owner,this.tempQueue);for(f=0;f<this.tempQueue.length;f++){this.queue.push(this.tempQueue[f]);this.queueTimes.push(this.tempQueue[f].delay)}for(f in this.snapshot){if(this.snapshot[f]!==this.last[f]){this.last[f]=this.snapshot[f]}}}}}})})();a.components["component-switcher"]=(function(){var b=function(f,e){return function(){var h=0,g=0;if(f.remove){if(typeof f.remove==="string"){for(h=e.components.length-1;h>-1;h--){if(e.components[h].type===f.remove){e.removeComponent(e.components[h])}}}else{for(h=0;h<f.remove.length;h++){for(g=e.components.length-1;g>-1;g--){if(e.components[g].type===f.remove[h]){e.removeComponent(e.components[g])}}}}}if(f.add){if(!f.add.length){e.addComponent(new a.components[f.add.type](e,f.add))}else{for(h=0;h<f.add.length;h++){e.addComponent(new a.components[f.add[h].type](e,f.add[h]))}}}e.parent.trigger("child-entity-updated",e)}},c=function(e,g){this.type="component-switcher";this.owner=e;this.listeners=[];if(g.componentMap){for(var f in g.componentMap){this.addListener(f);this[f]=b(g.componentMap[f],this.owner)}}};var d=c.prototype;d.destroy=function(){this.removeListeners(this.listeners)};d.addListeners=function(f){for(var e in f){this.addListener(f[e])}};d.removeListeners=function(f){for(var e in f){this.removeListener(e,f[e])}};d.addListener=function(f,h){var e=this,g=h||function(k,i){e[f](k,i)};this.owner.bind(f,g);this.listeners[f]=g};d.removeListener=function(e,f){this.owner.unbind(e,f)};return c})();(function(){return a.createComponentClass({id:"render-destroy-me",constructor:function(b){this.animationId=b.animationId||"";this.animationIds;if(b.animationId){this.animationIds=[b.animationId]}else{if(b.animationIds){this.animationIds=b.animationIds}else{this.animationIds=[]}}},events:{"animation-ended":function(c){for(var b=0;b<this.animationIds.length;b++){if(this.animationIds[b]==c){this.owner.parent.removeEntity(this.owner)}}}}})})();a.components["entity-linker"]=(function(){var c=function(e){if(typeof e==="string"){return function(h,f){var g=0;for(;g<this.links.length;g++){this.links[g].trigger(e,h,f)}}}else{return function(h,f){var g=0;for(var k in e){for(g=0;g<this.links.length;g++){this.links[g].trigger(e[k],h,f)}}}}},b=function(e,g){this.owner=e;this.listeners=[];this.addListeners(["adopted","link-entity","unlink-entity"]);if(g.events){for(var h in g.events){this[h]=c(g.events[h]);this.addListener(h)}}this.linkId=g.linkId||this.owner.linkId||"linked";if(!this.owner.linkId){this.owner.linkId=this.linkId}this["to-"+this.linkId+"-entities"]=c("from-"+this.linkId+"-entities");this.addListener("to-"+this.linkId+"-entities");this["from-"+this.linkId+"-entities"]=function(i){this.owner.trigger(i.message,i.value,i.debug)};this.addListener("from-"+this.linkId+"-entities");this.links=[];if(this.owner.linkEntities){for(var f in this.owner.linkEntities){this.links.push(this.owner.linkEntities[f])}}this.message={message:"",value:null};this.linkMessage={entity:this.owner,linkId:this.linkId,reciprocate:false};if(this.owner.parent){this["adopted"]()}};var d=b.prototype;d.adopted=function(e){var f=this.owner.parent;while(f.parent){f=f.parent}this.linkMessage.reciprocate=true;f.trigger("link-entity",this.linkMessage,true)};d["link-entity"]=function(g){var e=0,f=false;if((g.linkId===this.linkId)&&(g.entity!==this.owner)){for(;e<this.links.length;e++){if(this.links[e]===g.entity){f=true;break}}if(!f){this.links.push(g.entity);if(g.reciprocate){this.linkMessage.reciprocate=false;g.entity.trigger("link-entity",this.linkMessage)}}}};d["unlink-entity"]=function(f){var e=0;for(;e<this.links.length;e++){if(f.entity===this.links[e]){this.links.splice(e,1);break}}};d.destroy=function(){var e=0;for(;e<this.links.length;e++){this.links[e].trigger("unlink-entity",this.linkMessage)}this.links.length=0;this.removeListeners(this.listeners)};d.addListeners=function(f){for(var e in f){this.addListener(f[e])}};d.removeListeners=function(f){for(var e in f){this.removeListener(e,f[e])}};d.addListener=function(f,h){var e=this,g=h||function(k,i){e[f](k,i)};this.owner.bind(f,g);this.listeners[f]=g};d.removeListener=function(e,f){this.owner.unbind(e,f)};return b})();(function(){return a.createComponentClass({id:"logic-spawner",constructor:function(c){this.state=this.owner.state;this.stateName=c.state||"spawning";var d=this.owner.spawneeClass||c.spawneeClass;this.entityClass=a.settings.entities[d];this.speed=c.speed||this.owner.speed||0;this.state[this.stateName]=false;this.spawneeProperties={x:0,y:0,z:0,dx:0,dy:0};var e;if(c.passOnProperties){for(var b=0;b<c.passOnProperties.length;b++){e=c.passOnProperties[b];if(this.owner[e]){this.spawneeProperties[e]=this.owner[e]}}}this.propertiesContainer={properties:this.spawneeProperties};this.offsetX=this.owner.offsetX||c.offsetX||0;this.offsetY=this.owner.offsetY||c.offsetY||0;this.firing=false},events:{"handle-logic":function(){var d=0;var b=0;var c=this.state;if(this.firing){this.spawneeProperties.x=this.owner.x;this.spawneeProperties.y=this.owner.y;b=(this.entityClass.properties&&this.entityClass.properties.z)?this.entityClass.properties.z:0;this.spawneeProperties.z=this.owner.z+b;d=this.offsetX;if(c.left){d*=-1}this.spawneeProperties.x+=d;d=this.offsetY;if(c.top){d*=-1}this.spawneeProperties.y+=d;if(this.speed){if(c.top){this.spawneeProperties.dy=-this.speed}else{if(c.bottom){this.spawneeProperties.dy=this.speed}else{delete this.spawneeProperties.dy}}if(c.left){this.spawneeProperties.dx=-this.speed}else{if(c.right){this.spawneeProperties.dx=this.speed}else{delete this.spawneeProperties.dx}}}this.owner.parent.addEntity(new a.classes.entity(this.entityClass,this.propertiesContainer))}if(c[this.stateName]!==this.firing){c[this.stateName]=this.firing}this.firing=false},spawn:function(b){this.firing=!b||(b.pressed!==false)}}})})();a.components["logic-portal"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.addListeners(["handle-logic","occupied-portal","activate-portal"]);this.destination=this.owner.destination||e.destination;this.activated=false;this.used=false};var c=b.prototype;c["handle-logic"]=function(){if(!this.used&&this.activated){this.owner.trigger("new-scene",{scene:this.destination});this.used=true}};c["occupied-portal"]=function(e){var d=e.entity;d.trigger("portal-waiting",this.owner)};c["activate-portal"]=function(){this.activated=true};c.destroy=function(){this.removeListeners(this.listeners);this.owner=undefined};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(i,h){d[e](i,h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();(function(){var d=function(e,g,f){return function(h){g.call(e,h);f.call(e,h)}},b=function(g,e,f){if(typeof g==="string"){return function(h){if(h.myType===f){if(h.hitType===e){this.owner.triggerEvent(g,h)}}}}else{if(g.length){return function(h){if(h.myType===f){if(h.hitType===e){for(var i in g){this.owner.triggerEvent(g[i],h)}}}}}else{return function(k){var i=k.x,h=k.y;if(k.entity&&!(i||h)){i=k.entity.x-this.owner.x;h=k.entity.y-this.owner.y}if(k.myType===f){if(k.hitType===e){if((h>0)&&g.bottom){this.owner.trigger(g.bottom,k)}if((h<0)&&g.top){this.owner.trigger(g.top,k)}if((i>0)&&g.right){this.owner.trigger(g.right,k)}if((i<0)&&g.left){this.owner.trigger(g.left,k)}if(g.all){this.owner.trigger(g.all,k)}}}}}}},c=function(f,e){if(!e.collisionFunctions){e.collisionFunctions={};e.getAABB=function(k){if(!k){var g=e.aabb=e.aabb||new a.classes.aABB();g.reset();for(var h in e.collisionFunctions){g.include(e.collisionFunctions[h].getAABB())}return g}else{if(e.collisionFunctions[k]){return e.collisionFunctions[k].getAABB()}else{return null}}};e.getPreviousAABB=function(g){if(e.collisionFunctions[g]){return e.collisionFunctions[g].getPreviousAABB()}else{return null}};e.getShapes=function(g){if(e.collisionFunctions[g]){return e.collisionFunctions[g].getShapes()}else{return null}};e.getPrevShapes=function(g){if(e.collisionFunctions[g]){return e.collisionFunctions[g].getPrevShapes()}else{return null}};e.prepareCollision=function(g,k){for(var h in e.collisionFunctions){e.collisionFunctions[h].prepareCollision(g,k)}};e.relocateEntity=function(g,h){e.triggerEvent("relocate-entity",{x:g,y:h})};e.movePreviousX=function(g){for(var h in e.collisionFunctions){e.collisionFunctions[h].movePreviousX(g)}};e.getCollisionTypes=function(){return e.collisionTypes};e.getSolidCollisions=function(){return e.solidCollisions}}e.collisionFunctions[f.collisionType]={getAABB:function(){return f.getAABB()},getPreviousAABB:function(){return f.getPreviousAABB()},getShapes:function(){return f.getShapes()},getPrevShapes:function(){return f.getPrevShapes()},prepareCollision:function(g,h){f.prepareCollision(g,h)},movePreviousX:function(g){f.movePreviousX(g)}}};return a.createComponentClass({id:"collision-basic",constructor:function(h){var s=0,g=null,q=h.regX,p=h.regY,f=h.width,t=h.height,r=h.radius,l=h.margin||0,k=h.marginLeft||l,o=h.marginRight||l,e=h.marginTop||l,m=h.marginBottom||l;if(isNaN(f)){f=this.owner.width;if(isNaN(q)){q=this.owner.regX}}if(isNaN(t)){t=this.owner.height;if(isNaN(p)){p=this.owner.regY}}if(isNaN(r)){r=this.owner.radius;if(isNaN(q)){q=this.owner.regX}if(isNaN(p)){p=this.owner.regY}}this.immobile=this.owner.immobile=this.owner.immobile||h.immobile||false;this.owner.previousX=this.owner.previousX||this.owner.x;this.owner.previousY=this.owner.previousY||this.owner.y;this.aabb=new a.classes.aABB();this.prevAABB=new a.classes.aABB();this.owner.bullet=this.owner.bullet||h.bullet;if(h.shapes){g=h.shapes}else{if(h.shape){g=[h.shape]}else{if(h.shapeType==="circle"){r=r||(((f||0)+(t||0))/4);g=[{regX:(isNaN(q)?r:q)-(o-k)/2,regY:(isNaN(p)?r:p)-(m-e)/2,radius:r,width:r*2,height:r*2,type:h.shapeType}]}else{g=[{regX:(isNaN(q)?(f||0)/2:q)-(o-k)/2,regY:(isNaN(p)?(t||0)/2:p)-(m-e)/2,points:h.points,width:(f||0)+k+o,height:(t||0)+e+m,type:h.shapeType}]}}}this.collisionType=h.collisionType||"none";this.owner.collisionTypes=this.owner.collisionTypes||[];this.owner.collisionTypes.push(this.collisionType);this.shapes=[];this.prevShapes=[];this.entities=undefined;for(s in g){this.shapes.push(new a.classes.collisionShape(this.owner,g[s],this.collisionType));this.prevShapes.push(new a.classes.collisionShape(this.owner,g[s],this.collisionType));this.prevAABB.include(this.prevShapes[s].getAABB());this.aabb.include(this.shapes[s].getAABB())}if(h.jumpThrough){this.owner.jumpThrough=true}c(this,this.owner);this.owner.solidCollisions=this.owner.solidCollisions||{};this.owner.solidCollisions[this.collisionType]=[];if(h.solidCollisions){for(var n in h.solidCollisions){this.owner.solidCollisions[this.collisionType].push(n);this.owner.collides=true;if(h.solidCollisions[n]){this.addListener("hit-by-"+n);this["hit-by-"+n]=b(h.solidCollisions[n],"solid",this.collisionType)}}}this.owner.softCollisions=this.owner.softCollisions||{};this.owner.softCollisions[this.collisionType]=[];if(h.softCollisions){for(var n in h.softCollisions){this.owner.softCollisions[this.collisionType].push(n);if(h.softCollisions[n]){if(this["hit-by-"+n]){this["hit-by-"+n]=d(this,this["hit-by-"+n],b(h.softCollisions[n],"soft",this.collisionType))}else{this.addListener("hit-by-"+n);this["hit-by-"+n]=b(h.softCollisions[n],"soft",this.collisionType)}}}}},events:{"collide-on":function(){this.owner.parent.trigger("add-collision-entity",this.owner)},"collide-off":function(){this.owner.parent.trigger("remove-collision-entity",this.owner)},"handle-logic":function(){if(this.owner.movementAbsorbed){this.owner.movementAbsorbed=false}},"prepare-for-collision":function(f){var e=this.owner.x,g=this.owner.y;if(!this.owner.movementAbsorbed&&f){this.owner.movementAbsorbed=true;if(this.owner.dx){e+=this.owner.dx*(f.deltaT||0)}if(this.owner.dy){g+=this.owner.dy*(f.deltaT||0)}}this.owner.x=e;this.owner.y=g},"relocate-entity":function(f){if(f.relative){this.owner.x=this.owner.previousX+f.x;this.owner.y=this.owner.previousY+f.y}else{this.owner.x=f.x;this.owner.y=f.y}this.aabb.reset();for(var e in this.shapes){this.shapes[e].update(this.owner.x,this.owner.y);this.aabb.include(this.shapes[e].getAABB())}this.owner.previousX=this.owner.x;this.owner.previousY=this.owner.y}},methods:{getAABB:function(){return this.aabb},getPreviousAABB:function(){return this.prevAABB},getShapes:function(){return this.shapes},getPrevShapes:function(){return this.prevShapes},prepareCollision:function(e,g){var f=this.prevShapes;this.owner.x=e;this.owner.y=g;this.prevShapes=this.shapes;this.shapes=f;this.prevAABB.set(this.aabb);this.aabb.reset();for(var e=0;e<this.shapes.length;e++){this.shapes[e].update(this.owner.x,this.owner.y);this.aabb.include(this.shapes[e].getAABB())}},movePreviousX:function(e){this.prevAABB.moveX(e);for(var f=0;f<this.prevShapes.length;f++){this.prevShapes[f].setXWithEntityX(e)}}}})})();(function(){var b=[],d=0,c=[];return a.createComponentClass({id:"collision-tiles",constructor:function(e){this.collisionMap=e.collisionMap||[];this.tileWidth=e.tileWidth||this.owner.tileWidth||10;this.tileHeight=e.tileHeight||this.owner.tileHeight||10;this.tileHalfWidth=this.tileWidth/2;this.tileHalfHeight=this.tileHeight/2},methods:{getShape:function(g,e,h){var f=null;if(d<b.length){f=b[d];d+=1;f.update(e*this.tileWidth+this.tileHalfWidth,h*this.tileHeight+this.tileHalfHeight)}else{b.push(new a.classes.collisionShape(null,{x:e*this.tileWidth+this.tileHalfWidth,y:h*this.tileHeight+this.tileHalfHeight,type:"rectangle",width:this.tileWidth,height:this.tileHeight},"tiles"));f=b[d]}return f},addShape:function(f,g,e,h){if(this.collisionMap[e][h]>-1){f.push(this.getShape(g,e,h))}else{if(this.collisionMap[e][h]<-1){switch(this.collisionMap[e][h]){case -2:if(g.bottom<=h*this.tileHeight){f.push(this.getShape(g,e,h))}break;case -3:if(g.left>=(e+1)*this.tileWidth){f.push(this.getShape(g,e,h))}break;case -4:if(g.top>=(h+1)*this.tileHeight){f.push(this.getShape(g,e,h))}break;case -5:if(g.right<=e*this.tileWidth){f.push(this.getShape(g,e,h))}break}}}return f}},publicMethods:{getAABB:function(){return{left:0,top:0,right:this.tileWidth*this.collisionMap.length,bottom:this.tileHeight*this.collisionMap.length[0]}},isTile:function(e,f){return !((e<0)||(f<0)||(e>=this.collisionMap.length)||(f>=this.collisionMap[0].length)||(this.collisionMap[e][f]===-1))},getTileShapes:function(h,m){var g=Math.max(Math.floor(h.left/this.tileWidth),0),k=Math.max(Math.floor(h.top/this.tileHeight),0),n=Math.min(Math.ceil(h.right/this.tileWidth),this.collisionMap.length),e=Math.min(Math.ceil(h.bottom/this.tileHeight),this.collisionMap[0].length),l=0,i=0,f=c;c.length=0;d=0;for(l=g;l<n;l++){for(i=k;i<e;i++){this.addShape(f,m,l,i)}}return f}}})})();(function(){return a.createComponentClass({id:"logic-paddle",constructor:function(b){this.score=0;this.lives=3;this.level=1;this.balls=1;this.bricks=0;this.goToNewScene=false},events:{"handle-logic":function(){if(this.goToNewScene!==false){this.owner.trigger("new-scene",this.goToNewScene)}},"scene-live":function(b){if(b){this.score=b.score||0;this.lives=b.lives||3;this.level=b.level||1;this.owner.trigger("update-score","score: "+this.score);this.owner.trigger("update-lives","lives: "+this.lives);this.owner.trigger("update-level","level: "+this.level)}},"time-0":function(){this.owner.trigger("maxify");this.owner.trigger("collide-on")},mousemove:function(b){this.owner.x=b.x-(this.owner.width/2)},"ball-collision":function(e){var c=e.entity.x-(this.owner.x+this.owner.width/2),d=(this.owner.width/2)+7,b=-Math.sqrt(d*d-c*c);e.entity.dx=c/(d-7)*0.16;e.entity.dy=b/(d-7)*0.16},"peer-entity-added":function(b){switch(b.type){case"brick-blue":case"brick-orange":case"brick-green":case"brick-red":this.bricks+=1}},"peer-entity-removed":function(b){switch(b.type){case"brick-blue":case"brick-orange":case"brick-green":case"brick-red":this.bricks-=1}if(!this.bricks){this.goToNewScene={scene:"scene-level-"+this.level%4,persistentData:{level:(this.level%4)+1,lives:this.lives,score:this.score}}}},maxify:function(){this.owner.width=48},minify:function(){this.owner.width=32},tally:function(){this.score+=100;this.owner.trigger("update-score","score: "+this.score)},"next-level":function(){this.goToNewScene={scene:"scene-level-"+this.level%4,persistentData:{level:(this.level%4)+1,lives:this.lives,score:this.score}}},"prev-level":function(){this.goToNewScene={scene:"scene-level-"+(this.level+2)%4,persistentData:{level:(this.level+2)%4+1,lives:this.lives,score:this.score}}},"lose-ball":function(){this.balls-=1;if(!this.balls){this.lives-=1;this.owner.trigger("update-lives","lives: "+this.lives);if(!this.lives){this.goToNewScene={scene:"end",persistentData:{score:this.score}}}else{this.owner.trigger("new-ball")}}},"new-ball":function(){this.balls+=1}},methods:{},publicMethods:{}})})()})();